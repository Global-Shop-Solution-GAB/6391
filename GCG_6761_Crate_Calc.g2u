Program.Sub.ScreenSU.Start
Gui.FormRegCrate..Create(DashForm)
Gui.FormRegCrate..Caption("REGULAR CRATES  |  CUSTOMER: INVOTEC")
Gui.FormRegCrate..Size(1024,720)
Gui.FormRegCrate..MinX(0)
Gui.FormRegCrate..MinY(0)
Gui.FormRegCrate..Position(0,0)
Gui.FormRegCrate..AlwaysOnTop(False)
Gui.FormRegCrate..FontName("Tahoma")
Gui.FormRegCrate..FontSize(8.25)
Gui.FormRegCrate..ControlBox(True)
Gui.FormRegCrate..MaxButton(True)
Gui.FormRegCrate..MinButton(True)
Gui.FormRegCrate..MousePointer(0)
Gui.FormRegCrate..Moveable(True)
Gui.FormRegCrate..Sizeable(True)
Gui.FormRegCrate..ShowInTaskBar(True)
Gui.FormRegCrate..TitleBar(True)
Gui.FormRegCrate..BarSaveButton(True,False)
Gui.FormRegCrate..Event(UnLoad,FormRegCrate_UnLoad)
Gui.FormRegCrate..Event(SaveButtonClick,FormRegCrate_SaveButtonClick)
Gui.FormRegCrate.frame1.Create(Frame)
Gui.FormRegCrate.frame1.Enabled(True)
Gui.FormRegCrate.frame1.Visible(True)
Gui.FormRegCrate.frame1.Zorder(0)
Gui.FormRegCrate.frame1.Size(1023,556)
Gui.FormRegCrate.frame1.Position(0,98)
Gui.FormRegCrate.frame1.Caption("Router Sequences")
Gui.FormRegCrate.frame1.FontName("Tahoma")
Gui.FormRegCrate.frame1.FontSize(8.25)
Gui.FormRegCrate.frame1.BorderStyle(1)
Gui.FormRegCrate.frame1.Anchor(15)
Gui.FormRegCrate.GsGridRouter.Create(GsGridControl)
Gui.FormRegCrate.GsGridRouter.Enabled(True)
Gui.FormRegCrate.GsGridRouter.Visible(True)
Gui.FormRegCrate.GsGridRouter.Zorder(0)
Gui.FormRegCrate.GsGridRouter.Size(1023,530)
Gui.FormRegCrate.GsGridRouter.Position(0,26)
Gui.FormRegCrate.GsGridRouter.Parent("frame1")
Gui.FormRegCrate.GsGridRouter.Dock(5)
Gui.FormRegCrate.GsGridRouter.Anchor(15)
Gui.FormRegCrate.frame2.Create(Frame)
Gui.FormRegCrate.frame2.Enabled(True)
Gui.FormRegCrate.frame2.Visible(True)
Gui.FormRegCrate.frame2.Zorder(0)
Gui.FormRegCrate.frame2.Size(1023,96)
Gui.FormRegCrate.frame2.Position(0,0)
Gui.FormRegCrate.frame2.Caption("Data Entry")
Gui.FormRegCrate.frame2.FontName("Tahoma")
Gui.FormRegCrate.frame2.FontSize(8.25)
Gui.FormRegCrate.frame2.BorderStyle(1)
Gui.FormRegCrate.frame2.Anchor(13)
Gui.FormRegCrate.lblWidth.Create(Label,"Width",True,28,13,0,624,36,True,0,"Tahoma",8.25,,0,0)
Gui.FormRegCrate.lblWidth.BorderStyle(0)
Gui.FormRegCrate.lblWidth.Parent("frame2")
Gui.FormRegCrate.txtBaseQty.Create(TextBox,"",True,64,20,0,894,55,True,0,"Tahoma",8.25,,1)
Gui.FormRegCrate.txtBaseQty.NumericOnly(1)
Gui.FormRegCrate.txtBaseQty.Parent("frame2")
Gui.FormRegCrate.lblBaseB.Create(Label,"Base Bottom Qty",True,81,13,0,894,35,True,0,"Tahoma",8.25,,0,0)
Gui.FormRegCrate.lblBaseB.BorderStyle(0)
Gui.FormRegCrate.lblBaseB.Parent("frame2")
Gui.FormRegCrate.cmdCalc.Create(Button)
Gui.FormRegCrate.cmdCalc.Enabled(True)
Gui.FormRegCrate.cmdCalc.Visible(True)
Gui.FormRegCrate.cmdCalc.Zorder(0)
Gui.FormRegCrate.cmdCalc.Size(39,33)
Gui.FormRegCrate.cmdCalc.Position(977,52)
Gui.FormRegCrate.cmdCalc.Caption("")
Gui.FormRegCrate.cmdCalc.FontName("Tahoma")
Gui.FormRegCrate.cmdCalc.FontSize(8.25)
Gui.FormRegCrate.cmdCalc.SvgPicture("icon_go_color")
Gui.FormRegCrate.cmdCalc.ToolTip("Calculate Materials")
Gui.FormRegCrate.cmdCalc.ImageAlign(8)
Gui.FormRegCrate.cmdCalc.Parent("frame2")
Gui.FormRegCrate.cmdCalc.Event(Click,cmdCalc_Click)
Gui.FormRegCrate.lblHeight.Create(Label,"Height",True,31,13,0,715,34,True,0,"Tahoma",8.25,,0,0)
Gui.FormRegCrate.lblHeight.BorderStyle(0)
Gui.FormRegCrate.lblHeight.Parent("frame2")
Gui.FormRegCrate.lbl7.Create(Label,"X",True,6,13,0,700,58,True,0,"Tahoma",8.25,,0,0)
Gui.FormRegCrate.lbl7.BorderStyle(0)
Gui.FormRegCrate.lbl7.Parent("frame2")
Gui.FormRegCrate.txtHeight.Create(TextBox,"",True,64,20,0,715,54,True,0,"Tahoma",8.25,,1)
Gui.FormRegCrate.txtHeight.Parent("frame2")
Gui.FormRegCrate.txtHeight.NumericOnly(1)
Gui.FormRegCrate.txtHeight.Event(GotFocus,txtHeight_GotFocus)
Gui.FormRegCrate.lbl6.Create(Label,"X",True,6,13,0,608,58,True,0,"Tahoma",8.25,,0,0)
Gui.FormRegCrate.lbl6.BorderStyle(0)
Gui.FormRegCrate.lbl6.Parent("frame2")
Gui.FormRegCrate.txtWidth.Create(TextBox,"",True,64,20,0,624,54,True,0,"Tahoma",8.25,,1)
Gui.FormRegCrate.txtWidth.Parent("frame2")
Gui.FormRegCrate.txtWidth.NumericOnly(1)
Gui.FormRegCrate.txtWidth.Event(GotFocus,txtWidth_GotFocus)
Gui.FormRegCrate.lblLen.Create(Label,"Length",True,33,13,0,532,34,True,0,"Tahoma",8.25,,0,0)
Gui.FormRegCrate.lblLen.BorderStyle(0)
Gui.FormRegCrate.lblLen.Parent("frame2")
Gui.FormRegCrate.txtLength.Create(TextBox,"",True,64,20,0,532,54,True,0,"Tahoma",8.25,,1)
Gui.FormRegCrate.txtLength.Parent("frame2")
Gui.FormRegCrate.txtLength.NumericOnly(1)
Gui.FormRegCrate.txtLength.Event(GotFocus,txtLength_GotFocus)
Gui.FormRegCrate.lblTempDesc.Create(Label,"Template Description",True,100,13,0,201,33,True,0,"Tahoma",8.25,,0,0)
Gui.FormRegCrate.lblTempDesc.BorderStyle(0)
Gui.FormRegCrate.lblTempDesc.Parent("frame2")
Gui.FormRegCrate.txtDesc.Create(TextBox,"",True,236,20,0,201,54,True,0,"Tahoma",8.25,,1)
Gui.FormRegCrate.txtDesc.Parent("frame2")
Gui.FormRegCrate.txtDesc.Locked(True)
Gui.FormRegCrate.cmdTemplate.Create(Button)
Gui.FormRegCrate.cmdTemplate.Enabled(True)
Gui.FormRegCrate.cmdTemplate.Visible(True)
Gui.FormRegCrate.cmdTemplate.Zorder(0)
Gui.FormRegCrate.cmdTemplate.Size(35,23)
Gui.FormRegCrate.cmdTemplate.Position(150,52)
Gui.FormRegCrate.cmdTemplate.Caption("")
Gui.FormRegCrate.cmdTemplate.FontName("Tahoma")
Gui.FormRegCrate.cmdTemplate.FontSize(8.25)
Gui.FormRegCrate.cmdTemplate.SvgPicture("icon_browser_color")
Gui.FormRegCrate.cmdTemplate.ImageAlign(8)
Gui.FormRegCrate.cmdTemplate.Parent("frame2")
Gui.FormRegCrate.cmdTemplate.Event(Click,cmdTemplate_Click)
Gui.FormRegCrate.lblTemplate.Create(Label,"Template",True,44,13,0,14,34,True,0,"Tahoma",8.25,,0,0)
Gui.FormRegCrate.lblTemplate.BorderStyle(0)
Gui.FormRegCrate.lblTemplate.Parent("frame2")
Gui.FormRegCrate.txtTemplate.Create(TextBox,"",True,133,20,0,14,54,True,0,"Tahoma",8.25,,1)
Gui.FormRegCrate.txtTemplate.Parent("frame2")
Gui.FormRegCrate.txtTemplate.Event(LostFocus,txtTemplate_LostFocus)
Gui.FormRegCrate.txtTemplate.Event(GotFocus,txtTemplate_GotFocus)
Gui.FormRegCrate.chkTop.Create(CheckBox)
Gui.FormRegCrate.chkTop.Enabled(True)
Gui.FormRegCrate.chkTop.Visible(True)
Gui.FormRegCrate.chkTop.Zorder(0)
Gui.FormRegCrate.chkTop.Size(75,20)
Gui.FormRegCrate.chkTop.Position(788,32)
Gui.FormRegCrate.chkTop.Caption("Has Top")
Gui.FormRegCrate.chkTop.FontName("Tahoma")
Gui.FormRegCrate.chkTop.FontSize(8.25)
Gui.FormRegCrate.chk2x2.Create(CheckBox)
Gui.FormRegCrate.chk2x2.Enabled(True)
Gui.FormRegCrate.chk2x2.Visible(True)
Gui.FormRegCrate.chk2x2.Zorder(0)
Gui.FormRegCrate.chk2x2.Size(102,20)
Gui.FormRegCrate.chk2x2.Position(788,53)
Gui.FormRegCrate.chk2x2.Caption("Has 2x2 Bracing")
Gui.FormRegCrate.chk2x2.FontName("Tahoma")
Gui.FormRegCrate.chk2x2.FontSize(8.25)
Gui.FormRegCrate.chk2x4.Create(CheckBox)
Gui.FormRegCrate.chk2x4.Enabled(True)
Gui.FormRegCrate.chk2x4.Visible(True)
Gui.FormRegCrate.chk2x4.Zorder(0)
Gui.FormRegCrate.chk2x4.Size(102,20)
Gui.FormRegCrate.chk2x4.Position(788,74)
Gui.FormRegCrate.chk2x4.Caption("Has 2x4 Bracing")
Gui.FormRegCrate.chk2x4.FontName("Tahoma")
Gui.FormRegCrate.chk2x4.FontSize(8.25)
Gui.FormCrateSel..Create(BaseForm)
Gui.FormCrateSel..Caption("Crate Selection")
Gui.FormCrateSel..Size(323,120)
Gui.FormCrateSel..MinX(0)
Gui.FormCrateSel..MinY(0)
Gui.FormCrateSel..Position(0,0)
Gui.FormCrateSel..AlwaysOnTop(False)
Gui.FormCrateSel..FontName("Tahoma")
Gui.FormCrateSel..FontSize(8.25)
Gui.FormCrateSel..ControlBox(True)
Gui.FormCrateSel..MaxButton(True)
Gui.FormCrateSel..MinButton(True)
Gui.FormCrateSel..MousePointer(0)
Gui.FormCrateSel..Moveable(True)
Gui.FormCrateSel..Sizeable(True)
Gui.FormCrateSel..ShowInTaskBar(True)
Gui.FormCrateSel..TitleBar(True)
Gui.FormCrateSel..Event(UnLoad,FormCrateSel_UnLoad)
Gui.FormCrateSel.cmdReg.Create(Button)
Gui.FormCrateSel.cmdReg.Enabled(True)
Gui.FormCrateSel.cmdReg.Visible(True)
Gui.FormCrateSel.cmdReg.Zorder(0)
Gui.FormCrateSel.cmdReg.Size(120,47)
Gui.FormCrateSel.cmdReg.Position(19,23)
Gui.FormCrateSel.cmdReg.Caption("CRATE")
Gui.FormCrateSel.cmdReg.FontName("Tahoma")
Gui.FormCrateSel.cmdReg.FontSize(8.25)
Gui.FormCrateSel.cmdReg.Event(Click,cmdReg_Click)
Gui.FormCrateSel.cmdShell.Create(Button)
Gui.FormCrateSel.cmdShell.Enabled(True)
Gui.FormCrateSel.cmdShell.Visible(True)
Gui.FormCrateSel.cmdShell.Zorder(0)
Gui.FormCrateSel.cmdShell.Size(120,47)
Gui.FormCrateSel.cmdShell.Position(188,23)
Gui.FormCrateSel.cmdShell.Caption("SHELL CRATE")
Gui.FormCrateSel.cmdShell.FontName("Tahoma")
Gui.FormCrateSel.cmdShell.FontSize(8.25)
Gui.FormCrateSel.cmdShell.Event(Click,cmdShell_Click)
Gui.FormShell..Create(DashForm)
Gui.FormShell..Caption("SHELL CRATES  |  CUSTOMER: INVOTEC")
Gui.FormShell..Size(1024,720)
Gui.FormShell..MinX(0)
Gui.FormShell..MinY(0)
Gui.FormShell..Position(0,0)
Gui.FormShell..AlwaysOnTop(False)
Gui.FormShell..FontName("Tahoma")
Gui.FormShell..FontSize(8.25)
Gui.FormShell..ControlBox(True)
Gui.FormShell..MaxButton(True)
Gui.FormShell..MinButton(True)
Gui.FormShell..MousePointer(0)
Gui.FormShell..Moveable(True)
Gui.FormShell..Sizeable(True)
Gui.FormShell..ShowInTaskBar(True)
Gui.FormShell..TitleBar(True)
Gui.FormShell..Event(UnLoad,FormShell_UnLoad)
Gui.FormShell..Event(SaveButtonClick,FormShell_SaveButtonClick)
Gui.FormShell..BarSaveButton(True,True)
Gui.FormShell.frame1.Create(Frame)
Gui.FormShell.frame1.Enabled(True)
Gui.FormShell.frame1.Visible(True)
Gui.FormShell.frame1.Zorder(0)
Gui.FormShell.frame1.Size(1024,101)
Gui.FormShell.frame1.Position(0,0)
Gui.FormShell.frame1.Caption("Data Entry")
Gui.FormShell.frame1.FontName("Tahoma")
Gui.FormShell.frame1.FontSize(8.25)
Gui.FormShell.frame1.BorderStyle(1)
Gui.FormShell.frame1.Dock(0)
Gui.FormShell.frame1.Anchor(15)
Gui.FormShell.lbl1.Create(Label,"Template",True,44,13,0,15,37,True,0,"Tahoma",8.25,,0,0)
Gui.FormShell.lbl1.BorderStyle(0)
Gui.FormShell.lbl1.Parent("frame1")
Gui.FormShell.txtShellTemplate.Create(TextBox,"",True,142,20,0,15,56,True,0,"Tahoma",8.25,,1)
Gui.FormShell.txtShellTemplate.Parent("frame1")
Gui.FormShell.txtShellTemplate.Event(GotFocus,txtShellTemplate_GotFocus)
Gui.FormShell.txtShellTemplate.Event(LostFocus,txtShellTemplate_LostFocus)
Gui.FormShell.lbl5.Create(Label,"X",True,6,13,0,610,57,True,0,"Tahoma",8.25,,0,0)
Gui.FormShell.lbl5.BorderStyle(0)
Gui.FormShell.lbl5.Parent("frame1")
Gui.FormShell.chkShellHT.Create(CheckBox)
Gui.FormShell.chkShellHT.Enabled(True)
Gui.FormShell.chkShellHT.Visible(True)
Gui.FormShell.chkShellHT.Zorder(0)
Gui.FormShell.chkShellHT.Size(123,20)
Gui.FormShell.chkShellHT.Position(769,53)
Gui.FormShell.chkShellHT.Caption("HT STAMP")
Gui.FormShell.chkShellHT.FontName("Tahoma")
Gui.FormShell.chkShellHT.FontSize(8.25)
Gui.FormShell.chkShellHT.Parent("frame1")
Gui.FormShell.lbl8.Create(Label,"Height",True,31,13,0,706,36,True,0,"Tahoma",8.25,,0,0)
Gui.FormShell.lbl8.BorderStyle(0)
Gui.FormShell.lbl8.Parent("frame1")
Gui.FormShell.txtShellHeight.Create(TextBox,"",True,58,20,0,704,53,True,0,"Tahoma",8.25,,1)
Gui.FormShell.txtShellHeight.Parent("frame1")
Gui.FormShell.txtShellHeight.NumericOnly(1)
Gui.FormShell.txtShellHeight.Event(GotFocus,txtShellHeight_GotFocus)
Gui.FormShell.txtShellHeight.Event(LostFocus,txtShellHeight_LostFocus)
Gui.FormShell.lbl7.Create(Label,"X",True,6,13,0,690,57,True,0,"Tahoma",8.25,,0,0)
Gui.FormShell.lbl7.BorderStyle(0)
Gui.FormShell.lbl7.Parent("frame1")
Gui.FormShell.lbl6.Create(Label,"Width",True,28,13,0,626,36,True,0,"Tahoma",8.25,,0,0)
Gui.FormShell.lbl6.BorderStyle(0)
Gui.FormShell.lbl6.Parent("frame1")
Gui.FormShell.txtShellWidth.Create(TextBox,"",True,58,20,0,624,53,True,0,"Tahoma",8.25,,1)
Gui.FormShell.txtShellWidth.Parent("frame1")
Gui.FormShell.txtShellWidth.NumericOnly(1)
Gui.FormShell.txtShellWidth.Event(GotFocus,txtShellWidth_GotFocus)
Gui.FormShell.txtShellWidth.Event(LostFocus,txtShellWidth_LostFocus)
Gui.FormShell.txtShellLen.Create(TextBox,"",True,58,20,0,544,53,True,0,"Tahoma",8.25,,1)
Gui.FormShell.txtShellLen.Parent("frame1")
Gui.FormShell.txtShellLen.NumericOnly(1)
Gui.FormShell.txtShellLen.Event(GotFocus,txtShellLen_GotFocus)
Gui.FormShell.txtShellLen.Event(LostFocus,txtShellLen_LostFocus)
Gui.FormShell.lbl4.Create(Label,"Length",True,33,13,0,546,36,True,0,"Tahoma",8.25,,0,0)
Gui.FormShell.lbl4.BorderStyle(0)
Gui.FormShell.lbl4.Parent("frame1")
Gui.FormShell.lbl3.Create(Label,"Skid Size",True,41,13,0,492,56,True,0,"Tahoma",8.25,,0,0)
Gui.FormShell.lbl3.BorderStyle(0)
Gui.FormShell.lbl3.Parent("frame1")
Gui.FormShell.cmdShellTemplate.Create(Button)
Gui.FormShell.cmdShellTemplate.Enabled(True)
Gui.FormShell.cmdShellTemplate.Visible(True)
Gui.FormShell.cmdShellTemplate.Zorder(0)
Gui.FormShell.cmdShellTemplate.Size(35,23)
Gui.FormShell.cmdShellTemplate.Position(161,53)
Gui.FormShell.cmdShellTemplate.Caption("")
Gui.FormShell.cmdShellTemplate.FontName("Tahoma")
Gui.FormShell.cmdShellTemplate.FontSize(8.25)
Gui.FormShell.cmdShellTemplate.SvgPicture("icon_browser_color")
Gui.FormShell.cmdShellTemplate.Parent("frame1")
Gui.FormShell.cmdShellTemplate.Event(Click,cmdShellTemplate_Click)
Gui.FormShell.cmdShellCalc.Create(Button)
Gui.FormShell.cmdShellCalc.Enabled(True)
Gui.FormShell.cmdShellCalc.Visible(True)
Gui.FormShell.cmdShellCalc.Zorder(0)
Gui.FormShell.cmdShellCalc.Size(63,41)
Gui.FormShell.cmdShellCalc.Position(927,42)
Gui.FormShell.cmdShellCalc.Caption("")
Gui.FormShell.cmdShellCalc.FontName("Tahoma")
Gui.FormShell.cmdShellCalc.FontSize(8.25)
Gui.FormShell.cmdShellCalc.SvgPicture("icon_go_black")
Gui.FormShell.cmdShellCalc.Parent("frame1")
Gui.FormShell.cmdShellCalc.Event(Click,cmdShellCalc_Click)
Gui.FormShell.txtShellDesc.Create(TextBox,"",True,233,20,0,216,54,True,0,"Tahoma",8.25,,1)
Gui.FormShell.txtShellDesc.Parent("frame1")
Gui.FormShell.txtShellDesc.Locked(True)
Gui.FormShell.lbl2.Create(Label,"Template Description",True,100,13,0,216,35,True,0,"Tahoma",8.25,,0,0)
Gui.FormShell.lbl2.BorderStyle(0)
Gui.FormShell.lbl2.Parent("frame1")
Gui.FormShell.frame2.Create(Frame)
Gui.FormShell.frame2.Enabled(True)
Gui.FormShell.frame2.Visible(True)
Gui.FormShell.frame2.Zorder(0)
Gui.FormShell.frame2.Size(612,121)
Gui.FormShell.frame2.Position(0,102)
Gui.FormShell.frame2.Caption("Stringers")
Gui.FormShell.frame2.FontName("Tahoma")
Gui.FormShell.frame2.FontSize(8.25)
Gui.FormShell.frame2.BorderStyle(1)
Gui.FormShell.lbl9.Create(Label,"Length of Stringers",True,92,13,0,14,47,True,0,"Tahoma",8.25,,0,0)
Gui.FormShell.lbl9.BorderStyle(0)
Gui.FormShell.lbl9.Parent("frame2")
Gui.FormShell.lbl13.Create(Label,"Material",True,38,13,0,300,85,True,0,"Tahoma",8.25,,0,0)
Gui.FormShell.lbl13.BorderStyle(0)
Gui.FormShell.lbl13.Parent("frame2")
Gui.FormShell.ddlTStrgMat.Create(DropDownList)
Gui.FormShell.ddlTStrgMat.Enabled(True)
Gui.FormShell.ddlTStrgMat.Visible(True)
Gui.FormShell.ddlTStrgMat.Zorder(0)
Gui.FormShell.ddlTStrgMat.Size(203,20)
Gui.FormShell.ddlTStrgMat.Position(60,82)
Gui.FormShell.ddlTStrgMat.FontName("Tahoma")
Gui.FormShell.ddlTStrgMat.FontSize(8.25)
Gui.FormShell.ddlTStrgMat.Parent("frame2")
Gui.FormShell.ddlTStrgMat.Event(SelectedIndexChanged,ddlTStrgMat_SelectedIndexChanged)
Gui.FormShell.txtTStrgQty.Create(TextBox,"",True,56,20,0,206,45,True,0,"Tahoma",8.25,,1)
Gui.FormShell.txtTStrgQty.Parent("frame2")
Gui.FormShell.txtTStrgQty.NumericOnly(1)
Gui.FormShell.txtTStrgQty.Event(GotFocus,txtTStrgQty_GotFocus)
Gui.FormShell.lbl12.Create(Label,"Qty",True,18,13,0,180,48,True,0,"Tahoma",8.25,,0,0)
Gui.FormShell.lbl12.BorderStyle(0)
Gui.FormShell.lbl12.Parent("frame2")
Gui.FormShell.lbl14.Create(Label,"Qty",True,18,13,0,464,47,True,0,"Tahoma",8.25,,0,0)
Gui.FormShell.lbl14.BorderStyle(0)
Gui.FormShell.lbl14.Parent("frame2")
Gui.FormShell.lbl11.Create(Label,"Material",True,38,13,0,14,85,True,0,"Tahoma",8.25,,0,0)
Gui.FormShell.lbl11.BorderStyle(0)
Gui.FormShell.lbl11.Parent("frame2")
Gui.FormShell.ddlBStrg.Create(DropDownList)
Gui.FormShell.ddlBStrg.Enabled(True)
Gui.FormShell.ddlBStrg.Visible(True)
Gui.FormShell.ddlBStrg.Zorder(0)
Gui.FormShell.ddlBStrg.Size(203,20)
Gui.FormShell.ddlBStrg.Position(347,82)
Gui.FormShell.ddlBStrg.FontName("Tahoma")
Gui.FormShell.ddlBStrg.FontSize(8.25)
Gui.FormShell.ddlBStrg.Parent("frame2")
Gui.FormShell.ddlBStrg.Event(SelectedIndexChanged,ddlBStrg_SelectedIndexChanged)
Gui.FormShell.txtTStrg.Create(TextBox,"",True,56,20,0,114,44,True,0,"Tahoma",8.25,,1)
Gui.FormShell.txtTStrg.Parent("frame2")
Gui.FormShell.txtTStrg.NumericOnly(1)
Gui.FormShell.txtTStrg.Event(GotFocus,txtTStrg_GotFocus)
Gui.FormShell.txtBstrgQty.Create(TextBox,"",True,56,20,0,493,45,True,0,"Tahoma",8.25,,1)
Gui.FormShell.txtBstrgQty.Parent("frame2")
Gui.FormShell.txtBstrgQty.NumericOnly(1)
Gui.FormShell.txtBstrgQty.Event(GotFocus,txtBstrgQty_GotFocus)
Gui.FormShell.lbl10.Create(Label,"Bottom Stringers",True,80,13,0,300,47,True,0,"Tahoma",8.25,,0,0)
Gui.FormShell.lbl10.BorderStyle(0)
Gui.FormShell.lbl10.Parent("frame2")
Gui.FormShell.txtBStrg.Create(TextBox,"",True,56,20,0,394,45,True,0,"Tahoma",8.25,,1)
Gui.FormShell.txtBStrg.NumericOnly(1)
Gui.FormShell.txtBStrg.Parent("frame2")
Gui.FormShell.txtBStrg.Event(GotFocus,txtBStrg_GotFocus)
Gui.FormShell.frame3.Create(Frame)
Gui.FormShell.frame3.Enabled(True)
Gui.FormShell.frame3.Visible(True)
Gui.FormShell.frame3.Zorder(0)
Gui.FormShell.frame3.Size(407,121)
Gui.FormShell.frame3.Position(615,102)
Gui.FormShell.frame3.Caption("Runners")
Gui.FormShell.frame3.FontName("Tahoma")
Gui.FormShell.frame3.FontSize(8.25)
Gui.FormShell.frame3.BorderStyle(1)
Gui.FormShell.frame3.Anchor(13)
Gui.FormShell.ddlRunMat.Create(DropDownList)
Gui.FormShell.ddlRunMat.Enabled(True)
Gui.FormShell.ddlRunMat.Visible(True)
Gui.FormShell.ddlRunMat.Zorder(0)
Gui.FormShell.ddlRunMat.Size(203,20)
Gui.FormShell.ddlRunMat.Position(67,82)
Gui.FormShell.ddlRunMat.FontName("Tahoma")
Gui.FormShell.ddlRunMat.FontSize(8.25)
Gui.FormShell.ddlRunMat.Parent("frame3")
Gui.FormShell.ddlRunMat.Event(SelectedIndexChanged,ddlRunMat_SelectedIndexChanged)
Gui.FormShell.lbl17.Create(Label,"Material",True,38,13,0,13,85,True,0,"Tahoma",8.25,,0,0)
Gui.FormShell.lbl17.BorderStyle(0)
Gui.FormShell.lbl17.Parent("frame3")
Gui.FormShell.lbl16.Create(Label,"Qty",True,18,13,0,182,47,True,0,"Tahoma",8.25,,0,0)
Gui.FormShell.lbl16.BorderStyle(0)
Gui.FormShell.lbl16.Parent("frame3")
Gui.FormShell.lbl15.Create(Label,"Length of Runners",True,89,13,0,12,47,True,0,"Tahoma",8.25,,0,0)
Gui.FormShell.lbl15.BorderStyle(0)
Gui.FormShell.lbl15.Parent("frame3")
Gui.FormShell.txtRunQty.Create(TextBox,"",True,56,20,0,212,45,True,0,"Tahoma",8.25,,1)
Gui.FormShell.txtRunQty.Parent("frame3")
Gui.FormShell.txtRunQty.NumericOnly(1)
Gui.FormShell.txtRunQty.Event(GotFocus,txtRunQty_GotFocus)
Gui.FormShell.txtLRun.Create(TextBox,"",True,56,20,0,115,44,True,0,"Tahoma",8.25,,1)
Gui.FormShell.txtLRun.Parent("frame3")
Gui.FormShell.txtLRun.NumericOnly(1)
Gui.FormShell.txtLRun.Event(GotFocus,txtLRun_GotFocus)
Gui.FormShell.frame4.Create(Frame)
Gui.FormShell.frame4.Enabled(True)
Gui.FormShell.frame4.Visible(True)
Gui.FormShell.frame4.Zorder(0)
Gui.FormShell.frame4.Size(1022,188)
Gui.FormShell.frame4.Position(0,225)
Gui.FormShell.frame4.Caption("Misc")
Gui.FormShell.frame4.FontName("Tahoma")
Gui.FormShell.frame4.FontSize(8.25)
Gui.FormShell.frame4.BorderStyle(1)
Gui.FormShell.frame4.Anchor(15)
Gui.FormShell.txtSide2QtyDim1.Create(TextBox,"",True,76,20,0,314,123,True,0,"Tahoma",8.25,,1)
Gui.FormShell.txtSide2QtyDim1.NumericOnly(1)
Gui.FormShell.txtSide2QtyDim1.Parent("frame4")
Gui.FormShell.txtSide2QtyDim1.Event(GotFocus,txtSide2QtyDim1_GotFocus)
Gui.FormShell.txtSide1QtyDim1.Create(TextBox,"",True,76,20,0,314,87,True,0,"Tahoma",8.25,,1)
Gui.FormShell.txtSide1QtyDim1.NumericOnly(1)
Gui.FormShell.txtSide1QtyDim1.Parent("frame4")
Gui.FormShell.txtSide1QtyDim1.Event(GotFocus,txtSide1QtyDim1_GotFocus)
Gui.FormShell.lblQtyDim1.Create(Label,"Qty Dim 1",True,47,13,0,314,67,True,0,"Tahoma",8.25,,0,0)
Gui.FormShell.lblQtyDim1.BorderStyle(0)
Gui.FormShell.lblQtyDim1.Parent("frame4")
Gui.FormShell.ddlTopMat.Create(DropDownList)
Gui.FormShell.ddlTopMat.Enabled(True)
Gui.FormShell.ddlTopMat.Visible(True)
Gui.FormShell.ddlTopMat.Zorder(0)
Gui.FormShell.ddlTopMat.Size(203,20)
Gui.FormShell.ddlTopMat.Position(78,157)
Gui.FormShell.ddlTopMat.FontName("Tahoma")
Gui.FormShell.ddlTopMat.FontSize(8.25)
Gui.FormShell.ddlTopMat.Parent("frame4")
Gui.FormShell.ddlTopMat.Event(SelectedIndexChanged,ddlTopMat_SelectedIndexChanged)
Gui.FormShell.ddlSide2Mat.Create(DropDownList)
Gui.FormShell.ddlSide2Mat.Enabled(True)
Gui.FormShell.ddlSide2Mat.Visible(True)
Gui.FormShell.ddlSide2Mat.Zorder(0)
Gui.FormShell.ddlSide2Mat.Size(203,20)
Gui.FormShell.ddlSide2Mat.Position(78,123)
Gui.FormShell.ddlSide2Mat.FontName("Tahoma")
Gui.FormShell.ddlSide2Mat.FontSize(8.25)
Gui.FormShell.ddlSide2Mat.Parent("frame4")
Gui.FormShell.ddlSide2Mat.Event(SelectedIndexChanged,ddlSide2Mat_SelectedIndexChanged)
Gui.FormShell.lblTop.Create(Label,"TOP",True,20,13,0,20,160,True,0,"Tahoma",8.25,,0,0)
Gui.FormShell.lblTop.BorderStyle(0)
Gui.FormShell.lblTop.Parent("frame4")
Gui.FormShell.txtSide1CutLenDim1.Create(TextBox,"",True,76,20,0,423,87,True,0,"Tahoma",8.25,,1)
Gui.FormShell.txtSide1CutLenDim1.NumericOnly(1)
Gui.FormShell.txtSide1CutLenDim1.Parent("frame4")
Gui.FormShell.txtSide1CutLenDim1.Event(GotFocus,txtSide1CutLenDim1_GotFocus)
Gui.FormShell.lblSide2.Create(Label,"SIDE 2",True,32,13,0,20,126,True,0,"Tahoma",8.25,,0,0)
Gui.FormShell.lblSide2.BorderStyle(0)
Gui.FormShell.lblSide2.Parent("frame4")
Gui.FormShell.lblSide1.Create(Label,"SIDE 1",True,32,13,0,20,90,True,0,"Tahoma",8.25,,0,0)
Gui.FormShell.lblSide1.BorderStyle(0)
Gui.FormShell.lblSide1.Parent("frame4")
Gui.FormShell.chkLagString.Create(CheckBox)
Gui.FormShell.chkLagString.Enabled(True)
Gui.FormShell.chkLagString.Visible(True)
Gui.FormShell.chkLagString.Zorder(0)
Gui.FormShell.chkLagString.Size(155,20)
Gui.FormShell.chkLagString.Position(192,40)
Gui.FormShell.chkLagString.Caption("Lag Stringers")
Gui.FormShell.chkLagString.FontName("Tahoma")
Gui.FormShell.chkLagString.FontSize(8.25)
Gui.FormShell.chkLagString.Parent("frame4")
Gui.FormShell.chkBoltTopRun.Create(CheckBox)
Gui.FormShell.chkBoltTopRun.Enabled(True)
Gui.FormShell.chkBoltTopRun.Visible(True)
Gui.FormShell.chkBoltTopRun.Zorder(0)
Gui.FormShell.chkBoltTopRun.Size(143,20)
Gui.FormShell.chkBoltTopRun.Position(16,40)
Gui.FormShell.chkBoltTopRun.Caption("Bolt Top Runners")
Gui.FormShell.chkBoltTopRun.FontName("Tahoma")
Gui.FormShell.chkBoltTopRun.FontSize(8.25)
Gui.FormShell.chkBoltTopRun.Parent("frame4")
Gui.FormShell.txtNotes.Create(TextBox,"",True,530,20,0,488,39,True,0,"Tahoma",8.25,,1)
Gui.FormShell.txtNotes.Parent("frame4")
Gui.FormShell.txtNotes.Event(GotFocus,txtNotes_GotFocus)
Gui.FormShell.txtNotes.MaxLength(30)
Gui.FormShell.ddlSide1Mat.Create(DropDownList)
Gui.FormShell.ddlSide1Mat.Enabled(True)
Gui.FormShell.ddlSide1Mat.Visible(True)
Gui.FormShell.ddlSide1Mat.Zorder(0)
Gui.FormShell.ddlSide1Mat.Size(203,20)
Gui.FormShell.ddlSide1Mat.Position(77,87)
Gui.FormShell.ddlSide1Mat.FontName("Tahoma")
Gui.FormShell.ddlSide1Mat.FontSize(8.25)
Gui.FormShell.ddlSide1Mat.Parent("frame4")
Gui.FormShell.ddlSide1Mat.Event(SelectedIndexChanged,ddlSide1Mat_SelectedIndexChanged)
Gui.FormShell.txtTopQtyDim1.Create(TextBox,"",True,76,20,0,314,157,True,0,"Tahoma",8.25,,1)
Gui.FormShell.txtTopQtyDim1.NumericOnly(1)
Gui.FormShell.txtTopQtyDim1.Parent("frame4")
Gui.FormShell.txtTopQtyDim1.Event(GotFocus,txtTopQtyDim1_GotFocus)
Gui.FormShell.lbl20.Create(Label,"Notes",True,28,13,0,445,43,True,0,"Tahoma",8.25,,0,0)
Gui.FormShell.lbl20.BorderStyle(0)
Gui.FormShell.lbl20.Parent("frame4")
Gui.FormShell.lblCutLengthDim1.Create(Label,"Cut Length Dim 1",True,82,13,0,423,67,True,0,"Tahoma",8.25,,0,0)
Gui.FormShell.lblCutLengthDim1.BorderStyle(0)
Gui.FormShell.lblCutLengthDim1.Parent("frame4")
Gui.FormShell.txtSide2CutLenDim1.Create(TextBox,"",True,76,20,0,423,123,True,0,"Tahoma",8.25,,1)
Gui.FormShell.txtSide2CutLenDim1.NumericOnly(1)
Gui.FormShell.txtSide2CutLenDim1.Parent("frame4")
Gui.FormShell.txtSide2CutLenDim1.Event(GotFocus,txtSide2CutLenDim1_GotFocus)
Gui.FormShell.lblQtyDim2.Create(Label,"Qty Dim 2",True,47,13,0,536,67,True,0,"Tahoma",8.25,,0,0)
Gui.FormShell.lblQtyDim2.BorderStyle(0)
Gui.FormShell.lblQtyDim2.Parent("frame4")
Gui.FormShell.txtSide1QtyDim2.Create(TextBox,"",True,76,20,0,536,87,True,0,"Tahoma",8.25,,1)
Gui.FormShell.txtSide1QtyDim2.NumericOnly(1)
Gui.FormShell.txtSide1QtyDim2.Parent("frame4")
Gui.FormShell.txtSide1QtyDim2.Event(GotFocus,txtSide1QtyDim2_GotFocus)
Gui.FormShell.txtTopCutLenDim1.Create(TextBox,"",True,76,20,0,423,157,True,0,"Tahoma",8.25,,1)
Gui.FormShell.txtTopCutLenDim1.NumericOnly(1)
Gui.FormShell.txtTopCutLenDim1.Parent("frame4")
Gui.FormShell.txtTopCutLenDim1.Event(GotFocus,txtTopCutLenDim1_GotFocus)
Gui.FormShell.txtSide2QtyDim2.Create(TextBox,"",True,76,20,0,536,123,True,0,"Tahoma",8.25,,1)
Gui.FormShell.txtSide2QtyDim2.NumericOnly(1)
Gui.FormShell.txtSide2QtyDim2.Parent("frame4")
Gui.FormShell.txtSide2QtyDim2.Event(GotFocus,txtSide2QtyDim2_GotFocus)
Gui.FormShell.txtTopQtyDim2.Create(TextBox,"",True,76,20,0,536,157,True,0,"Tahoma",8.25,,1)
Gui.FormShell.txtTopQtyDim2.NumericOnly(1)
Gui.FormShell.txtTopQtyDim2.Parent("frame4")
Gui.FormShell.txtTopQtyDim2.Event(GotFocus,txtTopQtyDim2_GotFocus)
Gui.FormShell.lblCutLengthDim2.Create(Label,"Cut Length Dim 2",True,82,13,0,645,67,True,0,"Tahoma",8.25,,0,0)
Gui.FormShell.lblCutLengthDim2.BorderStyle(0)
Gui.FormShell.lblCutLengthDim2.Parent("frame4")
Gui.FormShell.txtSide1CutLenDim2.Create(TextBox,"",True,76,20,0,645,87,True,0,"Tahoma",8.25,,1)
Gui.FormShell.txtSide1CutLenDim2.NumericOnly(1)
Gui.FormShell.txtSide1CutLenDim2.Parent("frame4")
Gui.FormShell.txtSide1CutLenDim2.Event(GotFocus,txtSide1CutLenDim2_GotFocus)
Gui.FormShell.txtSide2CutLenDim2.Create(TextBox,"",True,76,20,0,645,123,True,0,"Tahoma",8.25,,1)
Gui.FormShell.txtSide2CutLenDim2.NumericOnly(1)
Gui.FormShell.txtSide2CutLenDim2.Parent("frame4")
Gui.FormShell.txtSide2CutLenDim2.Event(GotFocus,txtSide2CutLenDim2_GotFocus)
Gui.FormShell.txtTopCutLenDim2.Create(TextBox,"",True,76,20,0,645,157,True,0,"Tahoma",8.25,,1)
Gui.FormShell.txtTopCutLenDim2.NumericOnly(1)
Gui.FormShell.txtTopCutLenDim2.Parent("frame4")
Gui.FormShell.txtTopCutLenDim2.Event(GotFocus,txtTopCutLenDim2_GotFocus)
Gui.FormShell.lblMaterial.Create(Label,"Material",True,38,13,0,78,66,True,0,"Tahoma",8.25,,0,0)
Gui.FormShell.lblMaterial.BorderStyle(0)
Gui.FormShell.lblMaterial.Parent("frame4")
Gui.FormShell.frame5.Create(Frame)
Gui.FormShell.frame5.Enabled(True)
Gui.FormShell.frame5.Visible(True)
Gui.FormShell.frame5.Zorder(0)
Gui.FormShell.frame5.Size(1022,275)
Gui.FormShell.frame5.Position(1,414)
Gui.FormShell.frame5.Caption("Router Sequences")
Gui.FormShell.frame5.FontName("Tahoma")
Gui.FormShell.frame5.FontSize(8.25)
Gui.FormShell.frame5.BorderStyle(1)
Gui.FormShell.frame5.Anchor(14)
Gui.FormShell.GsGridShellNewRout.Create(GsGridControl)
Gui.FormShell.GsGridShellNewRout.Enabled(True)
Gui.FormShell.GsGridShellNewRout.Visible(True)
Gui.FormShell.GsGridShellNewRout.Zorder(0)
Gui.FormShell.GsGridShellNewRout.Size(1022,249)
Gui.FormShell.GsGridShellNewRout.Position(0,26)
Gui.FormShell.GsGridShellNewRout.Parent("frame5")
Gui.FormShell.GsGridShellNewRout.Dock(5)
Gui.FormShell.GsGridShellNewRout.Anchor(15)
Program.Sub.ScreenSU.End

Program.Sub.Preflight.Start
Program.External.Include.Library("6021.lib")
Program.External.Include.Library("1500.Lib")
Program.External.Include.Library("400000.lib")
V.Global.lOp.Declare(Long,0)
V.Global.sSelection.Declare(String,"")
V.Global.sSort.Declare(String,"")
Program.Sub.Preflight.End

Program.Sub.Main.Start
F.Intrinsic.Control.SetErrorHandler("Main_Err")
F.Intrinsic.Control.ClearErrors

V.Local.sError.Declare(String,"")
V.Local.sCaption.Declare(String,"")
V.Local.sCustName.Declare(String,"")
V.Local.sSql.Declare(String,"")

Function.Intrinsic.UI.UsePixels ' Allows you to use Pixels instead of Twips throughout

F.Intrinsic.Control.SelectCase(V.Caller.Hook)
	
	F.Intrinsic.Control.Case(10260)
	'quote line screen
		V.Passed.000201.Set("Crate CALC")
	F.Intrinsic.Control.Case(10670)
		'Part number Passed Variable - 000052
		'Rev passed variable - 000053
		'Quantity Passed Variable - 000007
		'Price Passed Variable - 000009
		'Cost Passed Variable - 000012	
		'Customer Passed Variable - 000112
		'Description Passed Variable - 000056
		'UM Passed Variable - 000006
		'PL Passed Variable - 000013
		
		Gui.FormCrateSel..Show
		Gui.FormCrateSel..AlwaysOnTop(True)
		Gui.FormCrateSel..AlwaysOnTop(False)
		Gui.FormCrateSel..WaitForDismiss
		
		F.Global.General.ReadOption("401113",3,"","0000",V.Global.lOp)
		
		F.Intrinsic.Control.If(V.Global.sSelection,=,"CRATE")
			F.Intrinsic.Control.CallSub(Get_Data)
			F.Intrinsic.Control.CallSub(Set_Prop)

			F.ODBC.Connection!Con.OpenCompanyConnection
			F.Intrinsic.String.Build("Select rtrim(name_customer) From V_Customer_Master Where Customer = '{0}'",V.Passed.000112,V.Local.sSql)
			F.ODBC.Connection!Con.ExecuteAndReturn(v.Local.sSql,V.Local.sCustName)
			F.ODBC.Connection!con.Close
			
			F.Intrinsic.String.Build("REGULAR CRATES  |  CUSTOMER: {0}",V.Local.sCustName.UCase,V.Local.sCaption)
			Gui.FormRegCrate..Caption(V.Local.sCaption)
			
			Gui.FormRegCrate..show
			Gui.FormRegCrate..AlwaysOnTop(True)
			Gui.FormRegCrate..AlwaysOnTop(False)
		
		F.Intrinsic.Control.Else
			F.Intrinsic.Control.If(V.Global.sSelection,=,"SHELL")
				F.Intrinsic.Control.CallSub(Get_Data_Shell)
				F.Intrinsic.Control.CallSub(Set_Prop_Shell)

				F.ODBC.Connection!Con.OpenCompanyConnection
				F.Intrinsic.String.Build("Select rtrim(name_customer) From V_Customer_Master Where Customer = '{0}'",V.Passed.000112,V.Local.sSql)
				F.ODBC.Connection!Con.ExecuteAndReturn(v.Local.sSql,V.Local.sCustName)
				F.ODBC.Connection!con.Close
			
				F.Intrinsic.String.Build("SHELL CRATES  |  CUSTOMER: {0}",V.Local.sCustName.UCase,V.Local.sCaption)
				Gui.FormShell..Caption(V.Local.sCaption)
			
				Gui.FormShell..show
				Gui.FormShell..AlwaysOnTop(True)
				Gui.FormShell..AlwaysOnTop(False)
				
			F.Intrinsic.Control.Else
				F.Intrinsic.Control.End
			F.Intrinsic.Control.EndIf
		F.Intrinsic.Control.EndIf
F.Intrinsic.Control.EndSelect

F.Intrinsic.Control.ExitSub

F.Intrinsic.Control.Label("Main_Err")
F.Intrinsic.Control.If(V.Ambient.ErrorNumber,<>,0)
	F.Intrinsic.String.Build("Project: GCG_6761_Crate_Calc.g2u {0}{0}Subroutine: {1}{0}Error Occurred {2} with description {3}",V.Ambient.NewLine,V.Ambient.CurrentSubroutine,V.Ambient.ErrorNumber,V.Ambient.ErrorDescription,V.Local.sError)
	F.Intrinsic.UI.Msgbox(V.Local.sError)
	F.Intrinsic.Control.CallSub(FormRegCrate_UnLoad)
Function.Intrinsic.Control.EndIf
Program.Sub.Main.End

Program.Sub.Get_Data.Start
F.Intrinsic.Control.SetErrorHandler("Get_Data_Err")
F.Intrinsic.Control.ClearErrors

V.Local.sError.Declare(String,"")
V.Local.sRouter.Declare(String,"")
V.Local.sSql.Declare(String,"")
V.Local.sEval.Declare(String,"")
v.Local.fCP.Declare(Float,0)
V.Local.fSqft.Declare(Float,0)

F.Intrinsic.Control.If(V.DataTable.dtRouter.Exists)
	F.Data.Datatable.DeleteRow("dtRouter")
	F.Data.Datatable.AcceptChanges("dtRouter")
	V.Local.sRouter.Set(V.Screen.FormRegCrate!txtTemplate.Text)
	F.Intrinsic.String.Build("Select * From V_Router_Header Where Router = '{0}'",V.Local.sRouter.Trim,V.Local.sSql)
	F.Intrinsic.Control.If(V.DataTable.RHeader.Exists)
		F.Data.Datatable.Close("RHeader")
	F.Intrinsic.Control.EndIf
	F.ODBC.Connection!Con.OpenCompanyConnection
	F.Data.Datatable.CreateFromSQL("RHeader","Con",V.Local.sSql,True)
	F.Intrinsic.String.Build("Select * From V_Router_Line Where Router = '{0}' Order by Line_Router",V.Local.sRouter.Trim,V.Local.sSql)
	F.Intrinsic.Control.If(V.DataTable.RLine.Exists)
		F.Data.Datatable.Close("RLine")
	F.Intrinsic.Control.EndIf
	F.Data.Datatable.CreateFromSQL("RLine","Con",V.Local.sSql,True)
	F.Data.Datatable.AddColumn("RLine","Length",Float)
	F.Data.Datatable.AddColumn("RLine","Width",Float)
	F.Data.Dictionary.CreateFromSQL("Len","Con","Select Part, Length From V_Inventory_Mst2")
	F.Data.Dictionary.SetDefaultReturn("Len","0")
	F.Data.Datatable.FillFromDictionary("RLine","Len","Part_WC_Outside","Length")
	F.Data.Dictionary.Close("Len")
	F.Data.Dictionary.CreateFromSQL("Wid","Con","Select Part, Width From V_Inventory_Mst2")
	F.Data.Dictionary.SetDefaultReturn("Wid","0")
	F.Data.Datatable.FillFromDictionary("RLine","Wid","Part_WC_Outside","Width")
	F.Data.Dictionary.Close("Wid")
	F.Intrinsic.String.Build("Select * From GCG_6761_CRATE_MAINT Where Router = '{0}'",V.Local.sRouter.Trim,V.Local.sSql)
	F.Intrinsic.Control.If(V.DataTable.CrateCalc.Exists)
		F.Data.Datatable.Close("CrateCalc")
	F.Intrinsic.Control.EndIf

	F.Data.Datatable.CreateFromSQL("CrateCalc","Con",V.Local.sSql,True)
	F.ODBC.Connection!Con.Close
	F.Data.DataView.Create("CrateCalc","Temp",22,"OpCode = 'BASE B'","")
	F.Intrinsic.Control.If(V.DataView.CrateCalc!Temp.RowCount--,<>,-1)
			V.Local.sEval.Set(V.DataView.CrateCalc!Temp(V.DataView.CrateCalc!Temp.RowCount--).Dim1Qty!FieldVal)
		F.Intrinsic.Control.If(V.Local.sEval.IsNumeric)
			Gui.FormRegCrate.txtBaseQty.Text(V.Local.sEval.Float)
		F.Intrinsic.Control.Else
			F.Intrinsic.Control.If(V.Local.sEval.Trim,<>,"")
				F.Data.DataView.Create("RLine","Temp",22,"Operation = 'BASE B' and LMO = 'M'","")
				F.Intrinsic.Control.If(V.DataView.RLine!Temp.RowCount--,<>,-1)
					F.Intrinsic.Math.Mult(V.DataView.RLine!Temp(V.DataView.RLine!Temp.RowCount--).Length!FieldvalFloat,V.DataView.RLine!Temp(V.DataView.RLine!Temp.RowCount--).Width!FieldvalFloat,V.Local.fSqft)
					F.Intrinsic.String.Replace(V.Local.sEval,"[ML]",V.DataView.RLine!Temp(V.DataView.RLine!Temp.RowCount--).Length!FieldvalFloat,V.Local.sEval)
					F.Intrinsic.String.Replace(V.Local.sEval,"[MW]",V.DataView.RLine!Temp(V.DataView.RLine!Temp.RowCount--).Width!FieldvalFloat,V.Local.sEval)
					F.Intrinsic.String.Replace(V.Local.sEval,"[SF]",V.Local.fSqft,V.Local.sEval)
					F.Intrinsic.Control.Try
						F.Intrinsic.String.RegExReplace(V.Local.sEval,"/0","/1",True,True,V.Local.sEval)
						F.Intrinsic.Math.Evaluate(V.Local.sEval,v.Local.fCP)
						Gui.FormRegCrate.txtBaseQty.Text(V.Local.fCP)
					F.Intrinsic.Control.Catch
						Gui.FormRegCrate.txtBaseQty.Text("0")
					F.Intrinsic.Control.EndTry
				F.Intrinsic.Control.Else
					Gui.FormRegCrate.txtBaseQty.Text("0")
				F.Intrinsic.Control.EndIf
				F.Data.DataView.Close("RLine","Temp")
			F.Intrinsic.Control.Else
				Gui.FormRegCrate.txtBaseQty.Text("0")
			F.Intrinsic.Control.EndIf
		F.Intrinsic.Control.EndIf
	F.Intrinsic.Control.Else
		Gui.FormRegCrate.txtBaseQty.Text("0")
	F.Intrinsic.Control.EndIf
	F.Data.DataView.Close("CrateCalc","Temp")
F.Intrinsic.Control.Else
	f.Data.DataTable.Create("dtRouter",True)
	f.Data.DataTable.AddColumn("dtRouter","Router","string")
	f.Data.DataTable.AddColumn("dtRouter","Line_Router","string")
	f.Data.DataTable.AddColumn("dtRouter","LMO","string")
	f.Data.DataTable.AddColumn("dtRouter","Part_WC_Outside","string")
	f.Data.DataTable.AddColumn("dtRouter","Operation","string")
	f.Data.DataTable.AddColumn("dtRouter","Set_Up","float")
	f.Data.DataTable.AddColumn("dtRouter","Run_Time","float")
	f.Data.DataTable.AddColumn("dtRouter","UM_Inventory","string")
	f.Data.DataTable.AddColumn("dtRouter","Rate","float")
	f.Data.DataTable.AddColumn("dtRouter","Desc_Rt_Line","string")
	f.Data.DataTable.AddColumn("dtRouter","Cuts","string")
	
	f.Data.DataTable.Create("dtRouterTemp",True)
	f.Data.DataTable.AddColumn("dtRouterTemp","Router","string")
	f.Data.DataTable.AddColumn("dtRouterTemp","Line_Router","string")
	f.Data.DataTable.AddColumn("dtRouterTemp","LMO","string")
	f.Data.DataTable.AddColumn("dtRouterTemp","Part_WC_Outside","string")
	f.Data.DataTable.AddColumn("dtRouterTemp","Operation","string")
	f.Data.DataTable.AddColumn("dtRouterTemp","Set_Up","float")
	f.Data.DataTable.AddColumn("dtRouterTemp","Run_Time","float")
	f.Data.DataTable.AddColumn("dtRouterTemp","UM_Inventory","string")
	f.Data.DataTable.AddColumn("dtRouterTemp","Rate","float")
	f.Data.DataTable.AddColumn("dtRouterTemp","Desc_Rt_Line","string")
	f.Data.DataTable.AddColumn("dtRouterTemp","Cuts","string")
	
	f.Data.DataTable.Create("TempCuts",True)
	f.Data.DataTable.AddColumn("TempCuts","Line_Router","string")
	f.Data.DataTable.AddColumn("TempCuts","Operation","string")
	f.Data.DataTable.AddColumn("TempCuts","Cuts","string")
F.Intrinsic.Control.EndIf

F.Intrinsic.Control.ExitSub

F.Intrinsic.Control.Label("Get_Data_Err")
F.Intrinsic.Control.If(V.Ambient.ErrorNumber,<>,0)
	F.Intrinsic.String.Build("Project: GCG_6761_Crate_Calc.g2u {0}{0}Subroutine: {1}{0}Error Occurred {2} with description {3}",V.Ambient.NewLine,V.Ambient.CurrentSubroutine,V.Ambient.ErrorNumber,V.Ambient.ErrorDescription,V.Local.sError)
	F.Intrinsic.UI.Msgbox(V.Local.sError)
	F.Intrinsic.Control.CallSub(FormRegCrate_UnLoad)
Function.Intrinsic.Control.EndIf
Program.Sub.Get_Data.End

Program.Sub.Set_Prop.Start
F.Intrinsic.Control.SetErrorHandler("Set_Prop_Err")
F.Intrinsic.Control.ClearErrors

V.Local.sError.Declare(String,"")

gui.FormRegCrate.GsGridRouter.AddGridviewFromDatatable("gvRouter","dtRouter")

gui.FormRegCrate.GsGridRouter.SetGridviewProperty("gvRouter",v.Enum.GridViewPropertyNames!ShowGroupPanel,True)
gui.FormRegCrate.GsGridRouter.SetGridviewProperty("gvRouter",v.Enum.GridViewPropertyNames!AllowAddRows,False)
gui.FormRegCrate.GsGridRouter.SetGridviewProperty("gvRouter",v.Enum.GridViewPropertyNames!AllowDeleteRows,False)
gui.FormRegCrate.GsGridRouter.SetGridviewProperty("gvRouter",v.Enum.GridViewPropertyNames!AllowColumnMoving,False)
gui.FormRegCrate.GsGridRouter.SetGridviewProperty("gvRouter",v.Enum.GridViewPropertyNames!ColumnAutoWidth,True)

Gui.FormRegCrate.GsGridRouter.SetColumnProperty("gvRouter","Router",v.Enum.ColumnPropertyNames!Caption,"Router")
Gui.FormRegCrate.GsGridRouter.SetColumnProperty("gvRouter","Router",V.Enum.ColumnPropertyNames!HeaderForeColor,v.Color.PRI-GSS-00)
Gui.FormRegCrate.GsGridRouter.SetColumnProperty("gvRouter","Router",V.Enum.ColumnPropertyNames!HeaderFontBold,True)
Gui.FormRegCrate.GsGridRouter.SetColumnProperty("gvRouter","Router",V.Enum.ColumnPropertyNames!ReadOnly,True)
Gui.FormRegCrate.GsGridRouter.SetColumnProperty("gvRouter","Router",V.Enum.ColumnPropertyNames!AllowEdit,False)
Gui.FormRegCrate.GsGridRouter.SetColumnProperty("gvRouter","Router",V.Enum.ColumnPropertyNames!Visible,False)

Gui.FormRegCrate.GsGridRouter.SetColumnProperty("gvRouter","Line_Router",v.Enum.ColumnPropertyNames!Caption,"Seq")
Gui.FormRegCrate.GsGridRouter.SetColumnProperty("gvRouter","Line_Router",V.Enum.ColumnPropertyNames!HeaderForeColor,v.Color.PRI-GSS-00)
Gui.FormRegCrate.GsGridRouter.SetColumnProperty("gvRouter","Line_Router",V.Enum.ColumnPropertyNames!HeaderFontBold,True)
Gui.FormRegCrate.GsGridRouter.SetColumnProperty("gvRouter","Line_Router",V.Enum.ColumnPropertyNames!ReadOnly,True)
Gui.FormRegCrate.GsGridRouter.SetColumnProperty("gvRouter","Line_Router",V.Enum.ColumnPropertyNames!AllowEdit,False)
Gui.FormRegCrate.GsGridRouter.SetColumnProperty("gvRouter","Line_Router",V.Enum.ColumnPropertyNames!Visible,True)
Gui.FormRegCrate.GsGridRouter.SetColumnProperty("gvRouter","Line_Router",V.Enum.ColumnPropertyNames!Width,"50")

Gui.FormRegCrate.GsGridRouter.SetColumnProperty("gvRouter","LMO",v.Enum.ColumnPropertyNames!Caption,"Type")
Gui.FormRegCrate.GsGridRouter.SetColumnProperty("gvRouter","LMO",V.Enum.ColumnPropertyNames!HeaderForeColor,v.Color.PRI-GSS-00)
Gui.FormRegCrate.GsGridRouter.SetColumnProperty("gvRouter","LMO",V.Enum.ColumnPropertyNames!HeaderFontBold,True)
Gui.FormRegCrate.GsGridRouter.SetColumnProperty("gvRouter","LMO",V.Enum.ColumnPropertyNames!ReadOnly,True)
Gui.FormRegCrate.GsGridRouter.SetColumnProperty("gvRouter","LMO",V.Enum.ColumnPropertyNames!AllowEdit,False)
Gui.FormRegCrate.GsGridRouter.SetColumnProperty("gvRouter","LMO",V.Enum.ColumnPropertyNames!Visible,True)
Gui.FormRegCrate.GsGridRouter.SetColumnProperty("gvRouter","LMO",V.Enum.ColumnPropertyNames!Width,"50")

Gui.FormRegCrate.GsGridRouter.SetColumnProperty("gvRouter","Part_WC_Outside",v.Enum.ColumnPropertyNames!Caption,"Part / Workcenter")
Gui.FormRegCrate.GsGridRouter.SetColumnProperty("gvRouter","Part_WC_Outside",V.Enum.ColumnPropertyNames!HeaderForeColor,v.Color.PRI-GSS-00)
Gui.FormRegCrate.GsGridRouter.SetColumnProperty("gvRouter","Part_WC_Outside",V.Enum.ColumnPropertyNames!HeaderFontBold,True)
Gui.FormRegCrate.GsGridRouter.SetColumnProperty("gvRouter","Part_WC_Outside",V.Enum.ColumnPropertyNames!ReadOnly,True)
Gui.FormRegCrate.GsGridRouter.SetColumnProperty("gvRouter","Part_WC_Outside",V.Enum.ColumnPropertyNames!AllowEdit,False)
Gui.FormRegCrate.GsGridRouter.SetColumnProperty("gvRouter","Part_WC_Outside",V.Enum.ColumnPropertyNames!Visible,True)

Gui.FormRegCrate.GsGridRouter.SetColumnProperty("gvRouter","Operation",v.Enum.ColumnPropertyNames!Caption,"Op Code")
Gui.FormRegCrate.GsGridRouter.SetColumnProperty("gvRouter","Operation",V.Enum.ColumnPropertyNames!HeaderForeColor,v.Color.PRI-GSS-00)
Gui.FormRegCrate.GsGridRouter.SetColumnProperty("gvRouter","Operation",V.Enum.ColumnPropertyNames!HeaderFontBold,True)
Gui.FormRegCrate.GsGridRouter.SetColumnProperty("gvRouter","Operation",V.Enum.ColumnPropertyNames!ReadOnly,True)
Gui.FormRegCrate.GsGridRouter.SetColumnProperty("gvRouter","Operation",V.Enum.ColumnPropertyNames!AllowEdit,False)
Gui.FormRegCrate.GsGridRouter.SetColumnProperty("gvRouter","Operation",V.Enum.ColumnPropertyNames!Visible,True)
Gui.FormRegCrate.GsGridRouter.SetColumnProperty("gvRouter","Operation",V.Enum.ColumnPropertyNames!Width,"50")

Gui.FormRegCrate.GsGridRouter.SetColumnProperty("gvRouter","Set_Up",v.Enum.ColumnPropertyNames!Caption,"Setup")
Gui.FormRegCrate.GsGridRouter.SetColumnProperty("gvRouter","Set_Up",V.Enum.ColumnPropertyNames!HeaderForeColor,v.Color.PRI-GSS-00)
Gui.FormRegCrate.GsGridRouter.SetColumnProperty("gvRouter","Set_Up",V.Enum.ColumnPropertyNames!HeaderFontBold,True)
Gui.FormRegCrate.GsGridRouter.SetColumnProperty("gvRouter","Set_Up",V.Enum.ColumnPropertyNames!ReadOnly,True)
Gui.FormRegCrate.GsGridRouter.SetColumnProperty("gvRouter","Set_Up",V.Enum.ColumnPropertyNames!AllowEdit,False)
Gui.FormRegCrate.GsGridRouter.SetColumnProperty("gvRouter","Set_Up",V.Enum.ColumnPropertyNames!Visible,True)
Gui.FormRegCrate.GsGridRouter.SetColumnProperty("gvRouter","Set_Up",V.Enum.ColumnPropertyNames!Width,"50")

Gui.FormRegCrate.GsGridRouter.SetColumnProperty("gvRouter","Run_Time",v.Enum.ColumnPropertyNames!Caption,"Runtime")
Gui.FormRegCrate.GsGridRouter.SetColumnProperty("gvRouter","Run_Time",V.Enum.ColumnPropertyNames!HeaderForeColor,v.Color.PRI-GSS-00)
Gui.FormRegCrate.GsGridRouter.SetColumnProperty("gvRouter","Run_Time",V.Enum.ColumnPropertyNames!HeaderFontBold,True)
Gui.FormRegCrate.GsGridRouter.SetColumnProperty("gvRouter","Run_Time",V.Enum.ColumnPropertyNames!ReadOnly,False)
Gui.FormRegCrate.GsGridRouter.SetColumnProperty("gvRouter","Run_Time",V.Enum.ColumnPropertyNames!AllowEdit,True)
Gui.FormRegCrate.GsGridRouter.SetColumnProperty("gvRouter","Run_Time",V.Enum.ColumnPropertyNames!Visible,True)
Gui.FormRegCrate.GsGridRouter.SetColumnProperty("gvRouter","Run_Time",V.Enum.ColumnPropertyNames!Width,"50")

Gui.FormRegCrate.GsGridRouter.SetColumnProperty("gvRouter","UM_Inventory",v.Enum.ColumnPropertyNames!Caption,"Unit")
Gui.FormRegCrate.GsGridRouter.SetColumnProperty("gvRouter","UM_Inventory",V.Enum.ColumnPropertyNames!HeaderForeColor,v.Color.PRI-GSS-00)
Gui.FormRegCrate.GsGridRouter.SetColumnProperty("gvRouter","UM_Inventory",V.Enum.ColumnPropertyNames!HeaderFontBold,True)
Gui.FormRegCrate.GsGridRouter.SetColumnProperty("gvRouter","UM_Inventory",V.Enum.ColumnPropertyNames!ReadOnly,True)
Gui.FormRegCrate.GsGridRouter.SetColumnProperty("gvRouter","UM_Inventory",V.Enum.ColumnPropertyNames!AllowEdit,False)
Gui.FormRegCrate.GsGridRouter.SetColumnProperty("gvRouter","UM_Inventory",V.Enum.ColumnPropertyNames!Visible,True)
Gui.FormRegCrate.GsGridRouter.SetColumnProperty("gvRouter","UM_Inventory",V.Enum.ColumnPropertyNames!Width,"50")

Gui.FormRegCrate.GsGridRouter.SetColumnProperty("gvRouter","Rate",v.Enum.ColumnPropertyNames!Caption,"Rate")
Gui.FormRegCrate.GsGridRouter.SetColumnProperty("gvRouter","Rate",V.Enum.ColumnPropertyNames!HeaderForeColor,v.Color.PRI-GSS-00)
Gui.FormRegCrate.GsGridRouter.SetColumnProperty("gvRouter","Rate",V.Enum.ColumnPropertyNames!HeaderFontBold,True)
Gui.FormRegCrate.GsGridRouter.SetColumnProperty("gvRouter","Rate",V.Enum.ColumnPropertyNames!ReadOnly,False)
Gui.FormRegCrate.GsGridRouter.SetColumnProperty("gvRouter","Rate",V.Enum.ColumnPropertyNames!AllowEdit,True)
Gui.FormRegCrate.GsGridRouter.SetColumnProperty("gvRouter","Rate",V.Enum.ColumnPropertyNames!Visible,True)
Gui.FormRegCrate.GsGridRouter.SetColumnProperty("gvRouter","Rate",V.Enum.ColumnPropertyNames!Width,"50")

Gui.FormRegCrate.GsGridRouter.SetColumnProperty("gvRouter","Desc_Rt_Line",v.Enum.ColumnPropertyNames!Caption,"Description")
Gui.FormRegCrate.GsGridRouter.SetColumnProperty("gvRouter","Desc_Rt_Line",V.Enum.ColumnPropertyNames!HeaderForeColor,v.Color.PRI-GSS-00)
Gui.FormRegCrate.GsGridRouter.SetColumnProperty("gvRouter","Desc_Rt_Line",V.Enum.ColumnPropertyNames!HeaderFontBold,True)
Gui.FormRegCrate.GsGridRouter.SetColumnProperty("gvRouter","Desc_Rt_Line",V.Enum.ColumnPropertyNames!ReadOnly,True)
Gui.FormRegCrate.GsGridRouter.SetColumnProperty("gvRouter","Desc_Rt_Line",V.Enum.ColumnPropertyNames!AllowEdit,False)
Gui.FormRegCrate.GsGridRouter.SetColumnProperty("gvRouter","Desc_Rt_Line",V.Enum.ColumnPropertyNames!Visible,True)

Gui.FormRegCrate.GsGridRouter.SetColumnProperty("gvRouter","Cuts",v.Enum.ColumnPropertyNames!Caption,"Cuts")
Gui.FormRegCrate.GsGridRouter.SetColumnProperty("gvRouter","Cuts",V.Enum.ColumnPropertyNames!HeaderForeColor,v.Color.PRI-GSS-00)
Gui.FormRegCrate.GsGridRouter.SetColumnProperty("gvRouter","Cuts",V.Enum.ColumnPropertyNames!HeaderFontBold,True)
Gui.FormRegCrate.GsGridRouter.SetColumnProperty("gvRouter","Cuts",V.Enum.ColumnPropertyNames!ReadOnly,False)
Gui.FormRegCrate.GsGridRouter.SetColumnProperty("gvRouter","Cuts",V.Enum.ColumnPropertyNames!AllowEdit,True)
Gui.FormRegCrate.GsGridRouter.SetColumnProperty("gvRouter","Cuts",V.Enum.ColumnPropertyNames!Visible,True)
Gui.FormRegCrate.GsGridRouter.SetColumnProperty("gvRouter","Cuts",V.Enum.ColumnPropertyNames!CellWordWrap,"Wrap")

gui.FormRegCrate.GsGridRouter.MainView("gvRouter")

F.Intrinsic.Control.ExitSub

F.Intrinsic.Control.Label("Set_Prop_Err")
F.Intrinsic.Control.If(V.Ambient.ErrorNumber,<>,0)
	F.Intrinsic.String.Build("Project: GCG_6761_Crate_Calc.g2u {0}{0}Subroutine: {1}{0}Error Occurred {2} with description {3}",V.Ambient.NewLine,V.Ambient.CurrentSubroutine,V.Ambient.ErrorNumber,V.Ambient.ErrorDescription,V.Local.sError)
	F.Intrinsic.UI.Msgbox(V.Local.sError)
	F.Intrinsic.Control.CallSub(FormRegCrate_UnLoad)
Function.Intrinsic.Control.EndIf
Program.Sub.Set_Prop.End

Program.Sub.cmdCalc_Click.Start
F.Intrinsic.Control.SetErrorHandler("cmdCalc_Click_Err")
F.Intrinsic.Control.ClearErrors

V.Local.sError.Declare(String,"")
V.Local.sRouter.Declare(String,"")
V.Local.sTemp.Declare(String,"")
V.Local.iTemp.Declare(Long,0)
V.Local.i.Declare(Long,0)
V.Local.sStart.Declare(String,"")
V.Local.fSetUp.Declare(Float,0)
V.Local.fRunTime.Declare(Float,0)
V.Local.fRate.Declare(Float,0)
V.Local.sFilter.Declare(String,"")
V.Local.sCuts.Declare(String,"")
V.Local.sMsg.Declare(String,"")

F.Intrinsic.Control.If(V.Screen.FormRegCrate!txtTemplate.Text,=,"")
	V.Local.sMsg.Set("Select a Template Router")
F.Intrinsic.Control.EndIf

F.Intrinsic.Control.If(V.Screen.FormRegCrate!txtLength.Text,=,"")
	F.Intrinsic.Control.If(V.Local.sMsg.Trim,=,"")
		V.Local.sMsg.Set("Crate Length Missing")
	F.Intrinsic.Control.Else
		F.Intrinsic.String.Build("{0} and Crate Length Missing")
	F.Intrinsic.Control.EndIf
F.Intrinsic.Control.EndIf

F.Intrinsic.Control.If(V.Screen.FormRegCrate!txtWidth.Text,=,"")
	F.Intrinsic.Control.If(V.Local.sMsg.Trim,=,"")
		V.Local.sMsg.Set("Crate Width Missing")
	F.Intrinsic.Control.Else
		F.Intrinsic.String.Build("{0} and Crate Width Missing")
	F.Intrinsic.Control.EndIf
F.Intrinsic.Control.EndIf

F.Intrinsic.Control.If(V.Screen.FormRegCrate!txtHeight.Text,=,"")
	F.Intrinsic.Control.If(V.Local.sMsg.Trim,=,"")
		V.Local.sMsg.Set("Crate Height Missing")
	F.Intrinsic.Control.Else
		F.Intrinsic.String.Build("{0} and Crate Height Missing")
	F.Intrinsic.Control.EndIf
F.Intrinsic.Control.EndIf

F.Intrinsic.Control.If(V.Local.sMsg.Trim,<>,"")
	F.Intrinsic.UI.Msgbox(V.Local.sMsg,"Attention")
	F.Intrinsic.Control.ExitSub
F.Intrinsic.Control.EndIf

F.Intrinsic.String.Build("{0}x{1}x{2}",V.Screen.FormRegCrate!txtLength.Text,V.Screen.FormRegCrate!txtWidth.Text,V.Screen.FormRegCrate!txtHeight.Text,V.Local.sRouter)

F.ODBC.Connection!Con.OpenCompanyConnection
F.Intrinsic.String.Build("Select Sort_2 From V_Router_Header Where Router = '{0}'",V.Screen.FormRegCrate!txtTemplate.Text,V.Local.sStart)
F.ODBC.Connection!Con.ExecuteAndReturn(V.Local.sStart,V.Local.sStart)
V.Global.sSort.Set(V.Local.sStart.Trim)
F.ODBC.Connection!Con.Close

F.Intrinsic.String.Build("{0}-{1}",V.Local.sStart.Trim,V.Local.sRouter,V.Local.sRouter)

F.Data.DataTable.DeleteRow("dtRouterTemp")
F.Data.DataTable.AcceptChanges("dtRouterTemp")

F.Data.DataView.Create("RLine","MLine",22,"LMO = 'M'","Line_Router")
F.Intrinsic.Control.For(V.Local.i,0,V.DataView.RLine!MLine.RowCount--,1)
	F.Intrinsic.String.Build("Line_Router = '{0}'",V.DataView.RLine!MLine(V.Local.i).Line_Router!FieldValTrim,V.Local.sFilter)
	F.Data.DataView.Create("CrateCalc","Temp",22,V.Local.sFilter,"")
	F.Intrinsic.Control.If(V.DataView.CrateCalc!Temp.RowCount--,<>,-1)
		V.Local.fRate.Set(V.DataView.RLine!MLine(V.Local.i).Rate!FieldVal)
		V.Local.fSetUp.Set(V.DataView.RLine!MLine(V.Local.i).Set_Up!FieldVal)
		F.Intrinsic.Control.CallSub(Get_RunTime,"Index",V.Local.i)
		V.Local.fRunTime.Set(V.Args.RunTime)
		V.Local.sCuts.Set(V.Args.Cuts)
	F.Intrinsic.Control.Else
		V.Local.fRate.Set(V.DataView.RLine!MLine(V.Local.i).Rate!FieldVal)
		V.Local.fRunTime.Set(V.DataView.RLine!MLine(V.Local.i).Run_Time!FieldVal)
		V.Local.fSetUp.Set(V.DataView.RLine!MLine(V.Local.i).Set_Up!FieldVal)
		V.Local.sCuts.Set("")
	F.Intrinsic.Control.EndIf
	F.Intrinsic.Control.If(V.DataView.RLine!MLine(V.Local.i).UM_Inventory!FieldValTrim,<>,"SH","AND",V.DataView.RLine!MLine(V.Local.i).Operation!FieldValTrim,=,"TOP")
		F.Intrinsic.Control.If(V.Screen.FormRegCrate!chkTop.Value,=,1)
			F.Data.Datatable.AddRow("dtRouterTemp","Router",V.Local.sRouter,"Line_Router",V.DataView.RLine!MLine(V.Local.i).Line_Router!FieldVal,"LMO",V.DataView.RLine!MLine(V.Local.i).LMO!FieldVal,"Part_WC_Outside",V.DataView.RLine!MLine(V.Local.i).Part_WC_Outside!FieldVal,"Operation",V.DataView.RLine!MLine(V.Local.i).Operation!FieldVal,"Set_Up",V.Local.fSetUp,"Run_Time",V.Local.fRunTime,"UM_Inventory",V.DataView.RLine!MLine(V.Local.i).UM_Inventory!FieldVal,"Rate",V.Local.fRate,"Desc_Rt_Line",V.DataView.RLine!MLine(V.Local.i).Desc_Rt_Line!FieldVal,"Cuts",V.Local.sCuts)
		F.Intrinsic.Control.EndIf
	F.Intrinsic.Control.Else
		F.Data.Datatable.AddRow("dtRouterTemp","Router",V.Local.sRouter,"Line_Router",V.DataView.RLine!MLine(V.Local.i).Line_Router!FieldVal,"LMO",V.DataView.RLine!MLine(V.Local.i).LMO!FieldVal,"Part_WC_Outside",V.DataView.RLine!MLine(V.Local.i).Part_WC_Outside!FieldVal,"Operation",V.DataView.RLine!MLine(V.Local.i).Operation!FieldVal,"Set_Up",V.Local.fSetUp,"Run_Time",V.Local.fRunTime,"UM_Inventory",V.DataView.RLine!MLine(V.Local.i).UM_Inventory!FieldVal,"Rate",V.Local.fRate,"Desc_Rt_Line",V.DataView.RLine!MLine(V.Local.i).Desc_Rt_Line!FieldVal,"Cuts",V.Local.sCuts)
	F.Intrinsic.Control.EndIf
	F.Data.DataView.Close("CrateCalc","Temp")
F.Intrinsic.Control.Next(V.Local.i)

F.Data.DataTable.DeleteRow("dtRouter")
F.Data.DataTable.AcceptChanges("dtRouter")

F.Intrinsic.Control.For(V.Local.i,0,V.DataTable.dtRouterTemp.RowCount--,1)
	V.Local.fRunTime.Set(V.DataTable.dtRouterTemp(V.Local.i).Run_Time!FieldValFloat)
	F.Intrinsic.Math.Int(V.Local.fRunTime,V.Local.fSetUp)
	F.Intrinsic.Control.If(V.Local.fRunTime,<,V.Local.fSetUp)
		F.Intrinsic.Math.Sub(V.Local.fSetUp.Long,1,V.Local.fRunTime)
	F.Intrinsic.Control.Else
		F.Intrinsic.Math.Add(V.Local.fSetUp.Long,1,V.Local.fRunTime)
	F.Intrinsic.Control.EndIf
	F.Data.DataTable.SetValue("dtRouterTemp",V.Local.i,"Run_Time",V.Local.fRunTime)
F.Intrinsic.Control.Next(V.Local.i)

F.Data.DataTable.Merge("dtRouterTemp","dtRouter",4,2)

F.Data.DataView.Close("RLine","MLine")

F.Intrinsic.Control.ExitSub

F.Intrinsic.Control.Label("cmdCalc_Click_Err")
F.Intrinsic.Control.If(V.Ambient.ErrorNumber,<>,0)
	F.Intrinsic.String.Build("Project: GCG_6761_Crate_Calc.g2u {0}{0}Subroutine: {1}{0}Error Occurred {2} with description {3}",V.Ambient.NewLine,V.Ambient.CurrentSubroutine,V.Ambient.ErrorNumber,V.Ambient.ErrorDescription,V.Local.sError)
	F.Intrinsic.UI.Msgbox(V.Local.sError)
	F.Intrinsic.Control.CallSub(FormRegCrate_UnLoad)
Function.Intrinsic.Control.EndIf
Program.Sub.cmdCalc_Click.End

Program.Sub.cmdTemplate_Click.Start
F.Intrinsic.Control.SetErrorHandler("cmdTemplate_Click_Err")
F.Intrinsic.Control.ClearErrors

V.Local.sError.Declare(String,"")
V.Local.sRet.Declare(String,"")
V.Local.sSql.Declare(String,"")
V.Local.sTitles.Declare(String,"")
V.Local.sWidths.Declare(String,"")

F.Intrinsic.UI.SetBrowserHotTypeAhead(True)

F.ODBC.Connection!Con.OpenCompanyConnection

V.Local.sSql.Set("Select rtrim(Router), rtrim(Description_Router) From V_Router_Header Where ltrim(rtrim(ucase(Sort_1))) = 'TEMPLATE' Order by Router")

V.Local.sTitles.Set("Router*!*Description")
V.Local.sWidths.Set("1800*!*2400")

F.Intrinsic.String.Split(V.Local.sTitles,"*!*",V.Local.sTitles)
F.Intrinsic.String.Split(V.Local.sWidths,"*!*",V.Local.sWidths)

F.Intrinsic.UI.Browser("Select Template","con",V.Local.sSql,V.Local.sTitles,V.Local.sWidths,10200,8700,V.Local.sRet)

F.ODBC.Connection!Con.Close

F.Intrinsic.Control.If(V.Local.sRet,<>,"***CANCEL***")
	F.Intrinsic.String.Split(V.Local.sRet,"*!*",V.Local.sRet)
	Gui.FormRegCrate.txtTemplate.Text(V.Local.sRet.UCase)
	Gui.FormRegCrate.txtDesc.Text(V.Local.sRet.UCase)
	F.Intrinsic.Control.CallSub(Get_Data)
F.Intrinsic.Control.EndIf
	
F.Intrinsic.Control.ExitSub

F.Intrinsic.Control.Label("cmdTemplate_Click_Err")
F.Intrinsic.Control.If(V.Ambient.ErrorNumber,<>,0)
	F.Intrinsic.String.Build("Project: GCG_6761_Crate_Calc.g2u {0}{0}Subroutine: {1}{0}Error Occurred {2} with description {3}",V.Ambient.NewLine,V.Ambient.CurrentSubroutine,V.Ambient.ErrorNumber,V.Ambient.ErrorDescription,V.Local.sError)
	F.Intrinsic.UI.Msgbox(V.Local.sError)
	F.Intrinsic.Control.CallSub(FormRegCrate_UnLoad)
Function.Intrinsic.Control.EndIf
Program.Sub.cmdTemplate_Click.End

Program.Sub.txtTemplate_LostFocus.Start
F.Intrinsic.Control.SetErrorHandler("txtTemplate_LostFocus_Err")
F.Intrinsic.Control.ClearErrors

V.Local.sError.Declare(String,"")
V.Local.sRouter.Declare(String,"")
V.Local.sSql.Declare(String,"")

V.Local.sRouter.Set(V.Screen.FormRegCrate!txtTemplate_LostFocus.Text)
F.Intrinsic.Control.If(V.Local.sRouter.Trim,=,"")
	F.Intrinsic.Control.ExitSub
F.Intrinsic.Control.EndIf
F.Intrinsic.Control.BlockEvents
F.Intrinsic.String.Build("Select Router From V_Router_Header Where Router = '{0}'",V.Local.sRouter.Trim,V.Local.sSql)
F.ODBC.Connection!Conx.OpenCompanyConnection
F.ODBC.Connection!Conx.ExecuteAndReturn(V.Local.sSql,V.Local.sRouter)
F.ODBC.Connection!Conx.Close
F.Intrinsic.Control.If(V.Local.sRouter.Trim,<>,"")
	F.Intrinsic.Control.CallSub(Get_Data)
F.Intrinsic.Control.Else
	F.Intrinsic.UI.Msgbox("Template Router Not Found.....","Attention")
	Gui.FormRegCrate.txtTemplate_LostFocus.SetFocus
	Gui.FormRegCrate.txtTemplate_LostFocus.SelectAll
F.Intrinsic.Control.EndIf
F.Intrinsic.Control.UnBlockEvents

F.Intrinsic.Control.ExitSub

F.Intrinsic.Control.Label("txtTemplate_LostFocus_Err")
F.Intrinsic.Control.If(V.Ambient.ErrorNumber,<>,0)
	F.Intrinsic.String.Build("Project: GCG_6761_Crate_Calc.g2u {0}{0}Subroutine: {1}{0}Error Occurred {2} with description {3}",V.Ambient.NewLine,V.Ambient.CurrentSubroutine,V.Ambient.ErrorNumber,V.Ambient.ErrorDescription,V.Local.sError)
	F.Intrinsic.UI.Msgbox(V.Local.sError)
	F.Intrinsic.Control.CallSub(FormRegCrate_UnLoad)
Function.Intrinsic.Control.EndIf
Program.Sub.txtTemplate_LostFocus.End

Program.Sub.txtTemplate_GotFocus.Start
F.Intrinsic.Control.SetErrorHandler("txtTemplate_GotFocus_Err")
F.Intrinsic.Control.ClearErrors

V.Local.sError.Declare(String,"")

Gui.FormRegCrate.txtTemplate.SelectAll

F.Intrinsic.Control.ExitSub

F.Intrinsic.Control.Label("txtTemplate_GotFocus_Err")
F.Intrinsic.Control.If(V.Ambient.ErrorNumber,<>,0)
	F.Intrinsic.String.Build("Project: GCG_6761_Crate_Calc.g2u {0}{0}Subroutine: {1}{0}Error Occurred {2} with description {3}",V.Ambient.NewLine,V.Ambient.CurrentSubroutine,V.Ambient.ErrorNumber,V.Ambient.ErrorDescription,V.Local.sError)
	F.Intrinsic.UI.Msgbox(V.Local.sError)
	F.Intrinsic.Control.CallSub(FormRegCrate_UnLoad)
Function.Intrinsic.Control.EndIf
Program.Sub.txtTemplate_GotFocus.End

Program.Sub.txtLength_GotFocus.Start
F.Intrinsic.Control.SetErrorHandler("txtLength_GotFocus_Err")
F.Intrinsic.Control.ClearErrors

V.Local.sError.Declare(String,"")

Gui.FormRegCrate.txtLength.SelectAll

F.Intrinsic.Control.ExitSub

F.Intrinsic.Control.Label("txtLength_GotFocus_Err")
F.Intrinsic.Control.If(V.Ambient.ErrorNumber,<>,0)
	F.Intrinsic.String.Build("Project: GCG_6761_Crate_Calc.g2u {0}{0}Subroutine: {1}{0}Error Occurred {2} with description {3}",V.Ambient.NewLine,V.Ambient.CurrentSubroutine,V.Ambient.ErrorNumber,V.Ambient.ErrorDescription,V.Local.sError)
	F.Intrinsic.UI.Msgbox(V.Local.sError)
	F.Intrinsic.Control.CallSub(FormRegCrate_UnLoad)
Function.Intrinsic.Control.EndIf
Program.Sub.txtLength_GotFocus.End

Program.Sub.txtWidth_GotFocus.Start
F.Intrinsic.Control.SetErrorHandler("txtWidth_GotFocus_Err")
F.Intrinsic.Control.ClearErrors

V.Local.sError.Declare(String,"")

Gui.FormRegCrate.txtWidth.SelectAll

F.Intrinsic.Control.ExitSub

F.Intrinsic.Control.Label("txtWidth_GotFocus_Err")
F.Intrinsic.Control.If(V.Ambient.ErrorNumber,<>,0)
	F.Intrinsic.String.Build("Project: GCG_6761_Crate_Calc.g2u {0}{0}Subroutine: {1}{0}Error Occurred {2} with description {3}",V.Ambient.NewLine,V.Ambient.CurrentSubroutine,V.Ambient.ErrorNumber,V.Ambient.ErrorDescription,V.Local.sError)
	F.Intrinsic.UI.Msgbox(V.Local.sError)
	F.Intrinsic.Control.CallSub(FormRegCrate_UnLoad)
Function.Intrinsic.Control.EndIf
Program.Sub.txtWidth_GotFocus.End

Program.Sub.txtHeight_GotFocus.Start
F.Intrinsic.Control.SetErrorHandler("txtHeight_GotFocus_Err")
F.Intrinsic.Control.ClearErrors

V.Local.sError.Declare(String,"")

Gui.FormRegCrate.txtHeight.SelectAll

F.Intrinsic.Control.ExitSub

F.Intrinsic.Control.Label("txtHeight_GotFocus_Err")
F.Intrinsic.Control.If(V.Ambient.ErrorNumber,<>,0)
	F.Intrinsic.String.Build("Project: GCG_6761_Crate_Calc.g2u {0}{0}Subroutine: {1}{0}Error Occurred {2} with description {3}",V.Ambient.NewLine,V.Ambient.CurrentSubroutine,V.Ambient.ErrorNumber,V.Ambient.ErrorDescription,V.Local.sError)
	F.Intrinsic.UI.Msgbox(V.Local.sError)
	F.Intrinsic.Control.CallSub(FormRegCrate_UnLoad)
Function.Intrinsic.Control.EndIf
Program.Sub.txtHeight_GotFocus.End

Program.Sub.FormRegCrate_UnLoad.Start
F.Intrinsic.Control.SetErrorHandler("FormRegCrate_UnLoad_Err")
F.Intrinsic.Control.ClearErrors

V.Local.sError.Declare(String,"")

F.Intrinsic.Control.End

F.Intrinsic.Control.ExitSub

F.Intrinsic.Control.Label("FormRegCrate_UnLoad_Err")
F.Intrinsic.Control.If(V.Ambient.ErrorNumber,<>,0)
	F.Intrinsic.Control.End
Function.Intrinsic.Control.EndIf
Program.Sub.FormRegCrate_UnLoad.End

Program.Sub.FormRegCrate_SaveButtonClick.Start
F.Intrinsic.Control.SetErrorHandler("FormRegCrate_SaveButtonClick_Err")
F.Intrinsic.Control.ClearErrors

V.Local.sError.Declare(String,"")
V.Local.iRet.Declare(Long,0)
V.Local.i.Declare(Long,0)
V.Local.iC.Declare(Long,0)
V.Local.sDesc.Declare(String,"")
V.Local.sFilter.Declare(String,"")
V.Local.sComment.Declare(String,"")
V.Local.iSeq.Declare(Long,0)
V.Local.sSeq.Declare(String,"")
V.Local.sSql.Declare(String,"")
V.Local.sPart.Declare(String,"")
V.Local.sRunTime.Declare(String,"")
V.Local.sRate.Declare(String,"")
V.Local.sSetup.Declare(String,"")
V.Local.sPL.Declare(String,"")
V.Local.sUM.Declare(String,"")
V.Local.sDate.Declare(String,"")

F.Intrinsic.String.Format(V.Ambient.Date,"MMDDYY",V.Local.sDate)

F.Intrinsic.String.Build("{3} Crate {0}x{1}x{2}",V.Screen.FormRegCrate!txtLength.Text,V.Screen.FormRegCrate!txtWidth.Text,V.Screen.FormRegCrate!txtHeight.Text,V.Global.sSort,V.Local.sDesc)

F.Intrinsic.Control.If(V.Local.sDesc.Length,>,30)
	F.Intrinsic.String.Left(V.Local.sDesc,30,V.Local.sDesc)
F.Intrinsic.Control.EndIf

F.ODBC.Connection!Con.OpenCompanyConnection
F.Intrinsic.String.Build("Select Part From V_Inventory_Mstr Where Part = '{0}'",V.DataTable.dtRouter(V.DataTable.dtRouter.RowCount--).Router!FieldValTrim,V.Local.sSql)
F.ODBC.Connection!Con.ExecuteAndReturn(V.Local.sSql,V.Local.sPart)

V.Local.sPL.Set(V.DataTable.RHeader(V.DataTable.RHeader.RowCount--).Prod_Line!FieldValTrim)
V.Local.sUM.Set(V.DataTable.RHeader(V.DataTable.RHeader.RowCount--).UM_Inventory!FieldValTrim)

F.Intrinsic.Control.If(V.Local.sPart.Trim,=,V.DataTable.dtRouter(V.DataTable.dtRouter.RowCount--).Router!FieldValTrim)
	F.Global.Inventory.CreatePart(V.DataTable.dtRouter(V.DataTable.dtRouter.RowCount--).Router!FieldValTrim,V.DataTable.RHeader(V.DataTable.RHeader.RowCount--).UM_Inventory!FieldValTrim,V.Local.sDesc,"",V.DataTable.RHeader(V.DataTable.RHeader.RowCount--).Prod_Line!FieldValTrim,"","","",0,"NOMAINT")
F.Intrinsic.Control.EndIf

F.Intrinsic.Control.If(V.DataTable.dtRouter.RowCount--,<>,-1)
	F.Intrinsic.UI.Msgbox("Are you sure you want to create a New Part/Router?","New Part/Router",4,V.Local.iRet)
	F.Intrinsic.Control.If(V.Local.iRet,=,6)
		F.Intrinsic.Control.For(V.Local.i,0,V.DataTable.RLine.RowCount--,1)
			F.Intrinsic.Control.SelectCase(V.DataTable.RLine(V.Local.i).LMO!FieldValTrim)
				F.Intrinsic.Control.Case("L")
					F.Intrinsic.Math.Add(V.Local.iSeq,V.Global.lOp,V.Local.iSeq)
					F.Intrinsic.String.Format(V.Local.iSeq,"000000",V.Local.sSeq)
					F.Intrinsic.String.Format(V.DataTable.RLine(V.Local.i).Run_Time!FieldVal,"#0.0000",V.Local.sRunTime)
					F.Intrinsic.String.Format(V.DataTable.RLine(V.Local.i).Rate!FieldVal,"#0.0000",V.Local.sRate)
					F.Intrinsic.String.Format(V.DataTable.RLine(V.Local.i).Set_Up!FieldVal,"#0.0000",V.Local.sSetup)
					F.Data.DataTable.AddRow("6021","OriginalDate",V.Local.sDate,"RouterNum",V.DataTable.dtRouter(V.DataTable.dtRouter.RowCount--).Router!FieldValTrim,"RouterDesc",V.Local.sDesc,"RunTimeMatlQty",V.Local.sRunTime,"RateUC",V.Local.sRate,"SetupQty",V.Local.sSetup,"Seq",V.Local.sSeq,"LineType","L","WC",V.DataTable.RLine(V.Local.i).Part_WC_Outside!FieldValTrim,"PartStepDesc",V.DataTable.RLine(V.Local.i).Desc_Rt_Line!FieldValTrim,"UM",V.DataTable.RLine(V.Local.i).UM_Inventory!FieldValTrim,"PL",V.DataTable.RHeader(V.DataTable.RHeader.RowCount--).Prod_Line!FieldValTrim)
					
				F.Intrinsic.Control.Case("M")
					F.Intrinsic.Math.Add(V.Local.iSeq,V.Global.lOp,V.Local.iSeq)
					F.Intrinsic.String.Format(V.Local.iSeq,"000000",V.Local.sSeq)
					F.Intrinsic.String.Build("Line_Router = '{0}'",V.DataTable.RLine(V.Local.i).Line_Router!FieldValTrim,V.Local.sFilter)
					F.Data.DataView.Create("dtRouter","MTemp",22,V.Local.sFilter,"")
					F.Intrinsic.Control.If(V.DataView.dtRouter!MTemp.RowCount--,<>,-1)
						F.Intrinsic.String.Format(V.DataView.dtRouter!MTemp(V.DataView.dtRouter!MTemp.RowCount--).Run_Time!FieldVal,"#0.0000",V.Local.sRunTime)
						F.Intrinsic.String.Format(V.DataView.dtRouter!MTemp(V.DataView.dtRouter!MTemp.RowCount--).Rate!FieldVal,"#0.0000",V.Local.sRate)
						F.Intrinsic.String.Format(V.DataView.dtRouter!MTemp(V.DataView.dtRouter!MTemp.RowCount--).Set_Up!FieldVal,"#0.0000",V.Local.sSetup)
						F.Data.DataTable.AddRow("6021","OriginalDate",V.Local.sDate,"RouterNum",V.DataTable.dtRouter(V.DataTable.dtRouter.RowCount--).Router!FieldValTrim,"RouterDesc",V.Local.sDesc,"RunTimeMatlQty",V.Local.sRunTime,"RateUC",V.Local.sRate,"SetupQty",V.Local.sSetup,"Seq",V.Local.sSeq,"LineType","M","PartNum",V.DataTable.RLine(V.Local.i).Part_WC_Outside!FieldValTrim,"PartStepDesc",V.DataTable.RLine(V.Local.i).Desc_Rt_Line!FieldValTrim,"UM",V.DataTable.RLine(V.Local.i).UM_Inventory!FieldValTrim,"PL",V.DataTable.RHeader(V.DataTable.RHeader.RowCount--).Prod_Line!FieldValTrim)
					F.Intrinsic.Control.EndIf
					F.Data.DataView.Close("dtRouter","MTemp")
					
				F.Intrinsic.Control.Case("O")
					F.Intrinsic.Math.Add(V.Local.iSeq,V.Global.lOp,V.Local.iSeq)
					F.Intrinsic.String.Format(V.Local.iSeq,"000000",V.Local.sSeq)
					F.Intrinsic.String.Format(V.DataTable.RLine(V.Local.i).Run_Time!FieldVal,"#0.0000",V.Local.sRunTime)
					F.Intrinsic.String.Format(V.DataTable.RLine(V.Local.i).Rate!FieldVal,"#0.0000",V.Local.sRate)
					F.Intrinsic.String.Format(V.DataTable.RLine(V.Local.i).Set_Up!FieldVal,"#0.0000",V.Local.sSetup)
					F.Data.DataTable.AddRow("6021","OriginalDate",V.Local.sDate,"RouterNum",V.DataTable.dtRouter(V.DataTable.dtRouter.RowCount--).Router!FieldValTrim,"RouterDesc",V.Local.sDesc,"RunTimeMatlQty",V.Local.sRunTime,"RateUC",V.Local.sRate,"SetupQty",V.Local.sSetup,"Seq",V.Local.sSeq,"LineType","O","PartNum",V.DataTable.RLine(V.Local.i).Part_WC_Outside!FieldValTrim,"PartStepDesc",V.DataTable.RLine(V.Local.i).Desc_Rt_Line!FieldValTrim,"UM",V.DataTable.RLine(V.Local.i).UM_Inventory!FieldValTrim,"PL",V.DataTable.RHeader(V.DataTable.RHeader.RowCount--).Prod_Line!FieldValTrim)
					
				F.Intrinsic.Control.Case("C")
					F.Intrinsic.String.Format("0","#0.0000",V.Local.sRunTime)
					F.Intrinsic.String.Format("0","#0.0000",V.Local.sRate)
					F.Intrinsic.String.Format("0","#0.0000",V.Local.sSetup)
					V.Local.sComment.Redim(0,0)
					F.Intrinsic.String.Build("Line_Router = '{0}' and LMO = 'M'",V.DataTable.RLine(V.Local.i).Operation!FieldValTrim,V.Local.sFilter)
					F.Data.DataView.Create("dtRouter","MTemp",22,V.Local.sFilter,"")
					
					F.Intrinsic.Control.If(V.DataView.dtRouter!MTemp.RowCount--,<>,-1)
						F.Intrinsic.String.Split(V.DataView.dtRouter!MTemp(V.DataView.dtRouter!MTemp.RowCount--).Cuts!FieldValTrim,"|",V.Local.sComment)
						F.Intrinsic.Control.For(V.Local.iC,0,V.Local.sComment.UBound,1)
							F.Intrinsic.Math.Add(V.Local.iSeq,V.Global.lOp,V.Local.iSeq)
							F.Intrinsic.String.Format(V.Local.iSeq,"000000",V.Local.sSeq)
							F.Data.DataTable.AddRow("6021","OriginalDate",V.Local.sDate,"RouterNum",V.DataTable.dtRouter(V.DataTable.dtRouter.RowCount--).Router!FieldValTrim,"RouterDesc",V.Local.sDesc,"RunTimeMatlQty",V.Local.sRunTime,"RateUC",V.Local.sRate,"SetupQty",V.Local.sSetup,"Seq",V.Local.sSeq,"LineType","C","PartStepDesc",V.Local.sComment(V.Local.iC).Trim,"PL",V.DataTable.RHeader(V.DataTable.RHeader.RowCount--).Prod_Line!FieldValTrim,"Freq", "0", "WCFactor", "0", "Overlap", "0", "LeadTime", "0", "MainCommentFlag", "Y")
						F.Intrinsic.Control.Next(V.Local.iC)
					F.Intrinsic.Control.Else
						F.Intrinsic.Control.If(V.DataTable.RLine(V.Local.i).Operation!FieldValTrim,=,"")
							F.Intrinsic.Math.Add(V.Local.iSeq,V.Global.lOp,V.Local.iSeq)
							F.Intrinsic.String.Format(V.Local.iSeq,"000000",V.Local.sSeq)
							F.Data.DataTable.AddRow("6021","OriginalDate",V.Local.sDate,"RouterNum",V.DataTable.dtRouter(V.DataTable.dtRouter.RowCount--).Router!FieldValTrim,"RouterDesc",V.Local.sDesc,"RunTimeMatlQty",V.Local.sRunTime,"RateUC",V.Local.sRate,"SetupQty",V.Local.sSetup,"Seq",V.Local.sSeq,"LineType","C","PartStepDesc",V.DataTable.RLine(V.Local.i).Desc_Rt_Line!FieldValTrim,"PL",V.DataTable.RHeader(V.DataTable.RHeader.RowCount--).Prod_Line!FieldValTrim,"Freq", "0", "WCFactor", "0", "Overlap", "0", "LeadTime", "0", "MainCommentFlag", "Y")
						F.Intrinsic.Control.EndIf
					F.Intrinsic.Control.EndIf
					F.Data.DataView.Close("dtRouter","MTemp")
			F.Intrinsic.Control.EndSelect
		F.Intrinsic.Control.Next(V.Local.i)
	F.Intrinsic.Control.Else
		F.Intrinsic.Control.ExitSub
	F.Intrinsic.Control.EndIf
F.Intrinsic.Control.EndIf

F.Intrinsic.Control.If(V.DataTable.6021.RowCount--,<>,-1)
	V.Local.iSeq.Set(V.DataTable.6021(V.DataTable.6021.RowCount--).Seq!FieldValLong)
	F.Intrinsic.Control.If(V.Screen.FormRegCrate!chk2x2.Value,=,1)
		F.Intrinsic.Math.Add(V.Local.iSeq,V.Global.lOp,V.Local.iSeq)
		F.Intrinsic.String.Format(V.Local.iSeq,"000000",V.Local.sSeq)
		F.Data.DataTable.AddRow("6021","OriginalDate",V.Local.sDate,"RouterNum",V.DataTable.dtRouter(V.DataTable.dtRouter.RowCount--).Router!FieldValTrim,"RouterDesc",V.Local.sDesc,"RunTimeMatlQty",V.Local.sRunTime,"RateUC",V.Local.sRate,"SetupQty",V.Local.sSetup,"Seq",V.Local.sSeq,"LineType","C","PartStepDesc","Add 2x2 Bracing","PL",V.DataTable.RHeader(V.DataTable.RHeader.RowCount--).Prod_Line!FieldValTrim,"Freq", "0", "WCFactor", "0", "Overlap", "0", "LeadTime", "0", "MainCommentFlag", "Y")
	F.Intrinsic.Control.EndIf
	F.Intrinsic.Control.If(V.Screen.FormRegCrate!chk2x4.Value,=,1)
		F.Intrinsic.Math.Add(V.Local.iSeq,V.Global.lOp,V.Local.iSeq)
		F.Intrinsic.String.Format(V.Local.iSeq,"000000",V.Local.sSeq)
		F.Data.DataTable.AddRow("6021","OriginalDate",V.Local.sDate,"RouterNum",V.DataTable.dtRouter(V.DataTable.dtRouter.RowCount--).Router!FieldValTrim,"RouterDesc",V.Local.sDesc,"RunTimeMatlQty",V.Local.sRunTime,"RateUC",V.Local.sRate,"SetupQty",V.Local.sSetup,"Seq",V.Local.sSeq,"LineType","C","PartStepDesc","Add 2x4 Bracing","PL",V.DataTable.RHeader(V.DataTable.RHeader.RowCount--).Prod_Line!FieldValTrim,"Freq", "0", "WCFactor", "0", "Overlap", "0", "LeadTime", "0", "MainCommentFlag", "Y")
	F.Intrinsic.Control.EndIf
	
	F.Intrinsic.String.Build("Select Router From V_Router_Header Where Router = '{0}'",V.DataTable.dtRouter(V.DataTable.dtRouter.RowCount--).Router!FieldValTrim,V.Local.sSql)
	F.ODBC.Connection!Con.ExecuteAndReturn(V.Local.sSql,V.Local.sPart)

	F.Intrinsic.Control.If(V.Local.sPart.Trim,<>,"")
		F.Intrinsic.String.Build("Delete From Router_Header Where Router = '{0}'",V.DataTable.dtRouter(V.DataTable.dtRouter.RowCount--).Router!FieldValTrim,V.Local.sSql)
		F.ODBC.Connection!Con.Execute(V.Local.sSql)
		F.Intrinsic.String.Build("Delete From ROUTER_SUPP_HDR Where Rtr_Num = '{0}'",V.DataTable.dtRouter(V.DataTable.dtRouter.RowCount--).Router!FieldValTrim,V.Local.sSql)
		F.ODBC.Connection!Con.Execute(V.Local.sSql)
	F.Intrinsic.Control.EndIf

	F.Intrinsic.Control.CallSub(6021Sync)
F.Intrinsic.Control.EndIf

F.Data.Datatable.DeleteRow("6021")
F.Data.Datatable.AcceptChanges("6021")

'F.Global.General.CallWrappersync(50,"RE0017")

F.Data.DataTable.AddRow("400000","Mode","O","Router",V.DataTable.dtRouter(V.DataTable.dtRouter.RowCount--).Router!FieldValTrim)

F.Intrinsic.Control.CallSub(400000Sync)

F.Data.DataTable.AddRow("1500","ROUTER",V.DataTable.dtRouter(V.DataTable.dtRouter.RowCount--).Router!FieldValTrim,"Quantity",1)
F.Intrinsic.Control.CallSub(1500sync)

F.Intrinsic.Control.CallSub(Get_Cost)

V.Passed.000052.Set(V.DataTable.dtRouter(V.DataTable.dtRouter.RowCount--).Router!FieldValTrim)
V.Passed.000056.Set(V.Local.sDesc.Trim)
v.Passed.000006.Set(V.Local.sUM)
V.Passed.000013.Set(V.Local.sPL)

F.Intrinsic.Control.CallSub(FormRegCrate_UnLoad)

F.Intrinsic.Control.ExitSub

F.Intrinsic.Control.Label("FormRegCrate_SaveButtonClick_Err")
F.Intrinsic.Control.If(V.Ambient.ErrorNumber,<>,0)
	F.Intrinsic.String.Build("Project: GCG_6761_Crate_Calc.g2u {0}{0}Subroutine: {1}{0}Error Occurred {2} with description {3}",V.Ambient.NewLine,V.Ambient.CurrentSubroutine,V.Ambient.ErrorNumber,V.Ambient.ErrorDescription,V.Local.sError)
	F.Intrinsic.UI.Msgbox(V.Local.sError)
	F.Intrinsic.Control.CallSub(FormRegCrate_UnLoad)
Function.Intrinsic.Control.EndIf
Program.Sub.FormRegCrate_SaveButtonClick.End

Program.Sub.Get_RunTime.Start
F.Intrinsic.Control.SetErrorHandler("Get_RunTime_Err")
F.Intrinsic.Control.ClearErrors

V.Local.sError.Declare(String,"")
V.Local.fTemp1.Declare(Float,0)
V.Local.fTemp2.Declare(Float,0)
V.Local.fTemp3.Declare(Float,0)
V.Local.fSqft.Declare(Float,0)
V.Local.fMLen.Declare(Float,0)
V.Local.fMWid.Declare(Float,0)
V.Local.fCL.Declare(Float,0)
V.Local.fCW.Declare(Float,0)
V.Local.fCH.Declare(Float,0)
V.Local.fCP1.Declare(Float,0)
V.Local.fCP2.Declare(Float,0)
V.Local.sEval.Declare(String,"")
V.Local.fRunTime.Declare(Float,0)
V.Local.fRunTime1.Declare(Float,0)
V.Local.fRunTime2.Declare(Float,0)
V.Local.sCuts.Declare(String,"")
V.Local.sTemp.Declare(String,"")
V.Local.fRemLen.Declare(Float,0)
V.Local.fRemWid.Declare(Float,0)
V.Local.sTempCut1.Declare(String,"")
V.Local.sTempCut2.Declare(String,"")
V.Local.sTempCut3.Declare(String,"")
V.Local.sTempCut4.Declare(String,"")
V.Local.fTempRunTime1.Declare(Float,0)
V.Local.fHalfLen.Declare(Float,0)
V.Local.fHalfWid.Declare(Float,0)

V.Local.fMWid.Set(V.DataView.RLine!MLine(V.Args.Index).Width!FieldValFloat)
F.Intrinsic.Math.Div(V.Local.fMWid,2,V.Local.fHalfWid)
V.Local.fMLen.Set(V.DataView.RLine!MLine(V.Args.Index).Length!FieldValFloat)
F.Intrinsic.Math.Div(V.Local.fMLen,2,V.Local.fHalfLen)

F.Intrinsic.Math.Mult(V.Local.fMWid,V.Local.fMLen,V.Local.fSqft)

V.Local.fCL.Set(V.Screen.FormRegCrate!txtLength.Text)
V.Local.fCW.Set(V.Screen.FormRegCrate!txtWidth.Text)
V.Local.fCH.Set(V.Screen.FormRegCrate!txtHeight.Text)

F.Intrinsic.Control.If(V.DataView.CrateCalc!Temp(V.DataView.CrateCalc!Temp.RowCount--).OpCode!FieldValTrim,=,"BASE B")
	V.Local.fCP1.Set(V.Screen.FormRegCrate!txtBaseQty.Text)
F.Intrinsic.Control.Else
	V.Local.sEval.Set(V.DataView.CrateCalc!Temp(V.DataView.CrateCalc!Temp.RowCount--).Dim1Qty!FieldVal)
	F.Intrinsic.Control.If(V.Local.sEval.IsNumeric)
		V.Local.fCP1.Set(V.Local.sEval.Float)
	F.Intrinsic.Control.Else
		F.Intrinsic.Control.If(V.Local.sEval.Trim,<>,"")
			F.Intrinsic.String.Replace(V.Local.sEval,"[CL]",V.Local.fCL,V.Local.sEval)
			F.Intrinsic.String.Replace(V.Local.sEval,"[CW]",V.Local.fCW,V.Local.sEval)
			F.Intrinsic.String.Replace(V.Local.sEval,"[CH]",V.Local.fCH,V.Local.sEval)
			F.Intrinsic.String.Replace(V.Local.sEval,"[ML]",V.Local.fMLen,V.Local.sEval)
			F.Intrinsic.String.Replace(V.Local.sEval,"[MW]",V.Local.fMWid,V.Local.sEval)
			F.Intrinsic.String.Replace(V.Local.sEval,"[SF]",V.Local.fSqft,V.Local.sEval)
			F.Intrinsic.Control.Try
				F.Intrinsic.String.RegExReplace(V.Local.sEval,"/0","/1",True,True,V.Local.sEval)
				F.Intrinsic.Math.Evaluate(V.Local.sEval,v.Local.fCP1)
				F.Intrinsic.Math.Int(V.Local.fCP1,V.Local.fTemp1)
				F.Intrinsic.Control.If(V.Local.fCP1,<,V.Local.fTemp1)
					F.Intrinsic.Math.Sub(V.Local.fTemp1.Long,1,V.Local.fCP1)
				F.Intrinsic.Control.Else
					F.Intrinsic.Math.Add(V.Local.fTemp1.Long,1,V.Local.fCP1)
				F.Intrinsic.Control.EndIf
			F.Intrinsic.Control.Catch
				V.Local.fCP1.Set(1)
			F.Intrinsic.Control.EndTry
		F.Intrinsic.Control.Else
			V.Local.fCP1.Set(0)
		F.Intrinsic.Control.EndIf
	F.Intrinsic.Control.EndIf
F.Intrinsic.Control.EndIf

V.Local.sEval.Set(V.DataView.CrateCalc!Temp(V.DataView.CrateCalc!Temp.RowCount--).Dim2Qty!FieldVal)
F.Intrinsic.Control.If(V.Local.sEval.IsNumeric)
	V.Local.fCP2.Set(V.Local.sEval.Float)
F.Intrinsic.Control.Else
	F.Intrinsic.Control.If(V.Local.sEval.Trim,<>,"")
		F.Intrinsic.String.Replace(V.Local.sEval,"[CL]",V.Local.fCL,V.Local.sEval)
		F.Intrinsic.String.Replace(V.Local.sEval,"[CW]",V.Local.fCW,V.Local.sEval)
		F.Intrinsic.String.Replace(V.Local.sEval,"[CH]",V.Local.fCH,V.Local.sEval)
		F.Intrinsic.String.Replace(V.Local.sEval,"[ML]",V.Local.fMLen,V.Local.sEval)
		F.Intrinsic.String.Replace(V.Local.sEval,"[MW]",V.Local.fMWid,V.Local.sEval)
		F.Intrinsic.String.Replace(V.Local.sEval,"[SF]",V.Local.fSqft,V.Local.sEval)
		F.Intrinsic.Control.Try
			F.Intrinsic.String.RegExReplace(V.Local.sEval,"/0","/1",True,True,V.Local.sEval)
			F.Intrinsic.Math.Evaluate(V.Local.sEval,v.Local.fCP2)
			F.Intrinsic.Math.Int(V.Local.fCP2,V.Local.fTemp1)
				F.Intrinsic.Control.If(V.Local.fCP2,<,V.Local.fTemp1)
					F.Intrinsic.Math.Sub(V.Local.fTemp1.Long,1,V.Local.fCP2)
				F.Intrinsic.Control.Else
					F.Intrinsic.Math.Add(V.Local.fTemp1.Long,1,V.Local.fCP2)
				F.Intrinsic.Control.EndIf
		F.Intrinsic.Control.Catch
			V.Local.fCP2.Set(1)
		F.Intrinsic.Control.EndTry
	F.Intrinsic.Control.Else
		V.Local.fCP2.Set(0)
	F.Intrinsic.Control.EndIf
F.Intrinsic.Control.EndIf
	
V.Local.sEval.Set(V.DataView.CrateCalc!Temp(V.DataView.CrateCalc!Temp.RowCount--).Dim1Form!FieldValTrim)

F.Intrinsic.String.Replace(V.Local.sEval,"[CL]",V.Local.fCL,V.Local.sEval)
F.Intrinsic.String.Replace(V.Local.sEval,"[CW]",V.Local.fCW,V.Local.sEval)
F.Intrinsic.String.Replace(V.Local.sEval,"[CH]",V.Local.fCH,V.Local.sEval)
F.Intrinsic.String.Replace(V.Local.sEval,"[ML]",V.Local.fMLen,V.Local.sEval)
F.Intrinsic.String.Replace(V.Local.sEval,"[MW]",V.Local.fMWid,V.Local.sEval)
F.Intrinsic.String.Replace(V.Local.sEval,"[SF]",V.Local.fSqft,V.Local.sEval)
F.Intrinsic.String.Replace(V.Local.sEval,"[CP]",V.Local.fCP1,V.Local.sEval)

F.Intrinsic.String.RegExReplace(V.Local.sEval,"/0","/1",True,True,V.Local.sEval)

F.Intrinsic.Control.If(V.Local.sEval.Trim,<>,"")
	F.Intrinsic.Control.Try
		F.Intrinsic.Math.Evaluate(V.Local.sEval,v.Local.fRunTime1)
	F.Intrinsic.Control.Catch
		V.Local.fRunTime1.Set(0)
	F.Intrinsic.Control.EndTry
F.Intrinsic.Control.Else
	V.Local.fRunTime1.Set(0)
F.Intrinsic.Control.EndIf

V.Local.sEval.Set(V.DataView.CrateCalc!Temp(V.DataView.CrateCalc!Temp.RowCount--).Dim2Form!FieldValTrim)

F.Intrinsic.String.Replace(V.Local.sEval,"[CL]",V.Local.fCL,V.Local.sEval)
F.Intrinsic.String.Replace(V.Local.sEval,"[CW]",V.Local.fCW,V.Local.sEval)
F.Intrinsic.String.Replace(V.Local.sEval,"[CH]",V.Local.fCH,V.Local.sEval)
F.Intrinsic.String.Replace(V.Local.sEval,"[ML]",V.Local.fMLen,V.Local.sEval)
F.Intrinsic.String.Replace(V.Local.sEval,"[MW]",V.Local.fMWid,V.Local.sEval)
F.Intrinsic.String.Replace(V.Local.sEval,"[SF]",V.Local.fSqft,V.Local.sEval)
F.Intrinsic.String.Replace(V.Local.sEval,"[CP]",V.Local.fCP2,V.Local.sEval)

F.Intrinsic.String.RegExReplace(V.Local.sEval,"/0","/1",True,True,V.Local.sEval)

F.Intrinsic.Control.If(V.Local.sEval.Trim,<>,"")
	F.Intrinsic.Control.Try
		F.Intrinsic.Math.Evaluate(V.Local.sEval,v.Local.fRunTime2)
	F.Intrinsic.Control.Catch
		V.Local.fRunTime2.Set(0)
	F.Intrinsic.Control.EndTry
F.Intrinsic.Control.Else
	V.Local.fRunTime2.Set(0)
F.Intrinsic.Control.EndIf

F.Intrinsic.Control.If(V.DataView.RLine!MLine(V.Args.Index).UM_Inventory!FieldValTrim,<>,"SH")
	F.Intrinsic.Control.SelectCase(V.DataView.CrateCalc!Temp(V.DataView.CrateCalc!Temp.RowCount--).OPCODE!FieldValTrim)
			
		F.Intrinsic.Control.CaseElse
			F.Intrinsic.Control.If(V.Local.fCP1,>,0,"AND",V.Local.fCP2,>,0)
				V.Local.fTemp1.Set(V.Local.fRunTime1)
				V.Local.fTemp2.Set(V.Local.fRunTime2)
				F.Intrinsic.Math.Mult(V.Local.fCP1,V.Local.fRunTime1,V.Local.fRunTime1)
				F.Intrinsic.Math.Mult(V.Local.fCP2,V.Local.fRunTime2,V.Local.fRunTime2)
				F.Intrinsic.Math.Add(V.Local.fRunTime1,V.Local.fRunTime2,V.Local.fRunTime)
				F.Intrinsic.Control.If(V.Local.fMLen,=,0)
					V.Local.fRunTime.Set(0)
				F.Intrinsic.Control.Else
					F.Intrinsic.Math.Div(V.Local.fRunTime,V.Local.fMLen,V.Local.fRunTime)
				F.Intrinsic.Control.EndIf
				F.Intrinsic.Control.If(V.Local.fTemp1,>,V.Local.fMLen)
					F.Intrinsic.String.Build("{0}: {1}",V.Local.fCP1,V.Local.fMLen,V.Local.sTempCut1)
					F.Intrinsic.Math.Sub(V.Local.fTemp1,V.Local.fMLen,V.Local.fTemp3)
					F.Intrinsic.String.Build("{0} | {1}: {2}",V.Local.sTempCut1,V.Local.fCP1,V.Local.fTemp3,V.Local.sTempCut1)
				F.Intrinsic.Control.EndIf
				F.Intrinsic.Control.If(V.Local.fTemp1,<,V.Local.fMLen)
					F.Intrinsic.String.Build("{0}: {1}",V.Local.fCP1,V.Local.fTemp1,V.Local.sTempCut1)
				F.Intrinsic.Control.EndIf
				F.Intrinsic.Control.If(V.Local.fTemp2,>,V.Local.fMLen)
					F.Intrinsic.String.Build("{0}: {1}",V.Local.fCP2,V.Local.fMLen,V.Local.sTempCut2)
					F.Intrinsic.Math.Sub(V.Local.fTemp2,V.Local.fMLen,V.Local.fTemp3)
					F.Intrinsic.String.Build("{0} | {1}: {2}",V.Local.sTempCut2,V.Local.fCP2,V.Local.fTemp3,V.Local.sTempCut2)
				F.Intrinsic.Control.EndIf
				F.Intrinsic.Control.If(V.Local.fTemp2,<,V.Local.fMLen)
					F.Intrinsic.String.Build("{0}: {1}",V.Local.fCP2,V.Local.fTemp2,V.Local.sTempCut2)
				F.Intrinsic.Control.EndIf
				
				F.Intrinsic.String.Build("{0} | {1}",V.Local.sTempCut1,V.Local.sTempCut2,V.Local.sCuts)
				
			F.Intrinsic.Control.ElseIf(V.Local.fCP1,>,0,"AND",V.Local.fCP2,<=,0)
				V.Local.fTemp1.Set(V.Local.fRunTime1)
				F.Intrinsic.Math.Mult(V.Local.fCP1,V.Local.fRunTime1,V.Local.fRunTime1)
				V.Local.fRunTime.Set(V.Local.fRunTime1)
				F.Intrinsic.Control.If(V.Local.fMLen,=,0)
					V.Local.fRunTime.Set(0)
				F.Intrinsic.Control.Else
					F.Intrinsic.Math.Div(V.Local.fRunTime,V.Local.fMLen,V.Local.fRunTime)
				F.Intrinsic.Control.EndIf
				F.Intrinsic.Control.If(V.Local.fTemp1,>,V.Local.fMLen)
					F.Intrinsic.String.Build("{0}: {1}",V.Local.fCP1,V.Local.fMLen,V.Local.sCuts)
					F.Intrinsic.Math.Sub(V.Local.fTemp1,V.Local.fMLen,V.Local.fTemp3)
					F.Intrinsic.String.Build("{0} | {1}: {2}",V.Local.sCuts,V.Local.fCP1,V.Local.fTemp3,V.Local.sCuts)
				F.Intrinsic.Control.ElseIf(V.Local.fTemp1,<,V.Local.fMLen)
					F.Intrinsic.String.Build("{0}: {1}",V.Local.fCP1,V.Local.fTemp1,V.Local.sCuts)
				F.Intrinsic.Control.EndIf
				
			F.Intrinsic.Control.ElseIf(V.Local.fCP1,<=,0,"AND",V.Local.fCP2,>,0)
				V.Local.fTemp1.Set(V.Local.fRunTime2)
				F.Intrinsic.Math.Mult(V.Local.fCP2,V.Local.fRunTime2,V.Local.fRunTime2)
				V.Local.fRunTime.Set(V.Local.fRunTime2)
				F.Intrinsic.Control.If(V.Local.fMLen,=,0)
					V.Local.fRunTime.Set(0)
				F.Intrinsic.Control.Else
					F.Intrinsic.Math.Div(V.Local.fRunTime,V.Local.fMLen,V.Local.fRunTime)
				F.Intrinsic.Control.EndIf
				F.Intrinsic.Control.If(V.Local.fTemp1,>,V.Local.fMLen)
					F.Intrinsic.String.Build("{0}: {1}",V.Local.fCP1,V.Local.fMLen,V.Local.sCuts)
					F.Intrinsic.Math.Sub(V.Local.fTemp1,V.Local.fMLen,V.Local.fTemp3)
					F.Intrinsic.String.Build("{0} | {1}: {2}",V.Local.sCuts,V.Local.fCP1,V.Local.fTemp3,V.Local.sCuts)
				F.Intrinsic.Control.ElseIf(V.Local.fTemp1,<,V.Local.fMLen)
					F.Intrinsic.String.Build("{0}: {1}",V.Local.fCP1,V.Local.fTemp1,V.Local.sCuts)
				F.Intrinsic.Control.EndIf
				
			F.Intrinsic.Control.EndIf
			
	F.Intrinsic.Control.EndSelect
F.Intrinsic.Control.Else
	F.Intrinsic.Control.SelectCase(V.DataView.CrateCalc!Temp(V.DataView.CrateCalc!Temp.RowCount--).OPCODE!FieldValTrim)

		F.Intrinsic.Control.Case("TOP")
			V.Local.fRunTime.Set(0)

			'figuring out partials
			F.Intrinsic.Control.If(V.Local.fRunTime1,>,V.Local.fMLen,"AND",V.Local.fRunTime2,>,V.Local.fMWid)
				F.Intrinsic.Control.If(V.Local.fMLen,=,0)
					V.Local.fTemp1.Set(0)
				F.Intrinsic.Control.Else
					F.Intrinsic.Math.Div(V.Local.fRunTime1,V.Local.fMLen,V.Local.fTemp1)
				F.Intrinsic.Control.EndIf
				F.Intrinsic.String.Split(V.Local.fTemp1.String,".",V.Local.sTemp)
				F.Intrinsic.Control.If(V.Local.sTemp.UBound,>,0)
					F.Intrinsic.Math.Mult(V.Local.fMLen,V.Local.sTemp.Long,V.Local.fRemLen)
					F.Intrinsic.Math.Sub(V.Local.fRunTime1,V.Local.fRemLen,V.Local.fRemLen)
					F.Intrinsic.Math.Mult(V.Local.sTemp.Long,V.Local.fCP1,V.Local.fTemp1)
				F.Intrinsic.Control.Else
					F.Intrinsic.Math.Mult(V.Local.sTemp.Long,V.Local.fCP1,V.Local.fTemp1)
				F.Intrinsic.Control.EndIf
				
				F.Intrinsic.Control.If(V.Local.fMWid,=,0)
					V.Local.fTemp2.Set(0)
				F.Intrinsic.Control.Else
					F.Intrinsic.Math.Div(V.Local.fRunTime2,V.Local.fMWid,V.Local.fTemp2)
				F.Intrinsic.Control.EndIf
				F.Intrinsic.String.Split(V.Local.fTemp2.String,".",V.Local.sTemp)
				F.Intrinsic.Control.If(V.Local.sTemp.UBound,>,0)
					F.Intrinsic.Math.Mult(V.Local.fMWid,V.Local.sTemp.Long,V.Local.fRemWid)
					F.Intrinsic.Math.Sub(V.Local.fRunTime2,V.Local.fRemWid,V.Local.fRemWid)
					F.Intrinsic.Math.Mult(V.Local.sTemp.Long,V.Local.fCP2,V.Local.fTemp2)
				F.Intrinsic.Control.Else
					F.Intrinsic.Math.Mult(V.Local.sTemp.Long,V.Local.fCP2,V.Local.fTemp2)
				F.Intrinsic.Control.EndIf
				
				F.Intrinsic.Control.If(V.Local.fTemp1.Long,=,V.Local.fTemp2.Long)
					F.Intrinsic.Math.Mult(V.Local.fTemp1.Long,V.Local.fCP1,V.Local.fTemp3)
					F.Intrinsic.Math.Add(V.Local.fRunTime,V.Local.fTemp3.Long,V.Local.fRunTime)
					F.Intrinsic.String.Build("{0}: {1} x {2}",V.Local.fTemp3.Long,V.Local.fMLen,V.Local.fMWid,V.Local.sCuts)
					F.Intrinsic.Control.If(V.Local.fRemLen,>,0)
						F.Intrinsic.Math.Mult(V.Local.fRemLen,V.Local.fMWid,V.Local.fTempRunTime1)
						F.Intrinsic.Math.Mult(V.Local.fTempRunTime1,V.Local.fTemp1.Long,V.Local.fTempRunTime1)
						F.Intrinsic.Control.If(V.Local.fSqft,=,0)
							V.Local.fTempRunTime1.Set(0)
						F.Intrinsic.Control.Else
							F.Intrinsic.Math.Div(V.Local.fTempRunTime1,V.Local.fSqft,V.Local.fTempRunTime1)
						F.Intrinsic.Control.EndIf
						F.Intrinsic.Math.Add(V.Local.fRunTime,V.Local.fTempRunTime1,V.Local.fRunTime)
						
						F.Intrinsic.String.Build("{0} | {1}: {2} x {3}",V.Local.sCuts,V.Local.fTemp1.Long,V.Local.fRemLen,V.Local.fMWid,V.Local.sCuts)
					F.Intrinsic.Control.EndIf
					F.Intrinsic.Control.If(V.Local.fRemWid,>,0)
						F.Intrinsic.Math.Mult(V.Local.fRemWid,V.Local.fMLen,V.Local.fTempRunTime1)
						F.Intrinsic.Math.Mult(V.Local.fTempRunTime1,V.Local.fTemp2.Long,V.Local.fTempRunTime1)
						F.Intrinsic.Control.If(V.Local.fSqft,=,0)
							V.Local.fTempRunTime1.Set(0)
						F.Intrinsic.Control.Else
							F.Intrinsic.Math.Div(V.Local.fTempRunTime1,V.Local.fSqft,V.Local.fTempRunTime1)
						F.Intrinsic.Control.EndIf
						F.Intrinsic.Math.Add(V.Local.fRunTime,V.Local.fTempRunTime1,V.Local.fRunTime)
						F.Intrinsic.String.Build("{0} | {1}: {2} x {3}",V.Local.sCuts,V.Local.fTemp2.Long,V.Local.fMLen,V.Local.fRemWid,V.Local.sCuts)
					F.Intrinsic.Control.EndIf
					F.Intrinsic.Control.If(V.Local.fRemLen,>,0,"AND",V.Local.fRemWid,>,0)
						F.Intrinsic.Math.Mult(V.Local.fRemLen,V.Local.fRemWid,V.Local.fTempRunTime1)
						F.Intrinsic.Control.If(V.Local.fSqft,=,0)
							V.Local.fTempRunTime1.Set(0)
						F.Intrinsic.Control.Else
							F.Intrinsic.Math.Div(V.Local.fTempRunTime1,V.Local.fSqft,V.Local.fTempRunTime1)
						F.Intrinsic.Control.EndIf
						F.Intrinsic.Math.Add(V.Local.fRunTime,V.Local.fTempRunTime1,V.Local.fRunTime)
						F.Intrinsic.String.Build("{0} | {1}: {2} x {3}",V.Local.sCuts,"1",V.Local.fRemLen,V.Local.fRemWid,V.Local.sCuts)
					F.Intrinsic.Control.EndIf
					F.Intrinsic.Control.If(V.Screen.FormRegCrate!chkTop.Value,=,1)
						'figureing addtional stick cuts
						F.Intrinsic.String.Build("Operation = '{0}' and LMO = 'M' and UM_Inventory <> 'SH'",V.DataView.CrateCalc!Temp(V.DataView.CrateCalc!Temp.RowCount--).OPCODE!FieldValTrim,V.Local.sTemp)
						F.Data.DataView.Create("RLine","MTemp",22,V.Local.sTemp,"")
						F.Data.DataView.Create("dtRouterTemp","TEMP",22,V.Local.sTemp,"")
						F.Intrinsic.Control.If(V.DataView.RLine!MTemp.RowCount--,<>,-1)
							V.Local.fMWid.Set(V.DataView.RLine!MTemp(V.DataView.RLine!MTemp.RowCount--).Width!FieldValFloat)
							V.Local.fMLen.Set(V.DataView.RLine!MTemp(V.DataView.RLine!MTemp.RowCount--).Length!FieldValFloat)
							F.Intrinsic.Math.Mult(V.Local.fMWid,2,V.Local.fMWid)
							F.Intrinsic.Math.Sub(V.Local.fRunTime1,V.Local.fMWid,V.Local.fRunTime1)
							F.Intrinsic.Math.Sub(V.Local.fRunTime2,V.Local.fMWid,V.Local.fRunTime2)
							F.Intrinsic.Control.If(V.Local.fRunTime1,>,V.Local.fMLen)
								F.Intrinsic.String.Build("{0}: {1}",V.Local.fTemp1.Long,V.Local.fMLen,V.Local.sTempCut3)
								F.Intrinsic.Math.Sub(V.Local.fRunTime1,V.Local.fMLen,V.Local.fTemp3)
								F.Intrinsic.String.Build("{0} | {1}: {2}",V.Local.sTempCut3,V.Local.fTemp1.Long,V.Local.fTemp3,V.Local.sTempCut3)
							F.Intrinsic.Control.EndIf
							F.Intrinsic.Control.If(V.Local.fRunTime1,<,V.Local.fMLen)
								F.Intrinsic.String.Build("{0}: {1}",V.Local.fTemp1.Long,V.Local.fRunTime1,V.Local.sTempCut3)
							F.Intrinsic.Control.EndIf
							F.Intrinsic.Control.If(V.Local.fRunTime2,>,V.Local.fMLen)
								F.Intrinsic.String.Build("{0}: {1}",V.Local.fTemp2.Long,V.Local.fMLen,V.Local.sTempCut4)
								F.Intrinsic.Math.Sub(V.Local.fRunTime2,V.Local.fMLen,V.Local.fTemp3)
								F.Intrinsic.String.Build("{0} | {1}: {2}",V.Local.sTempCut4,V.Local.fTemp2.Long,V.Local.fTemp3,V.Local.sTempCut4)
							F.Intrinsic.Control.EndIf
							F.Intrinsic.Control.If(V.Local.fRunTime2,<,V.Local.fMLen)
								F.Intrinsic.String.Build("{0}: {1}",V.Local.fTemp2.Long,V.Local.fRunTime2,V.Local.sTempCut4)
							F.Intrinsic.Control.EndIf
							
							F.Intrinsic.Math.Add(V.Local.fRunTime1,V.Local.fRunTime2,V.Local.fTempRunTime1)
							F.Intrinsic.Control.If(V.Local.fMLen,=,0)
								V.Local.fTempRunTime1.Set(0)
							F.Intrinsic.Control.Else
								F.Intrinsic.Math.Div(V.Local.fTempRunTime1,V.Local.fMLen,V.Local.fTempRunTime1)
							F.Intrinsic.Control.EndIf
							F.Intrinsic.Math.Add(V.Local.fTempRunTime1,V.DataView.dtRouterTemp!Temp(V.DataView.dtRouterTemp!Temp.RowCount--).Run_Time!FieldValFloat,V.Local.fTempRunTime1)
							F.Intrinsic.String.Build("{0} | {1} | {2}",V.DataView.dtRouterTemp!Temp(V.DataView.dtRouterTemp!Temp.RowCount--).Cuts!FieldValTrim,V.Local.sTempCut3,V.Local.sTempCut4,V.Local.sTempCut4)
							F.Data.DataView.SetValue("dtRouterTemp","Temp",-1,"Run_Time",V.Local.fTempRunTime1,"Cuts",V.Local.sTempCut4)
						F.Intrinsic.Control.EndIf
						F.Data.DataView.Close("RLine","MTemp")
						F.Data.DataView.Close("dtRouterTemp","Temp")
					F.Intrinsic.Control.EndIf
					
				F.Intrinsic.Control.ElseIf(V.Local.fTemp1.Long,>,V.Local.fTemp2.Long)
					F.Intrinsic.Math.Mult(V.Local.fTemp1.Long,V.Local.fCP1,V.Local.fTemp3)
					F.Intrinsic.Math.Add(V.Local.fRunTime,V.Local.fTemp3.Long,V.Local.fRunTime)
					F.Intrinsic.String.Build("{0}: {1} x {2}",V.Local.fTemp3.Long,V.Local.fMLen,V.Local.fMWid,V.Local.sCuts)
					F.Intrinsic.Control.If(V.Local.fRemLen,>,0)
						F.Intrinsic.Control.If(V.Local.fRemLen,>,V.Local.fHalfLen)
							F.Intrinsic.Math.Add(V.Local.fRunTime,V.Local.fTemp1.Long,V.Local.fRunTime)
						F.Intrinsic.Control.Else
							F.Intrinsic.Math.Mult(V.Local.fRemLen,V.Local.fMWid,V.Local.fTempRunTime1)
							F.Intrinsic.Math.Mult(V.Local.fTempRunTime1,V.Local.fTemp1.Long,V.Local.fTempRunTime1)
							F.Intrinsic.Control.If(V.Local.fSqft,=,0)
								V.Local.fTempRunTime1.Set(0)
							F.Intrinsic.Control.Else
								F.Intrinsic.Math.Div(V.Local.fTempRunTime1,V.Local.fSqft,V.Local.fTempRunTime1)
							F.Intrinsic.Control.EndIf
							F.Intrinsic.Math.Add(V.Local.fRunTime,V.Local.fTempRunTime1,V.Local.fRunTime)
						F.Intrinsic.Control.EndIf
						F.Intrinsic.String.Build("{0} | {1}: {2} x {3}",V.Local.sCuts,V.Local.fTemp1.Long,V.Local.fRemLen,V.Local.fMWid,V.Local.sCuts)
					F.Intrinsic.Control.EndIf
					F.Intrinsic.Control.If(V.Local.fRemWid,>,0)
						F.Intrinsic.Control.If(V.Local.fRemWid,>,V.Local.fHalfWid)
							F.Intrinsic.Math.Add(V.Local.fRunTime,V.Local.fTemp2.Long,V.Local.fRunTime)
						F.Intrinsic.Control.Else
							F.Intrinsic.Math.Mult(V.Local.fRemWid,V.Local.fMLen,V.Local.fTempRunTime1)
							F.Intrinsic.Math.Mult(V.Local.fTempRunTime1,V.Local.fTemp2.Long,V.Local.fTempRunTime1)
							F.Intrinsic.Control.If(V.Local.fSqft,=,0)
								V.Local.fTempRunTime1.Set(0)
							F.Intrinsic.Control.Else
								F.Intrinsic.Math.Div(V.Local.fTempRunTime1,V.Local.fSqft,V.Local.fTempRunTime1)
							F.Intrinsic.Control.EndIf
							F.Intrinsic.Math.Add(V.Local.fRunTime,V.Local.fTempRunTime1,V.Local.fRunTime)
						F.Intrinsic.Control.EndIf
						F.Intrinsic.String.Build("{0} | {1}: {2} x {3}",V.Local.sCuts,V.Local.fTemp2.Long,V.Local.fMLen,V.Local.fRemWid,V.Local.sCuts)
					F.Intrinsic.Control.EndIf
					F.Intrinsic.Control.If(V.Local.fRemLen,>,0,"AND",V.Local.fRemWid,>,0)
						F.Intrinsic.Math.Mult(V.Local.fRemLen,V.Local.fRemWid,V.Local.fTempRunTime1)
						F.Intrinsic.Control.If(V.Local.fSqft,=,0)
							V.Local.fTempRunTime1.Set(0)
						F.Intrinsic.Control.Else
							F.Intrinsic.Math.Div(V.Local.fTempRunTime1,V.Local.fSqft,V.Local.fTempRunTime1)
						F.Intrinsic.Control.EndIf
						F.Intrinsic.Math.Add(V.Local.fRunTime,V.Local.fTempRunTime1,V.Local.fRunTime)
						F.Intrinsic.String.Build("{0} | {1}: {2} x {3}",V.Local.sCuts,"1",V.Local.fRemLen,V.Local.fRemWid,V.Local.sCuts)
					F.Intrinsic.Control.EndIf
					F.Intrinsic.Control.If(V.Screen.FormRegCrate!chkTop.Value,=,1)
						'figureing addtional stick cuts
						F.Intrinsic.String.Build("Operation = '{0}' and LMO = 'M' and UM_Inventory <> 'SH'",V.DataView.CrateCalc!Temp(V.DataView.CrateCalc!Temp.RowCount--).OPCODE!FieldValTrim,V.Local.sTemp)
						F.Data.DataView.Create("RLine","MTemp",22,V.Local.sTemp,"")
						F.Data.DataView.Create("dtRouterTemp","TEMP",22,V.Local.sTemp,"")
						F.Intrinsic.Control.If(V.DataView.RLine!MTemp.RowCount--,<>,-1)
							V.Local.fMWid.Set(V.DataView.RLine!MTemp(V.DataView.RLine!MTemp.RowCount--).Width!FieldValFloat)
							V.Local.fMLen.Set(V.DataView.RLine!MTemp(V.DataView.RLine!MTemp.RowCount--).Length!FieldValFloat)
							F.Intrinsic.Math.Mult(V.Local.fMWid,2,V.Local.fMWid)
							F.Intrinsic.Math.Sub(V.Local.fRunTime1,V.Local.fMWid,V.Local.fRunTime1)
							F.Intrinsic.Control.If(V.Local.fRunTime1,>,V.Local.fMLen)
								F.Intrinsic.String.Build("{0}: {1}",V.Local.fTemp1.Long,V.Local.fMLen,V.Local.sTempCut3)
								F.Intrinsic.Math.Sub(V.Local.fRunTime1,V.Local.fMLen,V.Local.fTemp3)
								F.Intrinsic.String.Build("{0} | {1}: {2}",V.Local.sTempCut3,V.Local.fTemp1.Long,V.Local.fTemp3,V.Local.sTempCut3)
							F.Intrinsic.Control.EndIf
							F.Intrinsic.Control.If(V.Local.fRunTime1,<,V.Local.fMLen)
								F.Intrinsic.String.Build("{0}: {1}",V.Local.fTemp1.Long,V.Local.fRunTime1,V.Local.sTempCut3)
							F.Intrinsic.Control.EndIf
							F.Intrinsic.Control.If(V.Local.fRunTime2,>,V.Local.fMLen)
								F.Intrinsic.String.Build("{0}: {1}",V.Local.fTemp1.Long,V.Local.fMLen,V.Local.sTempCut4)
								F.Intrinsic.Math.Sub(V.Local.fRunTime2,V.Local.fMLen,V.Local.fTemp3)
								F.Intrinsic.String.Build("{0} | {1}: {2}",V.Local.sTempCut4,V.Local.fTemp1.Long,V.Local.fTemp3,V.Local.sTempCut4)
							F.Intrinsic.Control.EndIf
							F.Intrinsic.Control.If(V.Local.fRunTime2,<,V.Local.fMLen)
								F.Intrinsic.String.Build("{0}: {1}",V.Local.fTemp1.Long,V.Local.fRunTime2,V.Local.sTempCut4)
							F.Intrinsic.Control.EndIf
							
							F.Intrinsic.Math.Add(V.Local.fRunTime1,V.Local.fRunTime2,V.Local.fTempRunTime1)
							F.Intrinsic.Control.If(V.Local.fMLen,=,0)
								V.Local.fTempRunTime1.Set(0)
							F.Intrinsic.Control.Else
								F.Intrinsic.Math.Div(V.Local.fTempRunTime1,V.Local.fMLen,V.Local.fTempRunTime1)
							F.Intrinsic.Control.EndIf
							F.Intrinsic.Math.Add(V.Local.fTempRunTime1,V.DataView.dtRouterTemp!Temp(V.DataView.dtRouterTemp!Temp.RowCount--).Run_Time!FieldValFloat,V.Local.fTempRunTime1)
							F.Intrinsic.String.Build("{0} | {1} | {2}",V.DataView.dtRouterTemp!Temp(V.DataView.dtRouterTemp!Temp.RowCount--).Cuts!FieldValTrim,V.Local.sTempCut3,V.Local.sTempCut4,V.Local.sTempCut4)
							F.Data.DataView.SetValue("dtRouterTemp","Temp",-1,"Run_Time",V.Local.fTempRunTime1,"Cuts",V.Local.sTempCut4)
						F.Intrinsic.Control.EndIf
						F.Data.DataView.Close("RLine","MTemp")
						F.Data.DataView.Close("dtRouterTemp","Temp")
					F.Intrinsic.Control.EndIf
					
				F.Intrinsic.Control.ElseIf(V.Local.fTemp1.Long,<,V.Local.fTemp2.Long)
					F.Intrinsic.Math.Mult(V.Local.fTemp2.Long,V.Local.fCP2,V.Local.fTemp3)
					F.Intrinsic.Math.Add(V.Local.fRunTime,V.Local.fTemp3.Long,V.Local.fRunTime)
					F.Intrinsic.String.Build("{0}: {1} x {2}",V.Local.fTemp3.Long,V.Local.fMLen,V.Local.fMWid,V.Local.sCuts)
					F.Intrinsic.Control.If(V.Local.fRemLen,>,0)
						F.Intrinsic.Control.If(V.Local.fRemLen,>,V.Local.fHalfLen)
							F.Intrinsic.Math.Add(V.Local.fRunTime,V.Local.fTemp1.Long,V.Local.fRunTime)
						F.Intrinsic.Control.Else
							F.Intrinsic.Math.Mult(V.Local.fRemLen,V.Local.fMWid,V.Local.fTempRunTime1)
							F.Intrinsic.Math.Mult(V.Local.fTempRunTime1,V.Local.fTemp1.Long,V.Local.fTempRunTime1)
							F.Intrinsic.Control.If(V.Local.fSqft,=,0)
								V.Local.fTempRunTime1.Set(0)
							F.Intrinsic.Control.Else
								F.Intrinsic.Math.Div(V.Local.fTempRunTime1,V.Local.fSqft,V.Local.fTempRunTime1)
							F.Intrinsic.Control.EndIf
							F.Intrinsic.Math.Add(V.Local.fRunTime,V.Local.fTempRunTime1,V.Local.fRunTime)
						F.Intrinsic.Control.EndIf
						F.Intrinsic.String.Build("{0} | {1}: {2} x {3}",V.Local.sCuts,V.Local.fTemp1.Long,V.Local.fRemLen,V.Local.fMWid,V.Local.sCuts)
					F.Intrinsic.Control.EndIf
					F.Intrinsic.Control.If(V.Local.fRemWid,>,0)
						F.Intrinsic.Control.If(V.Local.fRemWid,>,V.Local.fHalfWid)
							F.Intrinsic.Math.Add(V.Local.fRunTime,V.Local.fTemp2.Long,V.Local.fRunTime)
						F.Intrinsic.Control.Else
							F.Intrinsic.Math.Mult(V.Local.fRemWid,V.Local.fMLen,V.Local.fTempRunTime1)
							F.Intrinsic.Math.Mult(V.Local.fTempRunTime1,V.Local.fTemp2.Long,V.Local.fTempRunTime1)
							F.Intrinsic.Control.If(V.Local.fSqft,=,0)
								V.Local.fTempRunTime1.Set(0)
							F.Intrinsic.Control.Else
								F.Intrinsic.Math.Div(V.Local.fTempRunTime1,V.Local.fSqft,V.Local.fTempRunTime1)
							F.Intrinsic.Control.EndIf
							F.Intrinsic.Math.Add(V.Local.fRunTime,V.Local.fTempRunTime1,V.Local.fRunTime)
						F.Intrinsic.Control.EndIf
						F.Intrinsic.String.Build("{0} | {1}: {2} x {3}",V.Local.sCuts,V.Local.fTemp2.Long,V.Local.fMLen,V.Local.fRemWid,V.Local.sCuts)
					F.Intrinsic.Control.EndIf
					F.Intrinsic.Control.If(V.Local.fRemLen,>,0,"AND",V.Local.fRemWid,>,0)
						F.Intrinsic.Math.Mult(V.Local.fRemLen,V.Local.fRemWid,V.Local.fTempRunTime1)
						F.Intrinsic.Control.If(V.Local.fSqft,=,0)
							V.Local.fTempRunTime1.Set(0)
						F.Intrinsic.Control.Else
							F.Intrinsic.Math.Div(V.Local.fTempRunTime1,V.Local.fSqft,V.Local.fTempRunTime1)
						F.Intrinsic.Control.EndIf
						F.Intrinsic.Math.Add(V.Local.fRunTime,V.Local.fTempRunTime1,V.Local.fRunTime)
						F.Intrinsic.String.Build("{0} | {1}: {2} x {3}",V.Local.sCuts,"1",V.Local.fRemLen,V.Local.fRemWid,V.Local.sCuts)
					F.Intrinsic.Control.EndIf
					F.Intrinsic.Control.If(V.Screen.FormRegCrate!chkTop.Value,=,1)
						'figureing addtional stick cuts
						F.Intrinsic.String.Build("Operation = '{0}' and LMO = 'M' and UM_Inventory <> 'SH'",V.DataView.CrateCalc!Temp(V.DataView.CrateCalc!Temp.RowCount--).OPCODE!FieldValTrim,V.Local.sTemp)
						F.Data.DataView.Create("RLine","MTemp",22,V.Local.sTemp,"")
						F.Data.DataView.Create("dtRouterTemp","TEMP",22,V.Local.sTemp,"")
						F.Intrinsic.Control.If(V.DataView.RLine!MTemp.RowCount--,<>,-1)
							V.Local.fMWid.Set(V.DataView.RLine!MTemp(V.DataView.RLine!MTemp.RowCount--).Width!FieldValFloat)
							V.Local.fMLen.Set(V.DataView.RLine!MTemp(V.DataView.RLine!MTemp.RowCount--).Length!FieldValFloat)
							F.Intrinsic.Math.Mult(V.Local.fMWid,2,V.Local.fMWid)
							F.Intrinsic.Math.Sub(V.Local.fRunTime2,V.Local.fMWid,V.Local.fRunTime2)
							F.Intrinsic.Control.If(V.Local.fRunTime1,>,V.Local.fMLen)
								F.Intrinsic.String.Build("{0}: {1}",V.Local.fTemp1.Long,V.Local.fMLen,V.Local.sTempCut3)
								F.Intrinsic.Math.Sub(V.Local.fRunTime1,V.Local.fMLen,V.Local.fTemp3)
								F.Intrinsic.String.Build("{0} | {1}: {2}",V.Local.sTempCut3,V.Local.fTemp1.Long,V.Local.fTemp3,V.Local.sTempCut3)
							F.Intrinsic.Control.EndIf
							F.Intrinsic.Control.If(V.Local.fRunTime1,<,V.Local.fMLen)
								F.Intrinsic.String.Build("{0}: {1}",V.Local.fTemp1.Long,V.Local.fRunTime1,V.Local.sTempCut3)
							F.Intrinsic.Control.EndIf
							F.Intrinsic.Control.If(V.Local.fRunTime2,>,V.Local.fMLen)
								F.Intrinsic.String.Build("{0}: {1}",V.Local.fTemp2.Long,V.Local.fMLen,V.Local.sTempCut4)
								F.Intrinsic.Math.Sub(V.Local.fRunTime2,V.Local.fMLen,V.Local.fTemp3)
								F.Intrinsic.String.Build("{0} | {1}: {2}",V.Local.sTempCut4,V.Local.fTemp2.Long,V.Local.fTemp3,V.Local.sTempCut4)
							F.Intrinsic.Control.EndIf
							F.Intrinsic.Control.If(V.Local.fRunTime2,<,V.Local.fMLen)
								F.Intrinsic.String.Build("{0}: {1}",V.Local.fTemp2.Long,V.Local.fRunTime2,V.Local.sTempCut4)
							F.Intrinsic.Control.EndIf
							
							F.Intrinsic.Math.Add(V.Local.fRunTime1,V.Local.fRunTime2,V.Local.fTempRunTime1)
							F.Intrinsic.Control.If(V.Local.fMLen,=,0)
								V.Local.fTempRunTime1.Set(0)
							F.Intrinsic.Control.Else
								F.Intrinsic.Math.Div(V.Local.fTempRunTime1,V.Local.fMLen,V.Local.fTempRunTime1)
							F.Intrinsic.Control.EndIf
							F.Intrinsic.Math.Add(V.Local.fTempRunTime1,V.DataView.dtRouterTemp!Temp(V.DataView.dtRouterTemp!Temp.RowCount--).Run_Time!FieldValFloat,V.Local.fTempRunTime1)
							F.Intrinsic.String.Build("{0} | {1} | {2}",V.DataView.dtRouterTemp!Temp(V.DataView.dtRouterTemp!Temp.RowCount--).Cuts!FieldValTrim,V.Local.sTempCut3,V.Local.sTempCut4,V.Local.sTempCut4)
							F.Data.DataView.SetValue("dtRouterTemp","Temp",-1,"Run_Time",V.Local.fTempRunTime1,"Cuts",V.Local.sTempCut4)
						F.Intrinsic.Control.EndIf
						F.Data.DataView.Close("RLine","MTemp")
						F.Data.DataView.Close("dtRouterTemp","Temp")
					F.Intrinsic.Control.EndIf
				F.Intrinsic.Control.EndIf
				
			F.Intrinsic.Control.ElseIf(V.Local.fRunTime1,>,V.Local.fMLen,"AND",V.Local.fRunTime2,<,V.Local.fMWid)
				F.Intrinsic.Control.If(V.Local.fMLen,=,0)
					V.Local.fTemp1.Set(0)
				F.Intrinsic.Control.Else
					F.Intrinsic.Math.Div(V.Local.fRunTime1,V.Local.fMLen,V.Local.fTemp1)
				F.Intrinsic.Control.EndIf
				F.Intrinsic.String.Split(V.Local.fTemp1.String,".",V.Local.sTemp)
				F.Intrinsic.Control.If(V.Local.sTemp.UBound,>,0)
					F.Intrinsic.Math.Mult(V.Local.fMLen,V.Local.sTemp.Long,V.Local.fRemLen)
					F.Intrinsic.Math.Sub(V.Local.fRunTime1,V.Local.fRemLen,V.Local.fRemLen)
					F.Intrinsic.Math.Mult(V.Local.sTemp.Long,V.Local.fCP1,V.Local.fTemp1)
				F.Intrinsic.Control.Else
					F.Intrinsic.Math.Mult(V.Local.sTemp.Long,V.Local.fCP1,V.Local.fTemp1)
				F.Intrinsic.Control.EndIf

'				F.Intrinsic.Math.Mult(V.Local.fTemp1.Long,V.Local.fCP1,V.Local.fTemp3)
				V.Local.fTemp3.Set(V.Local.fTemp1.Long)
				F.Intrinsic.Control.If(V.Local.fRunTime2,>,V.Local.fHalfWid)
					F.Intrinsic.Math.Add(V.Local.fRunTime,V.Local.fTemp3.Long,V.Local.fRunTime)
				F.Intrinsic.Control.Else
					F.Intrinsic.Math.Mult(V.Local.fRunTime2,V.Local.fMLen,V.Local.fTempRunTime1)
					F.Intrinsic.Control.If(V.Local.fSqft,=,0)
						V.Local.fTempRunTime1.Set(0)
					F.Intrinsic.Control.Else
						F.Intrinsic.Math.Div(V.Local.fTempRunTime1,V.Local.fSqft,V.Local.fTempRunTime1)
					F.Intrinsic.Control.EndIf
					F.Intrinsic.Math.Add(V.Local.fRunTime,V.Local.fTempRunTime1,V.Local.fRunTime)
				F.Intrinsic.Control.EndIf
				F.Intrinsic.String.Build("{0}: {1} x {2}",V.Local.fTemp3.Long,V.Local.fMLen,V.Local.fRunTime2,V.Local.sCuts)
				F.Intrinsic.Control.If(V.Local.fRemLen,>,0)
					F.Intrinsic.Control.If(V.Local.fRemLen,>,V.Local.fHalfLen,"AND",V.Local.fRunTime2,>,V.Local.fHalfWid)
						F.Intrinsic.Math.Add(V.Local.fRunTime,V.Local.fCP1.Long,V.Local.fRunTime)
					F.Intrinsic.Control.Else
						F.Intrinsic.Math.Mult(V.Local.fRemLen,V.Local.fRunTime2,V.Local.fTempRunTime1)
						F.Intrinsic.Math.Mult(V.Local.fTempRunTime1,V.Local.fCP1.Long,V.Local.fTempRunTime1)
						F.Intrinsic.Control.If(V.Local.fSqft,=,0)
							V.Local.fTempRunTime1.Set(0)
						F.Intrinsic.Control.Else
							F.Intrinsic.Math.Div(V.Local.fTempRunTime1,V.Local.fSqft,V.Local.fTempRunTime1)
						F.Intrinsic.Control.EndIf
						F.Intrinsic.Math.Add(V.Local.fRunTime,V.Local.fTempRunTime1,V.Local.fRunTime)
					F.Intrinsic.Control.EndIf
					F.Intrinsic.String.Build("{0} | {1}: {2} x {3}",V.Local.sCuts,V.Local.fCP1.Long,V.Local.fRemLen,V.Local.fRunTime2,V.Local.sCuts)
				F.Intrinsic.Control.EndIf
				
				F.Intrinsic.Control.If(V.Screen.FormRegCrate!chkTop.Value,=,1)
					'figureing addtional stick cuts
					F.Intrinsic.String.Build("Operation = '{0}' and LMO = 'M' and UM_Inventory <> 'SH'",V.DataView.CrateCalc!Temp(V.DataView.CrateCalc!Temp.RowCount--).OPCODE!FieldValTrim,V.Local.sTemp)
					F.Data.DataView.Create("RLine","MTemp",22,V.Local.sTemp,"")
					F.Data.DataView.Create("dtRouterTemp","TEMP",22,V.Local.sTemp,"")
					F.Intrinsic.Control.If(V.DataView.RLine!MTemp.RowCount--,<>,-1)
						V.Local.fMWid.Set(V.DataView.RLine!MTemp(V.DataView.RLine!MTemp.RowCount--).Width!FieldValFloat)
						V.Local.fMLen.Set(V.DataView.RLine!MTemp(V.DataView.RLine!MTemp.RowCount--).Length!FieldValFloat)
						F.Intrinsic.Math.Mult(V.Local.fMWid,2,V.Local.fMWid)
						F.Intrinsic.Math.Sub(V.Local.fRunTime2,V.Local.fMWid,V.Local.fRunTime2)
						F.Intrinsic.Control.If(V.Local.fRunTime2,>,V.Local.fMLen)
							F.Intrinsic.String.Build("{0}: {1}",V.Local.fTemp1.Long,V.Local.fMLen,V.Local.sTempCut3)
							F.Intrinsic.Math.Sub(V.Local.fRunTime2,V.Local.fMLen,V.Local.fTemp3)
							F.Intrinsic.String.Build("{0} | {1}: {2}",V.Local.sTempCut3,V.Local.fTemp1.Long,V.Local.fTemp3,V.Local.sTempCut3)
						F.Intrinsic.Control.EndIf
						F.Intrinsic.Control.If(V.Local.fRunTime2,<,V.Local.fMLen)
							F.Intrinsic.String.Build("{0}: {1}",V.Local.fTemp1.Long,V.Local.fRunTime2,V.Local.sTempCut3)
						F.Intrinsic.Control.EndIf
						
						F.Intrinsic.Control.If(V.Local.fMLen,=,0)
							V.Local.fTempRunTime1.Set(0)
						F.Intrinsic.Control.Else
							F.Intrinsic.Math.Div(V.Local.fRunTime2,V.Local.fMLen,V.Local.fTempRunTime1)
						F.Intrinsic.Control.EndIf
						F.Intrinsic.Math.Add(V.Local.fTempRunTime1,V.DataView.dtRouterTemp!Temp(V.DataView.dtRouterTemp!Temp.RowCount--).Run_Time!FieldValFloat,V.Local.fTempRunTime1)
						F.Intrinsic.String.Build("{0} | {1}",V.DataView.dtRouterTemp!Temp(V.DataView.dtRouterTemp!Temp.RowCount--).Cuts!FieldValTrim,V.Local.sTempCut3,V.Local.sTempCut4)
						F.Data.DataView.SetValue("dtRouterTemp","Temp",-1,"Run_Time",V.Local.fTempRunTime1,"Cuts",V.Local.sTempCut4)
					F.Intrinsic.Control.EndIf
					F.Data.DataView.Close("RLine","MTemp")
					F.Data.DataView.Close("dtRouterTemp","Temp")
				F.Intrinsic.Control.EndIf
					
			F.Intrinsic.Control.ElseIf(V.Local.fRunTime1,<,V.Local.fMLen,"AND",V.Local.fRunTime2,>,V.Local.fMWid)
				F.Intrinsic.Control.If(V.Local.fMWid,=,0)
					V.Local.fTemp2.Set(0)
				F.Intrinsic.Control.Else
					F.Intrinsic.Math.Div(V.Local.fRunTime2,V.Local.fMWid,V.Local.fTemp2)
				F.Intrinsic.Control.EndIf
				F.Intrinsic.String.Split(V.Local.fTemp2.String,".",V.Local.sTemp)
				V.Local.fTemp1.Set(V.Local.sTemp.Long)
				F.Intrinsic.Control.If(V.Local.sTemp.UBound,>,0)
					F.Intrinsic.Math.Mult(V.Local.fMWid,V.Local.sTemp.Long,V.Local.fRemWid)
					F.Intrinsic.Math.Sub(V.Local.fRunTime2,V.Local.fRemWid,V.Local.fRemWid)
					F.Intrinsic.Math.Mult(V.Local.sTemp.Long,V.Local.fCP2,V.Local.fTemp2)
				F.Intrinsic.Control.Else
					F.Intrinsic.Math.Mult(V.Local.sTemp.Long,V.Local.fCP2,V.Local.fTemp2)
				F.Intrinsic.Control.EndIf
				
				V.Local.fTemp3.Set(V.Local.fTemp2.Long)
				F.Intrinsic.Control.If(V.Local.fRunTime1,>,V.Local.fHalfLen)
					F.Intrinsic.Math.Add(V.Local.fRunTime,V.Local.fTemp3.Long,V.Local.fRunTime)
				F.Intrinsic.Control.Else
					F.Intrinsic.Math.Mult(V.Local.fMWid,V.Local.fRunTime1,V.Local.fTempRunTime1)
					F.Intrinsic.Math.Mult(V.Local.fTempRunTime1,V.Local.fTemp3,V.Local.fTempRunTime1)
					F.Intrinsic.Control.If(V.Local.fSqft,=,0)
						V.Local.fTempRunTime1.Set(0)
					F.Intrinsic.Control.Else
						F.Intrinsic.Math.Div(V.Local.fTempRunTime1,V.Local.fSqft,V.Local.fTempRunTime1)
					F.Intrinsic.Control.EndIf
					F.Intrinsic.Math.Add(V.Local.fRunTime,V.Local.fTempRunTime1,V.Local.fRunTime)
				F.Intrinsic.Control.EndIf
				F.Intrinsic.String.Build("{0}: {1} x {2}",V.Local.fTemp3.Long,V.Local.fRunTime1,V.Local.fMWid,V.Local.sCuts)
				F.Intrinsic.Control.If(V.Local.fRemWid,>,0)
					F.Intrinsic.Control.If(V.Local.fRemWid,>,V.Local.fHalfWid,"AND",V.Local.fRunTime1,>,V.Local.fHalfLen)
						F.Intrinsic.Math.Add(V.Local.fRunTime,V.Local.fCP2.Long,V.Local.fRunTime)
					F.Intrinsic.Control.Else
						F.Intrinsic.Math.Mult(V.Local.fRemWid,V.Local.fRunTime1,V.Local.fTempRunTime1)
						F.Intrinsic.Math.Mult(V.Local.fTempRunTime1,V.Local.fCP2.Long,V.Local.fTempRunTime1)
						F.Intrinsic.Control.If(V.Local.fSqft,=,0)
							V.Local.fTempRunTime1.Set(0)
						F.Intrinsic.Control.Else
							F.Intrinsic.Math.Div(V.Local.fTempRunTime1,V.Local.fSqft,V.Local.fTempRunTime1)
						F.Intrinsic.Control.EndIf
						F.Intrinsic.Math.Add(V.Local.fRunTime,V.Local.fTempRunTime1,V.Local.fRunTime)
					F.Intrinsic.Control.EndIf
					F.Intrinsic.String.Build("{0} | {1}: {2} x {3}",V.Local.sCuts,V.Local.fCP2.Long,V.Local.fRunTime1,V.Local.fRemWid,V.Local.sCuts)
				F.Intrinsic.Control.EndIf
				
				F.Intrinsic.Control.If(V.Screen.FormRegCrate!chkTop.Value,=,1)
					'figureing addtional stick cuts
					F.Intrinsic.String.Build("Operation = '{0}' and LMO = 'M' and UM_Inventory <> 'SH'",V.DataView.CrateCalc!Temp(V.DataView.CrateCalc!Temp.RowCount--).OPCODE!FieldValTrim,V.Local.sTemp)
					F.Data.DataView.Create("RLine","MTemp",22,V.Local.sTemp,"")
					F.Data.DataView.Create("dtRouterTemp","TEMP",22,V.Local.sTemp,"")
					F.Intrinsic.Control.If(V.DataView.RLine!MTemp.RowCount--,<>,-1)
						V.Local.fMWid.Set(V.DataView.RLine!MTemp(V.DataView.RLine!MTemp.RowCount--).Width!FieldValFloat)
						V.Local.fMLen.Set(V.DataView.RLine!MTemp(V.DataView.RLine!MTemp.RowCount--).Length!FieldValFloat)
						F.Intrinsic.Math.Mult(V.Local.fMWid,2,V.Local.fMWid)
						F.Intrinsic.Math.Sub(V.Local.fRunTime2,V.Local.fMWid,V.Local.fRunTime2)
						F.Intrinsic.Control.If(V.Local.fRunTime2,>,V.Local.fMLen)
							F.Intrinsic.String.Build("{0}: {1}",V.Local.fTemp2.Long,V.Local.fMLen,V.Local.sTempCut3)
							F.Intrinsic.Math.Sub(V.Local.fRunTime2,V.Local.fMLen,V.Local.fTemp3)
							F.Intrinsic.String.Build("{0} | {1}: {2}",V.Local.sTempCut3,V.Local.fTemp2.Long,V.Local.fTemp3,V.Local.sTempCut3)
						F.Intrinsic.Control.EndIf
						F.Intrinsic.Control.If(V.Local.fRunTime2,<,V.Local.fMLen)
							F.Intrinsic.String.Build("{0}: {1}",V.Local.fTemp2.Long,V.Local.fRunTime2,V.Local.sTempCut3)
						F.Intrinsic.Control.EndIf
						
						F.Intrinsic.Control.If(V.Local.fMLen,=,0)
							V.Local.fTempRunTime1.Set(0)
						F.Intrinsic.Control.Else
							F.Intrinsic.Math.Div(V.Local.fRunTime2,V.Local.fMLen,V.Local.fTempRunTime1)
						F.Intrinsic.Control.EndIf
						F.Intrinsic.Math.Add(V.Local.fTempRunTime1,V.DataView.dtRouterTemp!Temp(V.DataView.dtRouterTemp!Temp.RowCount--).Run_Time!FieldValFloat,V.Local.fTempRunTime1)
						F.Intrinsic.String.Build("{0} | {1}",V.DataView.dtRouterTemp!Temp(V.DataView.dtRouterTemp!Temp.RowCount--).Cuts!FieldValTrim,V.Local.sTempCut3,V.Local.sTempCut4)
						F.Data.DataView.SetValue("dtRouterTemp","Temp",-1,"Run_Time",V.Local.fTempRunTime1,"Cuts",V.Local.sTempCut4)
					F.Intrinsic.Control.EndIf
					F.Data.DataView.Close("RLine","MTemp")
					F.Data.DataView.Close("dtRouterTemp","Temp")
				F.Intrinsic.Control.EndIf
				
			F.Intrinsic.Control.Else
				F.Intrinsic.Math.Mult(V.Local.fRunTime1,V.Local.fRunTime2,V.Local.fTempRunTime1)
				F.Intrinsic.Math.Mult(V.Local.fTempRunTime1,V.Local.fCP1,V.Local.fTempRunTime1)
				F.Intrinsic.Control.If(V.Local.fSqft,=,0)
					V.Local.fTempRunTime1.Set(0)
				F.Intrinsic.Control.Else
					F.Intrinsic.Math.Div(V.Local.fTempRunTime1,V.Local.fSqft,V.Local.fTempRunTime1)
				F.Intrinsic.Control.EndIf
				F.Intrinsic.Math.Add(V.Local.fRunTime,V.Local.fTempRunTime1,V.Local.fRunTime)
				F.Intrinsic.String.Build("{0}: {1} x {2}",V.Local.fCP1,V.Local.fRunTime1,V.Local.fRunTime2,V.Local.sCuts)
			F.Intrinsic.Control.EndIf
			
		F.Intrinsic.Control.CaseElse
			V.Local.fRunTime.Set(0)
			
			'figuring out partials
			F.Intrinsic.Control.If(V.Local.fRunTime1,>,V.Local.fMLen,"AND",V.Local.fRunTime2,>,V.Local.fMWid)
				F.Intrinsic.Control.If(V.Local.fSqft,=,0)
					V.Local.fTemp1.Set(0)
				F.Intrinsic.Control.Else
					F.Intrinsic.Math.Div(V.Local.fRunTime1,V.Local.fMLen,V.Local.fTemp1)
				F.Intrinsic.Control.EndIf
				F.Intrinsic.String.Split(V.Local.fTemp1.String,".",V.Local.sTemp)
				F.Intrinsic.Control.If(V.Local.sTemp.UBound,>,0)
					F.Intrinsic.Math.Mult(V.Local.fMLen,V.Local.sTemp.Long,V.Local.fRemLen)
					F.Intrinsic.Math.Sub(V.Local.fRunTime1,V.Local.fRemLen,V.Local.fRemLen)
					F.Intrinsic.Math.Mult(V.Local.sTemp.Long,V.Local.fCP1,V.Local.fTemp1)
				F.Intrinsic.Control.Else
					F.Intrinsic.Math.Mult(V.Local.sTemp.Long,V.Local.fCP1,V.Local.fTemp1)
				F.Intrinsic.Control.EndIf
				
				F.Intrinsic.Control.If(V.Local.fMWid,=,0)
					V.Local.fTemp2.Set(0)
				F.Intrinsic.Control.Else
					F.Intrinsic.Math.Div(V.Local.fRunTime2,V.Local.fMWid,V.Local.fTemp2)
				F.Intrinsic.Control.EndIf
				F.Intrinsic.String.Split(V.Local.fTemp2.String,".",V.Local.sTemp)
				F.Intrinsic.Control.If(V.Local.sTemp.UBound,>,0)
					F.Intrinsic.Math.Mult(V.Local.fMWid,V.Local.sTemp.Long,V.Local.fRemWid)
					F.Intrinsic.Math.Sub(V.Local.fRunTime2,V.Local.fRemWid,V.Local.fRemWid)
					F.Intrinsic.Math.Mult(V.Local.sTemp.Long,V.Local.fCP2,V.Local.fTemp2)
				F.Intrinsic.Control.Else
					F.Intrinsic.Math.Mult(V.Local.sTemp.Long,V.Local.fCP2,V.Local.fTemp2)
				F.Intrinsic.Control.EndIf

				F.Intrinsic.Control.If(V.Local.fTemp1.Long,=,V.Local.fTemp2.Long)
					F.Intrinsic.Math.Mult(V.Local.fTemp1.Long,V.Local.fCP1,V.Local.fTemp3)
					F.Intrinsic.Math.Add(V.Local.fRunTime,V.Local.fTemp3.Long,V.Local.fRunTime)
					F.Intrinsic.String.Build("{0}: {1} x {2}",V.Local.fTemp3.Long,V.Local.fMLen,V.Local.fMWid,V.Local.sCuts)
					F.Intrinsic.Control.If(V.Local.fRemLen,>,0)
						F.Intrinsic.Math.Mult(V.Local.fRemLen,V.Local.fMWid,V.Local.fTempRunTime1)
						F.Intrinsic.Math.Mult(V.Local.fTempRunTime1,V.Local.fTemp1.Long,V.Local.fTempRunTime1)
						F.Intrinsic.Control.If(V.Local.fSqft,=,0)
							V.Local.fTempRunTime1.Set(0)
						F.Intrinsic.Control.Else
							F.Intrinsic.Math.Div(V.Local.fTempRunTime1,V.Local.fSqft,V.Local.fTempRunTime1)
						F.Intrinsic.Control.EndIf
						F.Intrinsic.Math.Add(V.Local.fRunTime,V.Local.fTempRunTime1,V.Local.fRunTime)
						
						F.Intrinsic.String.Build("{0} | {1}: {2} x {3}",V.Local.sCuts,V.Local.fTemp1.Long,V.Local.fRemLen,V.Local.fMWid,V.Local.sCuts)
					F.Intrinsic.Control.EndIf
					F.Intrinsic.Control.If(V.Local.fRemWid,>,0)
						F.Intrinsic.Math.Mult(V.Local.fRemWid,V.Local.fMLen,V.Local.fTempRunTime1)
						F.Intrinsic.Math.Mult(V.Local.fTempRunTime1,V.Local.fTemp2.Long,V.Local.fTempRunTime1)
						F.Intrinsic.Control.If(V.Local.fSqft,=,0)
							V.Local.fTempRunTime1.Set(0)
						F.Intrinsic.Control.Else
							F.Intrinsic.Math.Div(V.Local.fTempRunTime1,V.Local.fSqft,V.Local.fTempRunTime1)
						F.Intrinsic.Control.EndIf
						F.Intrinsic.Math.Add(V.Local.fRunTime,V.Local.fTempRunTime1,V.Local.fRunTime)
						F.Intrinsic.String.Build("{0} | {1}: {2} x {3}",V.Local.sCuts,V.Local.fTemp2.Long,V.Local.fMLen,V.Local.fRemWid,V.Local.sCuts)
					F.Intrinsic.Control.EndIf
					F.Intrinsic.Control.If(V.Local.fRemLen,>,0,"AND",V.Local.fRemWid,>,0)
						F.Intrinsic.Math.Mult(V.Local.fRemLen,V.Local.fRemWid,V.Local.fTempRunTime1)
						F.Intrinsic.Control.If(V.Local.fSqft,=,0)
							V.Local.fTempRunTime1.Set(0)
						F.Intrinsic.Control.Else
							F.Intrinsic.Math.Div(V.Local.fTempRunTime1,V.Local.fSqft,V.Local.fTempRunTime1)
						F.Intrinsic.Control.EndIf
						F.Intrinsic.Math.Add(V.Local.fRunTime,V.Local.fTempRunTime1,V.Local.fRunTime)
						F.Intrinsic.String.Build("{0} | {1}: {2} x {3}",V.Local.sCuts,"1",V.Local.fRemLen,V.Local.fRemWid,V.Local.sCuts)
					F.Intrinsic.Control.EndIf

					'figureing addtional stick cuts
					F.Intrinsic.String.Build("Operation = '{0}' and LMO = 'M' and UM_Inventory <> 'SH'",V.DataView.CrateCalc!Temp(V.DataView.CrateCalc!Temp.RowCount--).OPCODE!FieldValTrim,V.Local.sTemp)
					F.Data.DataView.Create("RLine","MTemp",22,V.Local.sTemp,"")
					F.Data.DataView.Create("dtRouterTemp","TEMP",22,V.Local.sTemp,"")
					F.Intrinsic.Control.If(V.DataView.RLine!MTemp.RowCount--,<>,-1)
						V.Local.fMWid.Set(V.DataView.RLine!MTemp(V.DataView.RLine!MTemp.RowCount--).Width!FieldValFloat)
						V.Local.fMLen.Set(V.DataView.RLine!MTemp(V.DataView.RLine!MTemp.RowCount--).Length!FieldValFloat)
						F.Intrinsic.Math.Mult(V.Local.fMWid,2,V.Local.fMWid)
						F.Intrinsic.Math.Sub(V.Local.fRunTime1,V.Local.fMWid,V.Local.fRunTime1)
						F.Intrinsic.Math.Sub(V.Local.fRunTime2,V.Local.fMWid,V.Local.fRunTime2)
						F.Intrinsic.Control.If(V.Local.fRunTime1,>,V.Local.fMLen)
							F.Intrinsic.String.Build("{0}: {1}",V.Local.fTemp1.Long,V.Local.fMLen,V.Local.sTempCut3)
							F.Intrinsic.Math.Sub(V.Local.fRunTime1,V.Local.fMLen,V.Local.fTemp3)
							F.Intrinsic.String.Build("{0} | {1}: {2}",V.Local.sTempCut3,V.Local.fTemp1.Long,V.Local.fTemp3,V.Local.sTempCut3)
						F.Intrinsic.Control.EndIf
						F.Intrinsic.Control.If(V.Local.fRunTime1,<,V.Local.fMLen)
							F.Intrinsic.String.Build("{0}: {1}",V.Local.fTemp1.Long,V.Local.fRunTime1,V.Local.sTempCut3)
						F.Intrinsic.Control.EndIf
						F.Intrinsic.Control.If(V.Local.fRunTime2,>,V.Local.fMLen)
							F.Intrinsic.String.Build("{0}: {1}",V.Local.fTemp2.Long,V.Local.fMLen,V.Local.sTempCut4)
							F.Intrinsic.Math.Sub(V.Local.fRunTime2,V.Local.fMLen,V.Local.fTemp3)
							F.Intrinsic.String.Build("{0} | {1}: {2}",V.Local.sTempCut4,V.Local.fTemp2.Long,V.Local.fTemp3,V.Local.sTempCut4)
						F.Intrinsic.Control.EndIf
						F.Intrinsic.Control.If(V.Local.fRunTime2,<,V.Local.fMLen)
							F.Intrinsic.String.Build("{0}: {1}",V.Local.fTemp2.Long,V.Local.fRunTime2,V.Local.sTempCut4)
						F.Intrinsic.Control.EndIf
						
						F.Intrinsic.Math.Add(V.Local.fRunTime1,V.Local.fRunTime2,V.Local.fTempRunTime1)
						F.Intrinsic.Control.If(V.Local.fMLen,=,0)
							V.Local.fTempRunTime1.Set(0)
						F.Intrinsic.Control.Else
							F.Intrinsic.Math.Div(V.Local.fTempRunTime1,V.Local.fMLen,V.Local.fTempRunTime1)
						F.Intrinsic.Control.EndIf
						F.Intrinsic.Math.Add(V.Local.fTempRunTime1,V.DataView.dtRouterTemp!Temp(V.DataView.dtRouterTemp!Temp.RowCount--).Run_Time!FieldValFloat,V.Local.fTempRunTime1)
						F.Intrinsic.String.Build("{0} | {1} | {2}",V.DataView.dtRouterTemp!Temp(V.DataView.dtRouterTemp!Temp.RowCount--).Cuts!FieldValTrim,V.Local.sTempCut3,V.Local.sTempCut4,V.Local.sTempCut4)
						F.Data.DataView.SetValue("dtRouterTemp","Temp",-1,"Run_Time",V.Local.fTempRunTime1,"Cuts",V.Local.sTempCut4)
					F.Intrinsic.Control.EndIf
					F.Data.DataView.Close("RLine","MTemp")
					F.Data.DataView.Close("dtRouterTemp","Temp")
						
				F.Intrinsic.Control.ElseIf(V.Local.fTemp1.Long,>,V.Local.fTemp2.Long)
					F.Intrinsic.Math.Mult(V.Local.fTemp1.Long,V.Local.fCP1,V.Local.fTemp3)
					F.Intrinsic.Math.Add(V.Local.fRunTime,V.Local.fTemp3.Long,V.Local.fRunTime)
					F.Intrinsic.String.Build("{0}: {1} x {2}",V.Local.fTemp3.Long,V.Local.fMLen,V.Local.fMWid,V.Local.sCuts)
					F.Intrinsic.Control.If(V.Local.fRemLen,>,0)
						F.Intrinsic.Control.If(V.Local.fRemLen,>,V.Local.fHalfLen)
							F.Intrinsic.Math.Add(V.Local.fRunTime,V.Local.fTemp1.Long,V.Local.fRunTime)
						F.Intrinsic.Control.Else
							F.Intrinsic.Math.Mult(V.Local.fRemLen,V.Local.fSqft,V.Local.fTempRunTime1)
							F.Intrinsic.Math.Mult(V.Local.fTempRunTime1,V.Local.fTemp1.Long,V.Local.fTempRunTime1)
							F.Intrinsic.Control.If(V.Local.fMLen,=,0)
								V.Local.fTempRunTime1.Set(0)
							F.Intrinsic.Control.Else
								F.Intrinsic.Math.Div(V.Local.fTempRunTime1,V.Local.fSqft,V.Local.fTempRunTime1)
							F.Intrinsic.Control.EndIf
							F.Intrinsic.Math.Add(V.Local.fRunTime,V.Local.fTempRunTime1,V.Local.fRunTime)
						F.Intrinsic.Control.EndIf
						F.Intrinsic.String.Build("{0} | {1}: {2} x {3}",V.Local.sCuts,V.Local.fTemp1.Long,V.Local.fRemLen,V.Local.fMWid,V.Local.sCuts)
					F.Intrinsic.Control.EndIf
					F.Intrinsic.Control.If(V.Local.fRemWid,>,0)
						F.Intrinsic.Control.If(V.Local.fRemWid,>,V.Local.fHalfWid)
							F.Intrinsic.Math.Add(V.Local.fRunTime,V.Local.fTemp2.Long,V.Local.fRunTime)
						F.Intrinsic.Control.Else
							F.Intrinsic.Math.Mult(V.Local.fRemWid,V.Local.fMLen,V.Local.fTempRunTime1)
							F.Intrinsic.Math.Mult(V.Local.fTempRunTime1,V.Local.fTemp2.Long,V.Local.fTempRunTime1)
							F.Intrinsic.Control.If(V.Local.fSqft,=,0)
								V.Local.fTempRunTime1.Set(0)
							F.Intrinsic.Control.Else
								F.Intrinsic.Math.Div(V.Local.fTempRunTime1,V.Local.fSqft,V.Local.fTempRunTime1)
							F.Intrinsic.Control.EndIf
							F.Intrinsic.Math.Add(V.Local.fRunTime,V.Local.fTempRunTime1,V.Local.fRunTime)
						F.Intrinsic.Control.EndIf
						F.Intrinsic.String.Build("{0} | {1}: {2} x {3}",V.Local.sCuts,V.Local.fTemp2.Long,V.Local.fMLen,V.Local.fRemWid,V.Local.sCuts)
					F.Intrinsic.Control.EndIf
					F.Intrinsic.Control.If(V.Local.fRemLen,>,0,"AND",V.Local.fRemWid,>,0)
						F.Intrinsic.Math.Mult(V.Local.fRemLen,V.Local.fRemWid,V.Local.fTempRunTime1)
						F.Intrinsic.Control.If(V.Local.fSqft,=,0)
							V.Local.fTempRunTime1.Set(0)
						F.Intrinsic.Control.Else
							F.Intrinsic.Math.Div(V.Local.fTempRunTime1,V.Local.fSqft,V.Local.fTempRunTime1)
						F.Intrinsic.Control.EndIf
						F.Intrinsic.Math.Add(V.Local.fRunTime,V.Local.fTempRunTime1,V.Local.fRunTime)
						F.Intrinsic.String.Build("{0} | {1}: {2} x {3}",V.Local.sCuts,"1",V.Local.fRemLen,V.Local.fRemWid,V.Local.sCuts)
					F.Intrinsic.Control.EndIf
					
					'figureing addtional stick cuts
					F.Intrinsic.String.Build("Operation = '{0}' and LMO = 'M' and UM_Inventory <> 'SH'",V.DataView.CrateCalc!Temp(V.DataView.CrateCalc!Temp.RowCount--).OPCODE!FieldValTrim,V.Local.sTemp)
					F.Data.DataView.Create("RLine","MTemp",22,V.Local.sTemp,"")
					F.Data.DataView.Create("dtRouterTemp","TEMP",22,V.Local.sTemp,"")
					F.Intrinsic.Control.If(V.DataView.RLine!MTemp.RowCount--,<>,-1)
						V.Local.fMWid.Set(V.DataView.RLine!MTemp(V.DataView.RLine!MTemp.RowCount--).Width!FieldValFloat)
						V.Local.fMLen.Set(V.DataView.RLine!MTemp(V.DataView.RLine!MTemp.RowCount--).Length!FieldValFloat)
						F.Intrinsic.Math.Mult(V.Local.fMWid,2,V.Local.fMWid)
						F.Intrinsic.Math.Sub(V.Local.fRunTime1,V.Local.fMWid,V.Local.fRunTime1)
						F.Intrinsic.Control.If(V.Local.fRunTime1,>,V.Local.fMLen)
							F.Intrinsic.String.Build("{0}: {1}",V.Local.fTemp1.Long,V.Local.fMLen,V.Local.sTempCut3)
							F.Intrinsic.Math.Sub(V.Local.fRunTime1,V.Local.fMLen,V.Local.fTemp3)
							F.Intrinsic.String.Build("{0} | {1}: {2}",V.Local.sTempCut3,V.Local.fTemp1.Long,V.Local.fTemp3,V.Local.sTempCut3)
						F.Intrinsic.Control.EndIf
						F.Intrinsic.Control.If(V.Local.fRunTime1,<,V.Local.fMLen)
							F.Intrinsic.String.Build("{0}: {1}",V.Local.fTemp1.Long,V.Local.fRunTime1,V.Local.sTempCut3)
						F.Intrinsic.Control.EndIf
						F.Intrinsic.Control.If(V.Local.fRunTime2,>,V.Local.fMLen)
							F.Intrinsic.String.Build("{0}: {1}",V.Local.fTemp1.Long,V.Local.fMLen,V.Local.sTempCut4)
							F.Intrinsic.Math.Sub(V.Local.fRunTime2,V.Local.fMLen,V.Local.fTemp3)
							F.Intrinsic.String.Build("{0} | {1}: {2}",V.Local.sTempCut4,V.Local.fTemp1.Long,V.Local.fTemp3,V.Local.sTempCut4)
						F.Intrinsic.Control.EndIf
						F.Intrinsic.Control.If(V.Local.fRunTime2,<,V.Local.fMLen)
							F.Intrinsic.String.Build("{0}: {1}",V.Local.fTemp1.Long,V.Local.fRunTime2,V.Local.sTempCut4)
						F.Intrinsic.Control.EndIf
						
						F.Intrinsic.Math.Add(V.Local.fRunTime1,V.Local.fRunTime2,V.Local.fTempRunTime1)
						F.Intrinsic.Control.If(V.Local.fMLen,=,0)
							V.Local.fTempRunTime1.Set(0)
						F.Intrinsic.Control.Else
							F.Intrinsic.Math.Div(V.Local.fTempRunTime1,V.Local.fMLen,V.Local.fTempRunTime1)
						F.Intrinsic.Control.EndIf
						F.Intrinsic.Math.Add(V.Local.fTempRunTime1,V.DataView.dtRouterTemp!Temp(V.DataView.dtRouterTemp!Temp.RowCount--).Run_Time!FieldValFloat,V.Local.fTempRunTime1)
						F.Intrinsic.String.Build("{0} | {1} | {2}",V.DataView.dtRouterTemp!Temp(V.DataView.dtRouterTemp!Temp.RowCount--).Cuts!FieldValTrim,V.Local.sTempCut3,V.Local.sTempCut4,V.Local.sTempCut4)
						F.Data.DataView.SetValue("dtRouterTemp","Temp",-1,"Run_Time",V.Local.fTempRunTime1,"Cuts",V.Local.sTempCut4)
					F.Intrinsic.Control.EndIf
					F.Data.DataView.Close("RLine","MTemp")
					F.Data.DataView.Close("dtRouterTemp","Temp")
						
				F.Intrinsic.Control.ElseIf(V.Local.fTemp1.Long,<,V.Local.fTemp2.Long)
					F.Intrinsic.Math.Mult(V.Local.fTemp2.Long,V.Local.fCP2,V.Local.fTemp3)
					F.Intrinsic.Math.Add(V.Local.fRunTime,V.Local.fTemp3.Long,V.Local.fRunTime)
					F.Intrinsic.String.Build("{0}: {1} x {2}",V.Local.fTemp3.Long,V.Local.fMLen,V.Local.fMWid,V.Local.sCuts)
					F.Intrinsic.Control.If(V.Local.fRemLen,>,0)
						F.Intrinsic.Control.If(V.Local.fRemLen,>,V.Local.fHalfLen)
							F.Intrinsic.Math.Add(V.Local.fRunTime,V.Local.fTemp1.Long,V.Local.fRunTime)
						F.Intrinsic.Control.Else
							F.Intrinsic.Math.Mult(V.Local.fRemLen,V.Local.fMWid,V.Local.fTempRunTime1)
							F.Intrinsic.Math.Mult(V.Local.fTempRunTime1,V.Local.fTemp1.Long,V.Local.fTempRunTime1)
							F.Intrinsic.Control.If(V.Local.fSqft,=,0)
								V.Local.fTempRunTime1.Set(0)
							F.Intrinsic.Control.Else
								F.Intrinsic.Math.Div(V.Local.fTempRunTime1,V.Local.fSqft,V.Local.fTempRunTime1)
							F.Intrinsic.Control.EndIf
							F.Intrinsic.Math.Add(V.Local.fRunTime,V.Local.fTempRunTime1,V.Local.fRunTime)
						F.Intrinsic.Control.EndIf
						F.Intrinsic.String.Build("{0} | {1}: {2} x {3}",V.Local.sCuts,V.Local.fTemp1.Long,V.Local.fRemLen,V.Local.fMWid,V.Local.sCuts)
					F.Intrinsic.Control.EndIf
					F.Intrinsic.Control.If(V.Local.fRemWid,>,0)
						F.Intrinsic.Control.If(V.Local.fRemWid,>,V.Local.fHalfWid)
							F.Intrinsic.Math.Add(V.Local.fRunTime,V.Local.fTemp2.Long,V.Local.fRunTime)
						F.Intrinsic.Control.Else
							F.Intrinsic.Math.Mult(V.Local.fRemWid,V.Local.fMLen,V.Local.fTempRunTime1)
							F.Intrinsic.Math.Mult(V.Local.fTempRunTime1,V.Local.fTemp2.Long,V.Local.fTempRunTime1)
							F.Intrinsic.Control.If(V.Local.fSqft,=,0)
								V.Local.fTempRunTime1.Set(0)
							F.Intrinsic.Control.Else
								F.Intrinsic.Math.Div(V.Local.fTempRunTime1,V.Local.fSqft,V.Local.fTempRunTime1)
							F.Intrinsic.Control.EndIf
							F.Intrinsic.Math.Add(V.Local.fRunTime,V.Local.fTempRunTime1,V.Local.fRunTime)
						F.Intrinsic.Control.EndIf
						F.Intrinsic.String.Build("{0} | {1}: {2} x {3}",V.Local.sCuts,V.Local.fTemp2.Long,V.Local.fMLen,V.Local.fRemWid,V.Local.sCuts)
					F.Intrinsic.Control.EndIf
					F.Intrinsic.Control.If(V.Local.fRemLen,>,0,"AND",V.Local.fRemWid,>,0)
						F.Intrinsic.Math.Mult(V.Local.fRemLen,V.Local.fRemWid,V.Local.fTempRunTime1)
						F.Intrinsic.Control.If(V.Local.fSqft,=,0)
							V.Local.fTempRunTime1.Set(0)
						F.Intrinsic.Control.Else
							F.Intrinsic.Math.Div(V.Local.fTempRunTime1,V.Local.fSqft,V.Local.fTempRunTime1)
						F.Intrinsic.Control.EndIf
						F.Intrinsic.Math.Add(V.Local.fRunTime,V.Local.fTempRunTime1,V.Local.fRunTime)
						F.Intrinsic.String.Build("{0} | {1}: {2} x {3}",V.Local.sCuts,"1",V.Local.fRemLen,V.Local.fRemWid,V.Local.sCuts)
					F.Intrinsic.Control.EndIf
					
					'figureing addtional stick cuts
					F.Intrinsic.String.Build("Operation = '{0}' and LMO = 'M' and UM_Inventory <> 'SH'",V.DataView.CrateCalc!Temp(V.DataView.CrateCalc!Temp.RowCount--).OPCODE!FieldValTrim,V.Local.sTemp)
					F.Data.DataView.Create("RLine","MTemp",22,V.Local.sTemp,"")
					F.Data.DataView.Create("dtRouterTemp","TEMP",22,V.Local.sTemp,"")
					F.Intrinsic.Control.If(V.DataView.RLine!MTemp.RowCount--,<>,-1)
						V.Local.fMWid.Set(V.DataView.RLine!MTemp(V.DataView.RLine!MTemp.RowCount--).Width!FieldValFloat)
						V.Local.fMLen.Set(V.DataView.RLine!MTemp(V.DataView.RLine!MTemp.RowCount--).Length!FieldValFloat)
						F.Intrinsic.Math.Mult(V.Local.fMWid,2,V.Local.fMWid)
						F.Intrinsic.Math.Sub(V.Local.fRunTime2,V.Local.fMWid,V.Local.fRunTime2)
						F.Intrinsic.Control.If(V.Local.fRunTime1,>,V.Local.fMLen)
							F.Intrinsic.String.Build("{0}: {1}",V.Local.fTemp1.Long,V.Local.fMLen,V.Local.sTempCut3)
							F.Intrinsic.Math.Sub(V.Local.fRunTime1,V.Local.fMLen,V.Local.fTemp3)
							F.Intrinsic.String.Build("{0} | {1}: {2}",V.Local.sTempCut3,V.Local.fTemp1.Long,V.Local.fTemp3,V.Local.sTempCut3)
						F.Intrinsic.Control.EndIf
						F.Intrinsic.Control.If(V.Local.fRunTime1,<,V.Local.fMLen)
							F.Intrinsic.String.Build("{0}: {1}",V.Local.fTemp1.Long,V.Local.fRunTime1,V.Local.sTempCut3)
						F.Intrinsic.Control.EndIf
						F.Intrinsic.Control.If(V.Local.fRunTime2,>,V.Local.fMLen)
							F.Intrinsic.String.Build("{0}: {1}",V.Local.fTemp2.Long,V.Local.fMLen,V.Local.sTempCut4)
							F.Intrinsic.Math.Sub(V.Local.fRunTime2,V.Local.fMLen,V.Local.fTemp3)
							F.Intrinsic.String.Build("{0} | {1}: {2}",V.Local.sTempCut4,V.Local.fTemp2.Long,V.Local.fTemp3,V.Local.sTempCut4)
						F.Intrinsic.Control.EndIf
						F.Intrinsic.Control.If(V.Local.fRunTime2,<,V.Local.fMLen)
							F.Intrinsic.String.Build("{0}: {1}",V.Local.fTemp2.Long,V.Local.fRunTime2,V.Local.sTempCut4)
						F.Intrinsic.Control.EndIf
						
						F.Intrinsic.Math.Add(V.Local.fRunTime1,V.Local.fRunTime2,V.Local.fTempRunTime1)
						F.Intrinsic.Control.If(V.Local.fMLen,=,0)
							V.Local.fTempRunTime1.Set(0)
						F.Intrinsic.Control.Else
							F.Intrinsic.Math.Div(V.Local.fTempRunTime1,V.Local.fMLen,V.Local.fTempRunTime1)
						F.Intrinsic.Control.EndIf
						F.Intrinsic.Math.Add(V.Local.fTempRunTime1,V.DataView.dtRouterTemp!Temp(V.DataView.dtRouterTemp!Temp.RowCount--).Run_Time!FieldValFloat,V.Local.fTempRunTime1)
						F.Intrinsic.String.Build("{0} | {1} | {2}",V.DataView.dtRouterTemp!Temp(V.DataView.dtRouterTemp!Temp.RowCount--).Cuts!FieldValTrim,V.Local.sTempCut3,V.Local.sTempCut4,V.Local.sTempCut4)
						F.Data.DataView.SetValue("dtRouterTemp","Temp",-1,"Run_Time",V.Local.fTempRunTime1,"Cuts",V.Local.sTempCut4)
					F.Intrinsic.Control.EndIf
					F.Data.DataView.Close("RLine","MTemp")
					F.Data.DataView.Close("dtRouterTemp","Temp")
				F.Intrinsic.Control.EndIf
				
			F.Intrinsic.Control.ElseIf(V.Local.fRunTime1,>,V.Local.fMLen,"AND",V.Local.fRunTime2,<,V.Local.fMWid)
				F.Intrinsic.Control.If(V.Local.fMLen,=,0)
					V.Local.fTemp1.Set(0)
				F.Intrinsic.Control.Else
					F.Intrinsic.Math.Div(V.Local.fRunTime1,V.Local.fMLen,V.Local.fTemp1)
				F.Intrinsic.Control.EndIf
				F.Intrinsic.String.Split(V.Local.fTemp1.String,".",V.Local.sTemp)
				V.Local.fTemp2.Set(V.Local.sTemp.Long)
				F.Intrinsic.Control.If(V.Local.sTemp.UBound,>,0)
					F.Intrinsic.Math.Mult(V.Local.fMLen,V.Local.sTemp.Long,V.Local.fRemLen)
					F.Intrinsic.Math.Sub(V.Local.fRunTime1,V.Local.fRemLen,V.Local.fRemLen)
					F.Intrinsic.Math.Mult(V.Local.sTemp.Long,V.Local.fCP1,V.Local.fTemp1)
				F.Intrinsic.Control.Else
					F.Intrinsic.Math.Mult(V.Local.sTemp.Long,V.Local.fCP1,V.Local.fTemp1)
				F.Intrinsic.Control.EndIf

				V.Local.fTemp3.Set(V.Local.fTemp1.Long)
				F.Intrinsic.Control.If(V.Local.fRunTime2,>,V.Local.fHalfWid)
					F.Intrinsic.Math.Add(V.Local.fRunTime,V.Local.fTemp3.Long,V.Local.fRunTime)
				F.Intrinsic.Control.Else
					F.Intrinsic.Math.Mult(V.Local.fRunTime2,V.Local.fMLen,V.Local.fTempRunTime1)
					F.Intrinsic.Control.If(V.Local.fSqft,=,0)
						V.Local.fTempRunTime1.Set(0)
					F.Intrinsic.Control.Else
						F.Intrinsic.Math.Div(V.Local.fTempRunTime1,V.Local.fSqft,V.Local.fTempRunTime1)
					F.Intrinsic.Control.EndIf
					F.Intrinsic.Math.Add(V.Local.fRunTime,V.Local.fTempRunTime1,V.Local.fRunTime)
				F.Intrinsic.Control.EndIf
				F.Intrinsic.String.Build("{0}: {1} x {2}",V.Local.fTemp3.Long,V.Local.fMLen,V.Local.fRunTime2,V.Local.sCuts)
				F.Intrinsic.Control.If(V.Local.fRemLen,>,0)
					F.Intrinsic.Control.If(V.Local.fRemLen,>,V.Local.fHalfLen,"AND",V.Local.fRunTime2,>,V.Local.fHalfWid)
						F.Intrinsic.Math.Add(V.Local.fRunTime,V.Local.fCP1.Long,V.Local.fRunTime)
					F.Intrinsic.Control.Else
						F.Intrinsic.Math.Mult(V.Local.fRemLen,V.Local.fRunTime2,V.Local.fTempRunTime1)
						F.Intrinsic.Math.Mult(V.Local.fTempRunTime1,V.Local.fCP1.Long,V.Local.fTempRunTime1)
						F.Intrinsic.Control.If(V.Local.fSqft,=,0)
							V.Local.fTempRunTime1.Set(0)
						F.Intrinsic.Control.Else
							F.Intrinsic.Math.Div(V.Local.fTempRunTime1,V.Local.fSqft,V.Local.fTempRunTime1)
						F.Intrinsic.Control.EndIf
						F.Intrinsic.Math.Add(V.Local.fRunTime,V.Local.fTempRunTime1,V.Local.fRunTime)
					F.Intrinsic.Control.EndIf
					F.Intrinsic.String.Build("{0} | {1}: {2} x {3}",V.Local.sCuts,V.Local.fCP1.Long,V.Local.fRemLen,V.Local.fRunTime2,V.Local.sCuts)
				F.Intrinsic.Control.EndIf
				
				'figureing addtional stick cuts
				F.Intrinsic.String.Build("Operation = '{0}' and LMO = 'M' and UM_Inventory <> 'SH'",V.DataView.CrateCalc!Temp(V.DataView.CrateCalc!Temp.RowCount--).OPCODE!FieldValTrim,V.Local.sTemp)
				F.Data.DataView.Create("RLine","MTemp",22,V.Local.sTemp,"")
				F.Data.DataView.Create("dtRouterTemp","TEMP",22,V.Local.sTemp,"")
				F.Intrinsic.Control.If(V.DataView.RLine!MTemp.RowCount--,<>,-1)
					V.Local.fMWid.Set(V.DataView.RLine!MTemp(V.DataView.RLine!MTemp.RowCount--).Width!FieldValFloat)
					V.Local.fMLen.Set(V.DataView.RLine!MTemp(V.DataView.RLine!MTemp.RowCount--).Length!FieldValFloat)
					F.Intrinsic.Math.Mult(V.Local.fMWid,2,V.Local.fMWid)
					F.Intrinsic.Math.Sub(V.Local.fRunTime2,V.Local.fMWid,V.Local.fRunTime2)
					F.Intrinsic.Control.If(V.Local.fRunTime2,>,V.Local.fMLen)
						F.Intrinsic.String.Build("{0}: {1}",V.Local.fTemp2.Long,V.Local.fMLen,V.Local.sTempCut3)
						F.Intrinsic.Math.Sub(V.Local.fRunTime2,V.Local.fMLen,V.Local.fTemp3)
						F.Intrinsic.String.Build("{0} | {1}: {2}",V.Local.sTempCut3,V.Local.fTemp2.Long,V.Local.fTemp3,V.Local.sTempCut3)
					F.Intrinsic.Control.EndIf
					F.Intrinsic.Control.If(V.Local.fRunTime2,<,V.Local.fMLen)
						F.Intrinsic.String.Build("{0}: {1}",V.Local.fTemp2.Long,V.Local.fRunTime2,V.Local.sTempCut3)
					F.Intrinsic.Control.EndIf
					
					F.Intrinsic.Control.If(V.Local.fMLen,=,0)
						V.Local.fTempRunTime1.Set(0)
					F.Intrinsic.Control.Else
						F.Intrinsic.Math.Div(V.Local.fRunTime2,V.Local.fMLen,V.Local.fTempRunTime1)
					F.Intrinsic.Control.EndIf
					F.Intrinsic.Math.Add(V.Local.fTempRunTime1,V.DataView.dtRouterTemp!Temp(V.DataView.dtRouterTemp!Temp.RowCount--).Run_Time!FieldValFloat,V.Local.fTempRunTime1)
					F.Intrinsic.String.Build("{0} | {1}",V.DataView.dtRouterTemp!Temp(V.DataView.dtRouterTemp!Temp.RowCount--).Cuts!FieldValTrim,V.Local.sTempCut3,V.Local.sTempCut4)
					F.Data.DataView.SetValue("dtRouterTemp","Temp",-1,"Run_Time",V.Local.fTempRunTime1,"Cuts",V.Local.sTempCut4)
				F.Intrinsic.Control.EndIf
				F.Data.DataView.Close("RLine","MTemp")
				F.Data.DataView.Close("dtRouterTemp","Temp")
				
			F.Intrinsic.Control.ElseIf(V.Local.fRunTime1,<,V.Local.fMLen,"AND",V.Local.fRunTime2,>,V.Local.fMWid)
				F.Intrinsic.Control.If(V.Local.fMWid,=,0)
					V.Local.fTemp2.Set(0)
				F.Intrinsic.Control.Else
					F.Intrinsic.Math.Div(V.Local.fRunTime2,V.Local.fMWid,V.Local.fTemp2)
				F.Intrinsic.Control.EndIf
				F.Intrinsic.String.Split(V.Local.fTemp2.String,".",V.Local.sTemp)
				V.Local.fTemp1.Set(V.Local.sTemp.Long)
				F.Intrinsic.Control.If(V.Local.sTemp.UBound,>,0)
					F.Intrinsic.Math.Mult(V.Local.fMWid,V.Local.sTemp.Long,V.Local.fRemWid)
					F.Intrinsic.Math.Sub(V.Local.fRunTime2,V.Local.fRemWid,V.Local.fRemWid)
					F.Intrinsic.Math.Mult(V.Local.sTemp.Long,V.Local.fCP2,V.Local.fTemp2)
				F.Intrinsic.Control.Else
					F.Intrinsic.Math.Mult(V.Local.sTemp.Long,V.Local.fCP2,V.Local.fTemp2)
				F.Intrinsic.Control.EndIf
				
				V.Local.fTemp3.Set(V.Local.fTemp2.Long)
				F.Intrinsic.Control.If(V.Local.fRunTime1,>,V.Local.fHalfLen)
					F.Intrinsic.Math.Add(V.Local.fRunTime,V.Local.fTemp3.Long,V.Local.fRunTime)
				F.Intrinsic.Control.Else
					F.Intrinsic.Math.Mult(V.Local.fMWid,V.Local.fRunTime1,V.Local.fTempRunTime1)
					F.Intrinsic.Math.Mult(V.Local.fTempRunTime1,V.Local.fTemp3,V.Local.fTempRunTime1)
					F.Intrinsic.Control.If(V.Local.fSqft,=,0)
						V.Local.fTempRunTime1.Set(0)
					F.Intrinsic.Control.Else
						F.Intrinsic.Math.Div(V.Local.fTempRunTime1,V.Local.fSqft,V.Local.fTempRunTime1)
					F.Intrinsic.Control.EndIf
					F.Intrinsic.Math.Add(V.Local.fRunTime,V.Local.fTempRunTime1,V.Local.fRunTime)
				F.Intrinsic.Control.EndIf
				F.Intrinsic.String.Build("{0}: {1} x {2}",V.Local.fTemp3.Long,V.Local.fRunTime1,V.Local.fMWid,V.Local.sCuts)
				F.Intrinsic.Control.If(V.Local.fRemWid,>,0)
					F.Intrinsic.Control.If(V.Local.fRemWid,>,V.Local.fHalfWid,"AND",V.Local.fRunTime1,>,V.Local.fHalfLen)
						F.Intrinsic.Math.Add(V.Local.fRunTime,V.Local.fCP2.Long,V.Local.fRunTime)
					F.Intrinsic.Control.Else
						F.Intrinsic.Math.Mult(V.Local.fRemWid,V.Local.fRunTime1,V.Local.fTempRunTime1)
						F.Intrinsic.Math.Mult(V.Local.fTempRunTime1,V.Local.fCP2.Long,V.Local.fTempRunTime1)
						F.Intrinsic.Control.If(V.Local.fSqft,=,0)
							V.Local.fTempRunTime1.Set(0)
						F.Intrinsic.Control.Else
							F.Intrinsic.Math.Div(V.Local.fTempRunTime1,V.Local.fSqft,V.Local.fTempRunTime1)
						F.Intrinsic.Control.EndIf
						F.Intrinsic.Math.Add(V.Local.fRunTime,V.Local.fTempRunTime1,V.Local.fRunTime)
					F.Intrinsic.Control.EndIf
					F.Intrinsic.String.Build("{0} | {1}: {2} x {3}",V.Local.sCuts,V.Local.fCP2.Long,V.Local.fRunTime1,V.Local.fRemWid,V.Local.sCuts)
				F.Intrinsic.Control.EndIf
				
				'figureing addtional stick cuts
				F.Intrinsic.String.Build("Operation = '{0}' and LMO = 'M' and UM_Inventory <> 'SH'",V.DataView.CrateCalc!Temp(V.DataView.CrateCalc!Temp.RowCount--).OPCODE!FieldValTrim,V.Local.sTemp)
				F.Data.DataView.Create("RLine","MTemp",22,V.Local.sTemp,"")
				F.Data.DataView.Create("dtRouterTemp","TEMP",22,V.Local.sTemp,"")
				F.Intrinsic.Control.If(V.DataView.RLine!MTemp.RowCount--,<>,-1)
					V.Local.fMWid.Set(V.DataView.RLine!MTemp(V.DataView.RLine!MTemp.RowCount--).Width!FieldValFloat)
					V.Local.fMLen.Set(V.DataView.RLine!MTemp(V.DataView.RLine!MTemp.RowCount--).Length!FieldValFloat)
					F.Intrinsic.Math.Mult(V.Local.fMWid,2,V.Local.fMWid)
					F.Intrinsic.Math.Sub(V.Local.fRunTime2,V.Local.fMWid,V.Local.fRunTime2)
					F.Intrinsic.Control.If(V.Local.fRunTime2,>,V.Local.fMLen)
						F.Intrinsic.String.Build("{0}: {1}",V.Local.fTemp1.Long,V.Local.fMLen,V.Local.sTempCut3)
						F.Intrinsic.Math.Sub(V.Local.fRunTime2,V.Local.fMLen,V.Local.fTemp3)
						F.Intrinsic.String.Build("{0} | {1}: {2}",V.Local.sTempCut3,V.Local.fTemp1.Long,V.Local.fTemp3,V.Local.sTempCut3)
					F.Intrinsic.Control.EndIf
					F.Intrinsic.Control.If(V.Local.fRunTime2,<,V.Local.fMLen)
						F.Intrinsic.String.Build("{0}: {1}",V.Local.fTemp1.Long,V.Local.fRunTime2,V.Local.sTempCut3)
					F.Intrinsic.Control.EndIf
					
					F.Intrinsic.Control.If(V.Local.fMLen,=,0)
						V.Local.fTempRunTime1.Set(0)
					F.Intrinsic.Control.Else
						F.Intrinsic.Math.Div(V.Local.fRunTime2,V.Local.fMLen,V.Local.fTempRunTime1)
					F.Intrinsic.Control.EndIf
					F.Intrinsic.Math.Add(V.Local.fTempRunTime1,V.DataView.dtRouterTemp!Temp(V.DataView.dtRouterTemp!Temp.RowCount--).Run_Time!FieldValFloat,V.Local.fTempRunTime1)
					F.Intrinsic.String.Build("{0} | {1}",V.DataView.dtRouterTemp!Temp(V.DataView.dtRouterTemp!Temp.RowCount--).Cuts!FieldValTrim,V.Local.sTempCut3,V.Local.sTempCut4)
					F.Data.DataView.SetValue("dtRouterTemp","Temp",-1,"Run_Time",V.Local.fTempRunTime1,"Cuts",V.Local.sTempCut4)
				F.Intrinsic.Control.EndIf
				F.Data.DataView.Close("RLine","MTemp")
				F.Data.DataView.Close("dtRouterTemp","Temp")
				
			F.Intrinsic.Control.Else
				F.Intrinsic.Math.Mult(V.Local.fRunTime1,V.Local.fRunTime2,V.Local.fTempRunTime1)
				F.Intrinsic.Math.Mult(V.Local.fTempRunTime1,V.Local.fCP1,V.Local.fTempRunTime1)
				F.Intrinsic.Control.If(V.Local.fSqft,=,0)
					V.Local.fTempRunTime1.Set(0)
				F.Intrinsic.Control.Else
					F.Intrinsic.Math.Div(V.Local.fTempRunTime1,V.Local.fSqft,V.Local.fTempRunTime1)
				F.Intrinsic.Control.EndIf
				F.Intrinsic.Math.Add(V.Local.fRunTime,V.Local.fTempRunTime1,V.Local.fRunTime)
				F.Intrinsic.String.Build("{0}: {1} x {2}",V.Local.fCP1,V.Local.fRunTime1,V.Local.fRunTime2,V.Local.sCuts)
			F.Intrinsic.Control.EndIf
			
	F.Intrinsic.Control.EndSelect
F.Intrinsic.Control.EndIf
		
F.Intrinsic.Variable.AddRV("RunTime",V.Local.fRunTime,"Cuts",V.Local.sCuts)

F.Intrinsic.Control.ExitSub

F.Intrinsic.Control.Label("Get_RunTime_Err")
F.Intrinsic.Control.If(V.Ambient.ErrorNumber,<>,0)
	F.Intrinsic.String.Build("Project: GCG_6761_Crate_Calc.g2u {0}{0}Subroutine: {1}{0}Error Occurred {2} with description {3}",V.Ambient.NewLine,V.Ambient.CurrentSubroutine,V.Ambient.ErrorNumber,V.Ambient.ErrorDescription,V.Local.sError)
	F.Intrinsic.UI.Msgbox(V.Local.sError)
	F.Intrinsic.Control.CallSub(FormRegCrate_UnLoad)
Function.Intrinsic.Control.EndIf
Program.Sub.Get_RunTime.End

Program.Sub.Get_Cost.Start
F.Intrinsic.Control.SetErrorHandler("Get_Cost_Err")
F.Intrinsic.Control.ClearErrors

V.Local.sError.Declare(String,"")
V.Local.sPart.Declare(String,"")
V.Local.sFile.Declare(String,"")
V.Local.fMat.Declare(Float,0)
V.Local.fOut.Declare(Float,0)
V.Local.fLab.Declare(Float,0)
V.Local.fTotalCost.Declare(Float,0)
V.Local.fMrkUpMat.Declare(Float,0)
V.Local.fMrkUpOut.Declare(Float,0)
V.Local.fMrkUpLab.Declare(Float,0)
V.Local.fPrice.Declare(Float,0)
	
'get the output file from the router biuld up and put it in a datatable(s)
F.Intrinsic.String.Build("{0}\{1}{2}PRICING.OUT",v.Caller.FilesDir,v.Caller.User.Trim,v.Caller.Terminal.Trim,v.Local.sFile)
F.Intrinsic.File.File2String(V.Local.sFile,V.Local.sPart)

F.Data.DataTable.CreateFromString("ROUTER",V.Local.sPart,"TYPE*!*ROUTER*!*QTY*!*DIR_COST*!*COST*!*MATERIAL*!*OUTSIDE*!*LABOR*!*LABOR_HOURS*!*OVERHEAD*!*TIME_QTY*!*GP%-1*!*PRICE-1*!*GP%-2*!*PRICE-2*!*GP%-3*!*PRICE-3*!*GP%-4*!*PRICE-4*!*SELL3","STRING*!*STRING*!*STRING*!*STRING*!*STRING*!*STRING*!*STRING*!*STRING*!*STRING*!*STRING*!*STRING*!*STRING*!*STRING*!*STRING*!*STRING*!*STRING*!*STRING*!*STRING*!*STRING*!*STRING","*!*",V.Ambient.NewLine,True)
F.Intrinsic.Control.If(V.DataTable.ROUTER.RowCount--,>,0)
    'Type M = Markup  Marterial markup Columns(Router, Qty, Dir_Cost, Cost), Outside markup columns(Material, Outside, Labor, Labor_Hours), Labor markup columns(Overhead, Time_Qty, GP%-1, Price-1)
    'Type T = Total, Material = Material Column, Outside = Outside Column, Labor&Overhead = Labor Column + Overhead Column
    F.Data.DataView.Create("Router","TRouter",22,"Type = 'T'","")
    F.Data.DataView.Create("Router","MRouter",22,"Type = 'M'","")
    V.Local.fMat.Set(V.DataView.ROUTER!TRouter(V.DataView.ROUTER!TRouter.RowCount--).Material!FieldVal)
    V.Local.fOut.Set(V.DataView.ROUTER!TRouter(V.DataView.ROUTER!TRouter.RowCount--).Outside!FieldVal)
    F.Intrinsic.Math.Add(V.DataView.ROUTER!TRouter(V.DataView.ROUTER!TRouter.RowCount--).Labor!FieldVal,V.DataView.ROUTER!TRouter(V.DataView.ROUTER!TRouter.RowCount--).Overhead!FieldVal,V.Local.fLab)
    V.Local.fTotalCost.Set(V.DataView.ROUTER!TRouter(V.DataView.ROUTER!TRouter.RowCount--).Cost!FieldVal)
    
    F.Intrinsic.Math.Mult(V.Local.fMat,V.DataView.ROUTER!MRouter(V.DataView.ROUTER!MRouter.RowCount--).Cost!FieldVal,V.Local.fMrkUpMat)
    F.Intrinsic.Math.Mult(V.Local.fOut,V.DataView.ROUTER!MRouter(V.DataView.ROUTER!MRouter.RowCount--).Labor_Hours!FieldVal,V.Local.fMrkUpOut)
    F.Intrinsic.Math.Mult(V.Local.fLab,V.DataView.ROUTER!MRouter(V.DataView.ROUTER!MRouter.RowCount--).Price-1!FieldVal,V.Local.fMrkUpLab)
    F.Intrinsic.Math.Add(V.Local.fMrkUpLab,V.Local.fMrkUpMat,V.Local.fMrkUpOut,V.Local.fPrice)
    
    F.Data.DataView.Close("Router","TRouter")
    F.Data.DataView.Close("Router","MRouter")
F.Intrinsic.Control.EndIf

F.Data.Datatable.Close("ROUTER")

V.Passed.000009.Set(V.Local.fPrice)
V.Passed.000012.Set(V.Local.fTotalCost)

F.Intrinsic.Control.ExitSub

F.Intrinsic.Control.Label("Get_Cost_Err")
F.Intrinsic.Control.If(V.Ambient.ErrorNumber,<>,0)
	F.Intrinsic.String.Build("Project: GCG_6761_Crate_Calc.g2u {0}{0}Subroutine: {1}{0}Error Occurred {2} with description {3}",V.Ambient.NewLine,V.Ambient.CurrentSubroutine,V.Ambient.ErrorNumber,V.Ambient.ErrorDescription,V.Local.sError)
	F.Intrinsic.UI.Msgbox(V.Local.sError)
	F.Intrinsic.Control.CallSub(FormRegCrate_UnLoad)
Function.Intrinsic.Control.EndIf
Program.Sub.Get_Cost.End

Program.Sub.FormCrateSel_UnLoad.Start
F.Intrinsic.Control.SetErrorHandler("FormCrateSel_UnLoad_Err")
F.Intrinsic.Control.ClearErrors

V.Local.sError.Declare(String,"")

Gui.FormCrateSel..Visible(False)

F.Intrinsic.Control.ExitSub

F.Intrinsic.Control.Label("FormCrateSel_UnLoad_Err")
F.Intrinsic.Control.If(V.Ambient.ErrorNumber,<>,0)
	F.Intrinsic.String.Build("Project: GCG_6761_Crate_Calc.g2u {0}{0}Subroutine: {1}{0}Error Occurred {2} with description {3}",V.Ambient.NewLine,V.Ambient.CurrentSubroutine,V.Ambient.ErrorNumber,V.Ambient.ErrorDescription,V.Local.sError)
	F.Intrinsic.UI.Msgbox(V.Local.sError)
	F.Intrinsic.Control.CallSub(FormRegCrate_UnLoad)
Function.Intrinsic.Control.EndIf
Program.Sub.FormCrateSel_UnLoad.End

Program.Sub.cmdReg_Click.Start
F.Intrinsic.Control.SetErrorHandler("cmdReg_Click_Err")
F.Intrinsic.Control.ClearErrors

V.Local.sError.Declare(String,"")

V.Global.sSelection.Set("CRATE")

F.Intrinsic.Control.CallSub(FormCrateSel_UnLoad)

F.Intrinsic.Control.ExitSub

F.Intrinsic.Control.Label("cmdReg_Click_Err")
F.Intrinsic.Control.If(V.Ambient.ErrorNumber,<>,0)
	F.Intrinsic.String.Build("Project: GCG_6761_Crate_Calc.g2u {0}{0}Subroutine: {1}{0}Error Occurred {2} with description {3}",V.Ambient.NewLine,V.Ambient.CurrentSubroutine,V.Ambient.ErrorNumber,V.Ambient.ErrorDescription,V.Local.sError)
	F.Intrinsic.UI.Msgbox(V.Local.sError)
	F.Intrinsic.Control.CallSub(FormRegCrate_UnLoad)
Function.Intrinsic.Control.EndIf
Program.Sub.cmdReg_Click.End

Program.Sub.cmdShell_Click.Start
F.Intrinsic.Control.SetErrorHandler("cmdShell_Click_Err")
F.Intrinsic.Control.ClearErrors

V.Local.sError.Declare(String,"")

V.Global.sSelection.Set("SHELL")

F.Intrinsic.Control.CallSub(FormCrateSel_UnLoad)

F.Intrinsic.Control.ExitSub

F.Intrinsic.Control.Label("cmdShell_Click_Err")
F.Intrinsic.Control.If(V.Ambient.ErrorNumber,<>,0)
	F.Intrinsic.String.Build("Project: GCG_6761_Crate_Calc.g2u {0}{0}Subroutine: {1}{0}Error Occurred {2} with description {3}",V.Ambient.NewLine,V.Ambient.CurrentSubroutine,V.Ambient.ErrorNumber,V.Ambient.ErrorDescription,V.Local.sError)
	F.Intrinsic.UI.Msgbox(V.Local.sError)
	F.Intrinsic.Control.CallSub(FormRegCrate_UnLoad)
Function.Intrinsic.Control.EndIf
Program.Sub.cmdShell_Click.End

Program.Sub.Get_Data_Shell.Start
F.Intrinsic.Control.SetErrorHandler("Get_Data_Shell_Err")
F.Intrinsic.Control.ClearErrors

V.Local.sError.Declare(String,"")
V.Local.fWidth.Declare(Float,0)
V.Local.fLength.Declare(Float,0)
V.Local.fHeight.Declare(Float,0)
V.Local.i.Declare(Long,0)
V.Local.fQty1.Declare(Float,0)
V.Local.fQty2.Declare(Float,0)
V.Local.fCutLen1.Declare(Float,0)
V.Local.fCutLen2.Declare(Float,0)
V.Local.sEval.Declare(String,"")
V.Local.fMatLen.Declare(Float,0)
V.Local.fMatWid.Declare(Float,0)
V.Local.fTemp1.Declare(Float,0)
V.Local.sSql.Declare(String,"")
V.Local.sRouter.Declare(String,"")
V.Local.bMW1.Declare(Boolean,False)
V.Local.bMW2.Declare(Boolean,False)

V.Local.fLength.Set(V.Screen.FormShell!txtShellLen.Text)
V.Local.fWidth.Set(V.Screen.FormShell!txtShellWidth.Text)
V.Local.fHeight.Set(V.Screen.FormShell!txtShellHeight.Text)

F.Intrinsic.Control.If(V.DataTable.dtRouter.Exists)
	F.Data.Datatable.DeleteRow("dtRouter")
	F.Data.Datatable.AcceptChanges("dtRouter")
	V.Local.sRouter.Set(V.Screen.FormShell!txtShellTemplate.Text)
	F.Intrinsic.String.Build("Select * From V_Router_Header Where Router = '{0}'",V.Local.sRouter.Trim,V.Local.sSql)
	F.Intrinsic.Control.If(V.DataTable.RHeader.Exists)
		F.Data.Datatable.Close("RHeader")
	F.Intrinsic.Control.EndIf
	F.ODBC.Connection!Con.OpenCompanyConnection
	F.Data.Dictionary.CreateFromSQL("Part","con","Select rtrim(Part), rtrim(Part) From V_Inventory_Mstr where Code_Sort = 'LSTK'")
	Gui.FormShell.ddlBStrg.AddItems("Dictionary","Part")
	Gui.FormShell.ddlRunMat.AddItems("Dictionary","Part")
	Gui.FormShell.ddlSide1Mat.AddItems("Dictionary","Part")
	Gui.FormShell.ddlSide2Mat.AddItems("Dictionary","Part")
	Gui.FormShell.ddlTopMat.AddItems("Dictionary","Part")
	Gui.FormShell.ddlTStrgMat.AddItems("Dictionary","Part")
	F.Data.Dictionary.Close("Part")
	F.Data.Datatable.CreateFromSQL("RHeader","Con",V.Local.sSql,True)
	F.Intrinsic.String.Build("Select * From V_Router_Line Where Router = '{0}' Order by Line_Router",V.Local.sRouter.Trim,V.Local.sSql)
	F.Intrinsic.Control.If(V.DataTable.RLine.Exists)
		F.Data.Datatable.Close("RLine")
	F.Intrinsic.Control.EndIf
	F.Data.Datatable.CreateFromSQL("RLine","Con",V.Local.sSql,True)
	F.Data.Datatable.AddColumn("RLine","Length",Float)
	F.Data.Datatable.AddColumn("RLine","Width",Float)
	F.Data.Dictionary.CreateFromSQL("Len","Con","Select Part, Length From V_Inventory_Mst2")
	F.Data.Dictionary.SetDefaultReturn("Len","0")
	F.Data.Datatable.FillFromDictionary("RLine","Len","Part_WC_Outside","Length")
	F.Data.Dictionary.Close("Len")
	F.Data.Dictionary.CreateFromSQL("Wid","Con","Select Part, Width From V_Inventory_Mst2")
	F.Data.Dictionary.SetDefaultReturn("Wid","0")
	F.Data.Datatable.FillFromDictionary("RLine","Wid","Part_WC_Outside","Width")
	F.Data.Dictionary.Close("Wid")
	F.Intrinsic.String.Build("Select * From GCG_6761_CRATE_MAINT Where Router = '{0}'",V.Local.sRouter.Trim,V.Local.sSql)
	F.Intrinsic.Control.If(V.DataTable.CrateCalc.Exists)
		F.Data.Datatable.Close("CrateCalc")
	F.Intrinsic.Control.EndIf

	F.Data.Datatable.CreateFromSQL("CrateCalc","Con",V.Local.sSql,True)
	
	F.Intrinsic.Control.For(V.Local.i,0,V.Datatable.CrateCalc.RowCount--,1)
		F.Intrinsic.String.Build("Select Length From V_Inventory_Mst2 Where Part = '{0}'",V.Datatable.CrateCalc(V.Local.i).Material!FieldValTrim,V.Local.sSql)
		F.ODBC.Connection!con.ExecuteAndReturn(V.Local.sSql,V.Local.fMatLen)
		F.Intrinsic.String.Build("Select Width From V_Inventory_Mst2 Where Part = '{0}'",V.Datatable.CrateCalc(V.Local.i).Material!FieldValTrim,V.Local.sSql)
		F.ODBC.Connection!con.ExecuteAndReturn(V.Local.sSql,V.Local.fMatWid)
		F.Intrinsic.String.IsInString(V.Datatable.CrateCalc(V.Local.i).Dim1Qty!FieldValTrim,"/[MW]",True,V.Local.bMW1)
		F.Intrinsic.String.Replace(V.Datatable.CrateCalc(V.Local.i).Dim1Qty!FieldValTrim,"[CL]",V.Local.fLength,V.Local.sEval)
		F.Intrinsic.String.Replace(V.Local.sEval,"[CW]",V.Local.fWidth,V.Local.sEval)
		F.Intrinsic.String.Replace(V.Local.sEval,"[CH]",V.Local.fHeight,V.Local.sEval)
		F.Intrinsic.String.Replace(V.Local.sEval,"[MW]",V.Local.fMatWid,V.Local.sEval)
		F.Intrinsic.String.Replace(V.Local.sEval,"[ML]",V.Local.fMatLen,V.Local.sEval)
		F.Intrinsic.String.RegExReplace(V.Local.sEval,"/0","/1",True,True,V.Local.sEval)
		F.Intrinsic.Control.If(V.Local.sEval,<>,"")
			F.Intrinsic.Math.Evaluate(V.Local.sEval,V.Local.fQty1)
		F.Intrinsic.Control.Else
			V.Local.fQty1.Set(0)
		F.Intrinsic.Control.EndIf
		F.Intrinsic.String.IsInString(V.Datatable.CrateCalc(V.Local.i).Dim2Qty!FieldValTrim,"/[MW]",True,V.Local.bMW2)
		F.Intrinsic.String.Replace(V.Datatable.CrateCalc(V.Local.i).Dim2Qty!FieldValTrim,"[CL]",V.Local.fLength,V.Local.sEval)
		F.Intrinsic.String.Replace(V.Local.sEval,"[CW]",V.Local.fWidth,V.Local.sEval)
		F.Intrinsic.String.Replace(V.Local.sEval,"[CH]",V.Local.fHeight,V.Local.sEval)
		F.Intrinsic.String.Replace(V.Local.sEval,"[MW]",V.Local.fMatWid,V.Local.sEval)
		F.Intrinsic.String.Replace(V.Local.sEval,"[ML]",V.Local.fMatLen,V.Local.sEval)
		F.Intrinsic.String.RegExReplace(V.Local.sEval,"/0","/1",True,True,V.Local.sEval)
		F.Intrinsic.Control.If(V.Local.sEval,<>,"")
			F.Intrinsic.Math.Evaluate(V.Local.sEval,V.Local.fQty2)
		F.Intrinsic.Control.Else
			V.Local.fQty2.Set(0)
		F.Intrinsic.Control.EndIf
		F.Intrinsic.String.Replace(V.Datatable.CrateCalc(V.Local.i).Dim1Form!FieldValTrim,"[CL]",V.Local.fLength,V.Local.sEval)
		F.Intrinsic.String.Replace(V.Local.sEval,"[CW]",V.Local.fWidth,V.Local.sEval)
		F.Intrinsic.String.Replace(V.Local.sEval,"[CH]",V.Local.fHeight,V.Local.sEval)
		F.Intrinsic.String.Replace(V.Local.sEval,"[MW]",V.Local.fMatWid,V.Local.sEval)
		F.Intrinsic.String.Replace(V.Local.sEval,"[ML]",V.Local.fMatLen,V.Local.sEval)
		F.Intrinsic.String.RegExReplace(V.Local.sEval,"/0","/1",True,True,V.Local.sEval)
		F.Intrinsic.Control.If(V.Local.sEval,<>,"")
			F.Intrinsic.Math.Evaluate(V.Local.sEval,V.Local.fCutLen1)
		F.Intrinsic.Control.Else
			V.Local.fCutLen1.Set(0)
		F.Intrinsic.Control.EndIf
		F.Intrinsic.String.Replace(V.Datatable.CrateCalc(V.Local.i).Dim2Form!FieldValTrim,"[CL]",V.Local.fLength,V.Local.sEval)
		F.Intrinsic.String.Replace(V.Local.sEval,"[CW]",V.Local.fWidth,V.Local.sEval)
		F.Intrinsic.String.Replace(V.Local.sEval,"[CH]",V.Local.fHeight,V.Local.sEval)
		F.Intrinsic.String.Replace(V.Local.sEval,"[MW]",V.Local.fMatWid,V.Local.sEval)
		F.Intrinsic.String.Replace(V.Local.sEval,"[ML]",V.Local.fMatLen,V.Local.sEval)
		F.Intrinsic.String.RegExReplace(V.Local.sEval,"/0","/1",True,True,V.Local.sEval)
		F.Intrinsic.Control.If(V.Local.sEval,<>,"")
			F.Intrinsic.Math.Evaluate(V.Local.sEval,V.Local.fCutLen2)
		F.Intrinsic.Control.Else
			V.Local.fCutLen2.Set(0)
		F.Intrinsic.Control.EndIf
		F.Intrinsic.Control.If(V.Local.bMW1)
			F.Intrinsic.Math.Int(V.Local.fQty1,V.Local.fTemp1)
			F.Intrinsic.Control.If(V.Local.fQty1,<,V.Local.fTemp1)
				F.Intrinsic.Math.Sub(V.Local.fTemp1.Long,1,V.Local.fQty1)
			F.Intrinsic.Control.Else
				F.Intrinsic.Math.Add(V.Local.fTemp1.Long,1,V.Local.fQty1)
			F.Intrinsic.Control.EndIf
		F.Intrinsic.Control.EndIf
		F.Intrinsic.Control.If(V.Local.bMW2)
			F.Intrinsic.Math.Int(V.Local.fQty2,V.Local.fTemp1)
			F.Intrinsic.Control.If(V.Local.fQty2,<,V.Local.fTemp1)
				F.Intrinsic.Math.Sub(V.Local.fTemp1.Long,1,V.Local.fQty2)
			F.Intrinsic.Control.Else
				F.Intrinsic.Math.Add(V.Local.fTemp1.Long,1,V.Local.fQty2)
			F.Intrinsic.Control.EndIf
		F.Intrinsic.Control.EndIf
		F.Intrinsic.Control.SelectCase(V.Datatable.CrateCalc(V.Local.i).OpCode!FieldValTrim)
			F.Intrinsic.Control.Case("SIDE 1")
				gui.FormShell.ddlSide1Mat.Text(V.Datatable.CrateCalc(V.Local.i).Material!FieldValTrim)
				Gui.FormShell.txtSide1CutLenDim1.Text(V.Local.fCutLen1)
				Gui.FormShell.txtSide1CutLenDim2.Text(V.Local.fCutLen2)
				Gui.FormShell.txtSide1QtyDim1.Text(V.Local.fQty1)
				Gui.FormShell.txtSide1QtyDim2.Text(V.Local.fQty2)
			F.Intrinsic.Control.Case("SIDE 2")
				gui.FormShell.ddlSide2Mat.Text(V.Datatable.CrateCalc(V.Local.i).Material!FieldValTrim)
				Gui.FormShell.txtSide2CutLenDim1.Text(V.Local.fCutLen1)
				Gui.FormShell.txtSide2CutLenDim2.Text(V.Local.fCutLen2)
				Gui.FormShell.txtSide2QtyDim1.Text(V.Local.fQty1)
				Gui.FormShell.txtSide2QtyDim2.Text(V.Local.fQty2)
			F.Intrinsic.Control.Case("TOP")
				gui.FormShell.ddlTopMat.Text(V.Datatable.CrateCalc(V.Local.i).Material!FieldValTrim)
				Gui.FormShell.txtTopCutLenDim1.Text(V.Local.fCutLen1)
				Gui.FormShell.txtTopCutLenDim2.Text(V.Local.fCutLen2)
				Gui.FormShell.txtTopQtyDim1.Text(V.Local.fQty1)
				Gui.FormShell.txtTopQtyDim2.Text(V.Local.fQty2)
			F.Intrinsic.Control.Case("T STRG")
				gui.FormShell.txtTStrgQty.Text(V.Local.fQty1)
				gui.FormShell.txtTStrg.Text(V.Local.fCutLen1)
				gui.FormShell.ddlTStrgMat.Text(V.Datatable.CrateCalc(V.Local.i).Material!FieldValTrim)
			F.Intrinsic.Control.Case("B STRG")
				Gui.FormShell.txtBstrgQty.Text(V.Local.fQty1)
				gui.FormShell.txtBStrg.Text(V.Local.fCutLen1)
				gui.FormShell.ddlBStrg.Text(V.Datatable.CrateCalc(V.Local.i).Material!FieldValTrim)
			F.Intrinsic.Control.Case("RUN")
				Gui.FormShell.txtRunQty.Text(V.Local.fQty1)
				gui.FormShell.txtLRun.Text(V.Local.fCutLen1)
				gui.FormShell.ddlRunMat.Text(V.Datatable.CrateCalc(V.Local.i).Material!FieldValTrim)
		F.Intrinsic.Control.EndSelect
	F.Intrinsic.Control.Next(V.Local.i)
	
	F.ODBC.Connection!Con.Close
F.Intrinsic.Control.Else
	f.Data.DataTable.Create("dtRouter",True)
	f.Data.DataTable.AddColumn("dtRouter","Router","string")
	f.Data.DataTable.AddColumn("dtRouter","Line_Router","string")
	f.Data.DataTable.AddColumn("dtRouter","LMO","string")
	f.Data.DataTable.AddColumn("dtRouter","Part_WC_Outside","string")
	f.Data.DataTable.AddColumn("dtRouter","Operation","string")
	f.Data.DataTable.AddColumn("dtRouter","Set_Up","float")
	f.Data.DataTable.AddColumn("dtRouter","Run_Time","float")
	f.Data.DataTable.AddColumn("dtRouter","UM_Inventory","string")
	f.Data.DataTable.AddColumn("dtRouter","Rate","float")
	f.Data.DataTable.AddColumn("dtRouter","Desc_Rt_Line","string")
	f.Data.DataTable.AddColumn("dtRouter","Cuts","string")

	f.Data.DataTable.Create("dtRouterTemp",True)
	f.Data.DataTable.AddColumn("dtRouterTemp","Router","string")
	f.Data.DataTable.AddColumn("dtRouterTemp","Line_Router","string")
	f.Data.DataTable.AddColumn("dtRouterTemp","LMO","string")
	f.Data.DataTable.AddColumn("dtRouterTemp","Part_WC_Outside","string")
	f.Data.DataTable.AddColumn("dtRouterTemp","Operation","string")
	f.Data.DataTable.AddColumn("dtRouterTemp","Set_Up","float")
	f.Data.DataTable.AddColumn("dtRouterTemp","Run_Time","float")
	f.Data.DataTable.AddColumn("dtRouterTemp","UM_Inventory","string")
	f.Data.DataTable.AddColumn("dtRouterTemp","Rate","float")
	f.Data.DataTable.AddColumn("dtRouterTemp","Desc_Rt_Line","string")
	f.Data.DataTable.AddColumn("dtRouterTemp","Cuts","string")
F.Intrinsic.Control.EndIf

F.Intrinsic.Control.ExitSub

F.Intrinsic.Control.Label("Get_Data_Shell_Err")
F.Intrinsic.Control.If(V.Ambient.ErrorNumber,<>,0)
	F.Intrinsic.String.Build("Project: GCG_6721_Shell_Crate_Calc.g2u {0}{0}Subroutine: {1}{0}Error Occurred {2} with description {3}",V.Ambient.NewLine,V.Ambient.CurrentSubroutine,V.Ambient.ErrorNumber,V.Ambient.ErrorDescription,V.Local.sError)
	F.Intrinsic.UI.Msgbox(V.Local.sError)
	F.Intrinsic.Control.CallSub(FormShell_UnLoad)
Function.Intrinsic.Control.EndIf
Program.Sub.Get_Data_Shell.End

Program.Sub.FormShell_UnLoad.Start
F.Intrinsic.Control.SetErrorHandler("FormShell_UnLoad_Err")
F.Intrinsic.Control.ClearErrors

V.Local.sError.Declare(String,"")

F.Intrinsic.Control.End

F.Intrinsic.Control.ExitSub

F.Intrinsic.Control.Label("FormShell_UnLoad_Err")
F.Intrinsic.Control.If(V.Ambient.ErrorNumber,<>,0)
	F.Intrinsic.Control.End
Function.Intrinsic.Control.EndIf
Program.Sub.FormShell_UnLoad.End

Program.Sub.Set_Prop_Shell.Start
F.Intrinsic.Control.SetErrorHandler("Set_Prop_Shell_Err")
F.Intrinsic.Control.ClearErrors

V.Local.sError.Declare(String,"")

gui.FormShell.GsGridShellNewRout.AddGridviewFromDatatable("gvRouter","dtRouter")

gui.FormShell.GsGridShellNewRout.SetGridviewProperty("gvRouter",v.Enum.GridViewPropertyNames!ShowGroupPanel,True)
gui.FormShell.GsGridShellNewRout.SetGridviewProperty("gvRouter",v.Enum.GridViewPropertyNames!AllowAddRows,False)
gui.FormShell.GsGridShellNewRout.SetGridviewProperty("gvRouter",v.Enum.GridViewPropertyNames!AllowDeleteRows,False)
gui.FormShell.GsGridShellNewRout.SetGridviewProperty("gvRouter",v.Enum.GridViewPropertyNames!AllowColumnMoving,False)
gui.FormShell.GsGridShellNewRout.SetGridviewProperty("gvRouter",v.Enum.GridViewPropertyNames!ColumnAutoWidth,True)

Gui.FormShell.GsGridShellNewRout.SetColumnProperty("gvRouter","Router",v.Enum.ColumnPropertyNames!Caption,"Router")
Gui.FormShell.GsGridShellNewRout.SetColumnProperty("gvRouter","Router",V.Enum.ColumnPropertyNames!HeaderForeColor,v.Color.PRI-GSS-00)
Gui.FormShell.GsGridShellNewRout.SetColumnProperty("gvRouter","Router",V.Enum.ColumnPropertyNames!HeaderFontBold,True)
Gui.FormShell.GsGridShellNewRout.SetColumnProperty("gvRouter","Router",V.Enum.ColumnPropertyNames!ReadOnly,True)
Gui.FormShell.GsGridShellNewRout.SetColumnProperty("gvRouter","Router",V.Enum.ColumnPropertyNames!AllowEdit,False)
Gui.FormShell.GsGridShellNewRout.SetColumnProperty("gvRouter","Router",V.Enum.ColumnPropertyNames!Visible,False)

Gui.FormShell.GsGridShellNewRout.SetColumnProperty("gvRouter","Line_Router",v.Enum.ColumnPropertyNames!Caption,"Seq")
Gui.FormShell.GsGridShellNewRout.SetColumnProperty("gvRouter","Line_Router",V.Enum.ColumnPropertyNames!HeaderForeColor,v.Color.PRI-GSS-00)
Gui.FormShell.GsGridShellNewRout.SetColumnProperty("gvRouter","Line_Router",V.Enum.ColumnPropertyNames!HeaderFontBold,True)
Gui.FormShell.GsGridShellNewRout.SetColumnProperty("gvRouter","Line_Router",V.Enum.ColumnPropertyNames!ReadOnly,True)
Gui.FormShell.GsGridShellNewRout.SetColumnProperty("gvRouter","Line_Router",V.Enum.ColumnPropertyNames!AllowEdit,False)
Gui.FormShell.GsGridShellNewRout.SetColumnProperty("gvRouter","Line_Router",V.Enum.ColumnPropertyNames!Visible,True)
Gui.FormShell.GsGridShellNewRout.SetColumnProperty("gvRouter","Line_Router",V.Enum.ColumnPropertyNames!Width,"50")

Gui.FormShell.GsGridShellNewRout.SetColumnProperty("gvRouter","LMO",v.Enum.ColumnPropertyNames!Caption,"Type")
Gui.FormShell.GsGridShellNewRout.SetColumnProperty("gvRouter","LMO",V.Enum.ColumnPropertyNames!HeaderForeColor,v.Color.PRI-GSS-00)
Gui.FormShell.GsGridShellNewRout.SetColumnProperty("gvRouter","LMO",V.Enum.ColumnPropertyNames!HeaderFontBold,True)
Gui.FormShell.GsGridShellNewRout.SetColumnProperty("gvRouter","LMO",V.Enum.ColumnPropertyNames!ReadOnly,True)
Gui.FormShell.GsGridShellNewRout.SetColumnProperty("gvRouter","LMO",V.Enum.ColumnPropertyNames!AllowEdit,False)
Gui.FormShell.GsGridShellNewRout.SetColumnProperty("gvRouter","LMO",V.Enum.ColumnPropertyNames!Visible,True)
Gui.FormShell.GsGridShellNewRout.SetColumnProperty("gvRouter","LMO",V.Enum.ColumnPropertyNames!Width,"50")

Gui.FormShell.GsGridShellNewRout.SetColumnProperty("gvRouter","Part_WC_Outside",v.Enum.ColumnPropertyNames!Caption,"Part / Workcenter")
Gui.FormShell.GsGridShellNewRout.SetColumnProperty("gvRouter","Part_WC_Outside",V.Enum.ColumnPropertyNames!HeaderForeColor,v.Color.PRI-GSS-00)
Gui.FormShell.GsGridShellNewRout.SetColumnProperty("gvRouter","Part_WC_Outside",V.Enum.ColumnPropertyNames!HeaderFontBold,True)
Gui.FormShell.GsGridShellNewRout.SetColumnProperty("gvRouter","Part_WC_Outside",V.Enum.ColumnPropertyNames!ReadOnly,True)
Gui.FormShell.GsGridShellNewRout.SetColumnProperty("gvRouter","Part_WC_Outside",V.Enum.ColumnPropertyNames!AllowEdit,False)
Gui.FormShell.GsGridShellNewRout.SetColumnProperty("gvRouter","Part_WC_Outside",V.Enum.ColumnPropertyNames!Visible,True)

Gui.FormShell.GsGridShellNewRout.SetColumnProperty("gvRouter","Operation",v.Enum.ColumnPropertyNames!Caption,"Op Code")
Gui.FormShell.GsGridShellNewRout.SetColumnProperty("gvRouter","Operation",V.Enum.ColumnPropertyNames!HeaderForeColor,v.Color.PRI-GSS-00)
Gui.FormShell.GsGridShellNewRout.SetColumnProperty("gvRouter","Operation",V.Enum.ColumnPropertyNames!HeaderFontBold,True)
Gui.FormShell.GsGridShellNewRout.SetColumnProperty("gvRouter","Operation",V.Enum.ColumnPropertyNames!ReadOnly,True)
Gui.FormShell.GsGridShellNewRout.SetColumnProperty("gvRouter","Operation",V.Enum.ColumnPropertyNames!AllowEdit,False)
Gui.FormShell.GsGridShellNewRout.SetColumnProperty("gvRouter","Operation",V.Enum.ColumnPropertyNames!Visible,True)
Gui.FormShell.GsGridShellNewRout.SetColumnProperty("gvRouter","Operation",V.Enum.ColumnPropertyNames!Width,"50")

Gui.FormShell.GsGridShellNewRout.SetColumnProperty("gvRouter","Set_Up",v.Enum.ColumnPropertyNames!Caption,"Setup")
Gui.FormShell.GsGridShellNewRout.SetColumnProperty("gvRouter","Set_Up",V.Enum.ColumnPropertyNames!HeaderForeColor,v.Color.PRI-GSS-00)
Gui.FormShell.GsGridShellNewRout.SetColumnProperty("gvRouter","Set_Up",V.Enum.ColumnPropertyNames!HeaderFontBold,True)
Gui.FormShell.GsGridShellNewRout.SetColumnProperty("gvRouter","Set_Up",V.Enum.ColumnPropertyNames!ReadOnly,True)
Gui.FormShell.GsGridShellNewRout.SetColumnProperty("gvRouter","Set_Up",V.Enum.ColumnPropertyNames!AllowEdit,False)
Gui.FormShell.GsGridShellNewRout.SetColumnProperty("gvRouter","Set_Up",V.Enum.ColumnPropertyNames!Visible,True)
Gui.FormShell.GsGridShellNewRout.SetColumnProperty("gvRouter","Set_Up",V.Enum.ColumnPropertyNames!Width,"50")

Gui.FormShell.GsGridShellNewRout.SetColumnProperty("gvRouter","Run_Time",v.Enum.ColumnPropertyNames!Caption,"Runtime")
Gui.FormShell.GsGridShellNewRout.SetColumnProperty("gvRouter","Run_Time",V.Enum.ColumnPropertyNames!HeaderForeColor,v.Color.PRI-GSS-00)
Gui.FormShell.GsGridShellNewRout.SetColumnProperty("gvRouter","Run_Time",V.Enum.ColumnPropertyNames!HeaderFontBold,True)
Gui.FormShell.GsGridShellNewRout.SetColumnProperty("gvRouter","Run_Time",V.Enum.ColumnPropertyNames!ReadOnly,False)
Gui.FormShell.GsGridShellNewRout.SetColumnProperty("gvRouter","Run_Time",V.Enum.ColumnPropertyNames!AllowEdit,True)
Gui.FormShell.GsGridShellNewRout.SetColumnProperty("gvRouter","Run_Time",V.Enum.ColumnPropertyNames!Visible,True)
Gui.FormShell.GsGridShellNewRout.SetColumnProperty("gvRouter","Run_Time",V.Enum.ColumnPropertyNames!Width,"50")

Gui.FormShell.GsGridShellNewRout.SetColumnProperty("gvRouter","UM_Inventory",v.Enum.ColumnPropertyNames!Caption,"Unit")
Gui.FormShell.GsGridShellNewRout.SetColumnProperty("gvRouter","UM_Inventory",V.Enum.ColumnPropertyNames!HeaderForeColor,v.Color.PRI-GSS-00)
Gui.FormShell.GsGridShellNewRout.SetColumnProperty("gvRouter","UM_Inventory",V.Enum.ColumnPropertyNames!HeaderFontBold,True)
Gui.FormShell.GsGridShellNewRout.SetColumnProperty("gvRouter","UM_Inventory",V.Enum.ColumnPropertyNames!ReadOnly,True)
Gui.FormShell.GsGridShellNewRout.SetColumnProperty("gvRouter","UM_Inventory",V.Enum.ColumnPropertyNames!AllowEdit,False)
Gui.FormShell.GsGridShellNewRout.SetColumnProperty("gvRouter","UM_Inventory",V.Enum.ColumnPropertyNames!Visible,True)
Gui.FormShell.GsGridShellNewRout.SetColumnProperty("gvRouter","UM_Inventory",V.Enum.ColumnPropertyNames!Width,"50")

Gui.FormShell.GsGridShellNewRout.SetColumnProperty("gvRouter","Rate",v.Enum.ColumnPropertyNames!Caption,"Rate")
Gui.FormShell.GsGridShellNewRout.SetColumnProperty("gvRouter","Rate",V.Enum.ColumnPropertyNames!HeaderForeColor,v.Color.PRI-GSS-00)
Gui.FormShell.GsGridShellNewRout.SetColumnProperty("gvRouter","Rate",V.Enum.ColumnPropertyNames!HeaderFontBold,True)
Gui.FormShell.GsGridShellNewRout.SetColumnProperty("gvRouter","Rate",V.Enum.ColumnPropertyNames!ReadOnly,False)
Gui.FormShell.GsGridShellNewRout.SetColumnProperty("gvRouter","Rate",V.Enum.ColumnPropertyNames!AllowEdit,True)
Gui.FormShell.GsGridShellNewRout.SetColumnProperty("gvRouter","Rate",V.Enum.ColumnPropertyNames!Visible,True)
Gui.FormShell.GsGridShellNewRout.SetColumnProperty("gvRouter","Rate",V.Enum.ColumnPropertyNames!Width,"50")

Gui.FormShell.GsGridShellNewRout.SetColumnProperty("gvRouter","Desc_Rt_Line",v.Enum.ColumnPropertyNames!Caption,"Description")
Gui.FormShell.GsGridShellNewRout.SetColumnProperty("gvRouter","Desc_Rt_Line",V.Enum.ColumnPropertyNames!HeaderForeColor,v.Color.PRI-GSS-00)
Gui.FormShell.GsGridShellNewRout.SetColumnProperty("gvRouter","Desc_Rt_Line",V.Enum.ColumnPropertyNames!HeaderFontBold,True)
Gui.FormShell.GsGridShellNewRout.SetColumnProperty("gvRouter","Desc_Rt_Line",V.Enum.ColumnPropertyNames!ReadOnly,True)
Gui.FormShell.GsGridShellNewRout.SetColumnProperty("gvRouter","Desc_Rt_Line",V.Enum.ColumnPropertyNames!AllowEdit,False)
Gui.FormShell.GsGridShellNewRout.SetColumnProperty("gvRouter","Desc_Rt_Line",V.Enum.ColumnPropertyNames!Visible,True)

Gui.FormShell.GsGridShellNewRout.SetColumnProperty("gvRouter","Cuts",v.Enum.ColumnPropertyNames!Caption,"Cuts")
Gui.FormShell.GsGridShellNewRout.SetColumnProperty("gvRouter","Cuts",V.Enum.ColumnPropertyNames!HeaderForeColor,v.Color.PRI-GSS-00)
Gui.FormShell.GsGridShellNewRout.SetColumnProperty("gvRouter","Cuts",V.Enum.ColumnPropertyNames!HeaderFontBold,True)
Gui.FormShell.GsGridShellNewRout.SetColumnProperty("gvRouter","Cuts",V.Enum.ColumnPropertyNames!ReadOnly,False)
Gui.FormShell.GsGridShellNewRout.SetColumnProperty("gvRouter","Cuts",V.Enum.ColumnPropertyNames!AllowEdit,True)
Gui.FormShell.GsGridShellNewRout.SetColumnProperty("gvRouter","Cuts",V.Enum.ColumnPropertyNames!Visible,True)
Gui.FormShell.GsGridShellNewRout.SetColumnProperty("gvRouter","Cuts",V.Enum.ColumnPropertyNames!CellWordWrap,"Wrap")

gui.FormShell.GsGridShellNewRout.MainView("gvRouter")

F.Intrinsic.Control.ExitSub

F.Intrinsic.Control.Label("Set_Prop_Shell_Err")
F.Intrinsic.Control.If(V.Ambient.ErrorNumber,<>,0)
	F.Intrinsic.String.Build("Project: GCG_6721_Shell_Crate_Calc.g2u {0}{0}Subroutine: {1}{0}Error Occurred {2} with description {3}",V.Ambient.NewLine,V.Ambient.CurrentSubroutine,V.Ambient.ErrorNumber,V.Ambient.ErrorDescription,V.Local.sError)
	F.Intrinsic.UI.Msgbox(V.Local.sError)
	F.Intrinsic.Control.CallSub(FormShell_UnLoad)
Function.Intrinsic.Control.EndIf
Program.Sub.Set_Prop_Shell.End

Program.Sub.txtShellTemplate_GotFocus.Start
F.Intrinsic.Control.SetErrorHandler("txtShellTemplate_GotFocus_Err")
F.Intrinsic.Control.ClearErrors

V.Local.sError.Declare(String,"")

Gui.FormShell.txtShellTemplate.SelectAll

F.Intrinsic.Control.ExitSub

F.Intrinsic.Control.Label("txtShellTemplate_GotFocus_Err")
F.Intrinsic.Control.If(V.Ambient.ErrorNumber,<>,0)
	F.Intrinsic.String.Build("Project: GCG_6721_Shell_Crate_Calc.g2u {0}{0}Subroutine: {1}{0}Error Occurred {2} with description {3}",V.Ambient.NewLine,V.Ambient.CurrentSubroutine,V.Ambient.ErrorNumber,V.Ambient.ErrorDescription,V.Local.sError)
	F.Intrinsic.UI.Msgbox(V.Local.sError)
	F.Intrinsic.Control.CallSub(FormShell_UnLoad)
Function.Intrinsic.Control.EndIf
Program.Sub.txtShellTemplate_GotFocus.End

Program.Sub.txtShellTemplate_LostFocus.Start
F.Intrinsic.Control.SetErrorHandler("txtShellTemplate_LostFocus_Err")
F.Intrinsic.Control.ClearErrors

V.Local.sError.Declare(String,"")
V.Local.sRouter.Declare(String,"")
V.Local.sSql.Declare(String,"")

V.Local.sRouter.Set(V.Screen.FormShell!txtShellTemplate.Text)
F.Intrinsic.Control.If(V.Local.sRouter.Trim,=,"")
	F.Intrinsic.Control.ExitSub
F.Intrinsic.Control.EndIf
F.Intrinsic.Control.BlockEvents
F.Intrinsic.String.Build("Select Router From V_Router_Header Where Router = '{0}'",V.Local.sRouter.Trim,V.Local.sSql)
F.ODBC.Connection!Conx.OpenCompanyConnection
F.ODBC.Connection!Conx.ExecuteAndReturn(V.Local.sSql,V.Local.sRouter)
F.ODBC.Connection!Conx.Close
F.Intrinsic.Control.If(V.Local.sRouter.Trim,<>,"")
	F.Intrinsic.Control.CallSub(Get_Data_Shell)
F.Intrinsic.Control.Else
	F.Intrinsic.UI.Msgbox("Template Router Not Found.....","Attention")
	Gui.FormShell.txtShellTemplate.SetFocus
	Gui.FormShell.txtShellTemplate.SelectAll
F.Intrinsic.Control.EndIf
F.Intrinsic.Control.UnBlockEvents

F.Intrinsic.Control.ExitSub

F.Intrinsic.Control.Label("txtShellTemplate_LostFocus_Err")
F.Intrinsic.Control.If(V.Ambient.ErrorNumber,<>,0)
	F.Intrinsic.String.Build("Project: GCG_6721_Shell_Crate_Calc.g2u {0}{0}Subroutine: {1}{0}Error Occurred {2} with description {3}",V.Ambient.NewLine,V.Ambient.CurrentSubroutine,V.Ambient.ErrorNumber,V.Ambient.ErrorDescription,V.Local.sError)
	F.Intrinsic.UI.Msgbox(V.Local.sError)
	F.Intrinsic.Control.CallSub(FormShell_UnLoad)
Function.Intrinsic.Control.EndIf
Program.Sub.txtShellTemplate_LostFocus.End

Program.Sub.txtShellLen_GotFocus.Start
F.Intrinsic.Control.SetErrorHandler("txtShellLen_GotFocus_Err")
F.Intrinsic.Control.ClearErrors

V.Local.sError.Declare(String,"")

Gui.FormShell.txtShellLen.SelectAll

F.Intrinsic.Control.ExitSub

F.Intrinsic.Control.Label("txtShellLen_GotFocus_Err")
F.Intrinsic.Control.If(V.Ambient.ErrorNumber,<>,0)
	F.Intrinsic.String.Build("Project: GCG_6721_Shell_Crate_Calc.g2u {0}{0}Subroutine: {1}{0}Error Occurred {2} with description {3}",V.Ambient.NewLine,V.Ambient.CurrentSubroutine,V.Ambient.ErrorNumber,V.Ambient.ErrorDescription,V.Local.sError)
	F.Intrinsic.UI.Msgbox(V.Local.sError)
	F.Intrinsic.Control.CallSub(FormShell_UnLoad)
Function.Intrinsic.Control.EndIf
Program.Sub.txtShellLen_GotFocus.End

Program.Sub.txtShellWidth_GotFocus.Start
F.Intrinsic.Control.SetErrorHandler("txtShellWidth_GotFocus_Err")
F.Intrinsic.Control.ClearErrors

V.Local.sError.Declare(String,"")

Gui.FormShell.txtShellWidth.SelectAll

F.Intrinsic.Control.ExitSub

F.Intrinsic.Control.Label("txtShellWidth_GotFocus_Err")
F.Intrinsic.Control.If(V.Ambient.ErrorNumber,<>,0)
	F.Intrinsic.String.Build("Project: GCG_6721_Shell_Crate_Calc.g2u {0}{0}Subroutine: {1}{0}Error Occurred {2} with description {3}",V.Ambient.NewLine,V.Ambient.CurrentSubroutine,V.Ambient.ErrorNumber,V.Ambient.ErrorDescription,V.Local.sError)
	F.Intrinsic.UI.Msgbox(V.Local.sError)
	F.Intrinsic.Control.CallSub(FormShell_UnLoad)
Function.Intrinsic.Control.EndIf
Program.Sub.txtShellWidth_GotFocus.End

Program.Sub.txtShellHeight_GotFocus.Start
F.Intrinsic.Control.SetErrorHandler("txtShellHeight_GotFocus_Err")
F.Intrinsic.Control.ClearErrors

V.Local.sError.Declare(String,"")

Gui.FormShell.txtShellHeight.SelectAll

F.Intrinsic.Control.ExitSub

F.Intrinsic.Control.Label("txtShellHeight_GotFocus_Err")
F.Intrinsic.Control.If(V.Ambient.ErrorNumber,<>,0)
	F.Intrinsic.String.Build("Project: GCG_6721_Shell_Crate_Calc.g2u {0}{0}Subroutine: {1}{0}Error Occurred {2} with description {3}",V.Ambient.NewLine,V.Ambient.CurrentSubroutine,V.Ambient.ErrorNumber,V.Ambient.ErrorDescription,V.Local.sError)
	F.Intrinsic.UI.Msgbox(V.Local.sError)
	F.Intrinsic.Control.CallSub(FormShell_UnLoad)
Function.Intrinsic.Control.EndIf
Program.Sub.txtShellHeight_GotFocus.End

Program.Sub.cmdShellCalc_Click.Start
F.Intrinsic.Control.SetErrorHandler("cmdShellCalc_Click_Err")
F.Intrinsic.Control.ClearErrors

V.Local.sError.Declare(String,"")
V.Local.sRouter.Declare(String,"")
V.Local.sTemp.Declare(String,"")
V.Local.iTemp.Declare(Long,0)
V.Local.i.Declare(Long,0)
V.Local.sStart.Declare(String,"")
V.Local.fSetUp.Declare(Float,0)
V.Local.fRunTime.Declare(Float,0)
V.Local.fRate.Declare(Float,0)
V.Local.sFilter.Declare(String,"")
V.Local.sCuts.Declare(String,"")
V.Local.sMsg.Declare(String,"")
V.Local.sPart.Declare(String,"")
V.Local.sSql.Declare(String,"")

F.Intrinsic.Control.If(V.Screen.FormShell!txtShellTemplate.Text,=,"")
	V.Local.sMsg.Set("Select a Template Router")
F.Intrinsic.Control.EndIf

F.Intrinsic.Control.If(V.Screen.FormShell!txtShellLen.Text,=,"")
	F.Intrinsic.Control.If(V.Local.sMsg.Trim,=,"")
		V.Local.sMsg.Set("Crate Length Missing")
	F.Intrinsic.Control.Else
		F.Intrinsic.String.Build("{0} and Crate Length Missing")
	F.Intrinsic.Control.EndIf
F.Intrinsic.Control.EndIf

F.Intrinsic.Control.If(V.Screen.FormShell!txtShellWidth.Text,=,"")
	F.Intrinsic.Control.If(V.Local.sMsg.Trim,=,"")
		V.Local.sMsg.Set("Crate Width Missing")
	F.Intrinsic.Control.Else
		F.Intrinsic.String.Build("{0} and Crate Width Missing")
	F.Intrinsic.Control.EndIf
F.Intrinsic.Control.EndIf

F.Intrinsic.Control.If(V.Screen.FormShell!txtShellHeight.Text,=,"")
	F.Intrinsic.Control.If(V.Local.sMsg.Trim,=,"")
		V.Local.sMsg.Set("Crate Height Missing")
	F.Intrinsic.Control.Else
		F.Intrinsic.String.Build("{0} and Crate Height Missing")
	F.Intrinsic.Control.EndIf
F.Intrinsic.Control.EndIf

F.Intrinsic.Control.If(V.Local.sMsg.Trim,<>,"")
	F.Intrinsic.UI.Msgbox(V.Local.sMsg,"Attention")
	F.Intrinsic.Control.ExitSub
F.Intrinsic.Control.EndIf

Gui.FormShell..Enabled(False)

F.Intrinsic.String.Build("{0}x{1}x{2}",V.Screen.FormShell!txtShellLen.Text,V.Screen.FormShell!txtShellWidth.Text,V.Screen.FormShell!txtShellHeight.Text,V.Local.sRouter)

F.ODBC.Connection!Con.OpenCompanyConnection
V.Local.sTemp.Set(V.Screen.FormShell!txtShellTemplate.Text)
F.Intrinsic.String.Build("Select Sort_2 From V_Router_Header Where Router = '{0}'",V.Local.sTemp.Trim,V.Local.sStart)
F.ODBC.Connection!Con.ExecuteAndReturn(V.Local.sStart,V.Local.sStart)
V.Global.sSort.Set(V.Local.sStart.Trim)
F.ODBC.Connection!Con.Close

F.Intrinsic.String.Build("{0}-{1}",V.Local.sStart.Trim,V.Local.sRouter,V.Local.sRouter)

F.Data.DataTable.DeleteRow("dtRouterTemp")
F.Data.DataTable.AcceptChanges("dtRouterTemp")

F.Data.DataView.Create("RLine","MLine",22,"LMO = 'M'","Line_Router")
F.Intrinsic.Control.For(V.Local.i,0,V.DataView.RLine!MLine.RowCount--,1)
	F.Intrinsic.Control.SelectCase(V.DataView.RLine!MLine(V.Local.i).Operation!FieldValTrim)
		F.Intrinsic.Control.Case("T STRG")
			V.Local.sPart.Set(V.Screen.FormShell!ddlTStrgMat.Text)
			
		F.Intrinsic.Control.Case("B STRG")
			V.Local.sPart.Set(V.Screen.FormShell!ddlBStrg.Text)
			
		F.Intrinsic.Control.Case("RUN")
			V.Local.sPart.Set(V.Screen.FormShell!ddlRunMat.Text)
			
		F.Intrinsic.Control.Case("SIDE 1")
			V.Local.sPart.Set(V.Screen.FormShell!ddlSide1Mat.Text)
			
		F.Intrinsic.Control.Case("SIDE 2")
			V.Local.sPart.Set(V.Screen.FormShell!ddlSide2Mat.Text)
			
		F.Intrinsic.Control.Case("TOP")
			V.Local.sPart.Set(V.Screen.FormShell!ddlTopMat.Text)
			
		F.Intrinsic.Control.CaseElse
			V.Local.sPart.Set("")
			
	F.Intrinsic.Control.EndSelect
	
	F.ODBC.Connection!Con.OpenCompanyConnection
	F.Intrinsic.String.Build("Select Top 1 a.UM_Inventory, a.Description, b.Cost, c.Length, c.Width From V_Inventory_Mstr a Left Join V_Inventory_Cost b on a.Part = b.Part and a.Location = b.Locn Left Join V_Inventory_Mst2 c on a.Part = c.Part and a.Location = c.Location Where a.Part = '{0}'",V.Local.sPart,V.Local.sSql)
	F.ODBC.Connection!Con.ExecuteAndReturn(V.Local.sSql,V.Local.sTemp)
	F.ODBC.Connection!Con.Close
	F.Intrinsic.String.Split(V.Local.sTemp,"*!*",V.Local.sTemp)
	V.Local.sTemp.RedimPreserve(0,4)
	
	F.Intrinsic.Control.If(V.Local.sTemp(2),<>,"")
		V.Local.fRate.Set(V.Local.sTemp(2).Float)
	F.Intrinsic.Control.Else
		V.Local.fRate.Set(V.DataView.RLine!MLine(V.Local.i).Rate!FieldVal)
	F.Intrinsic.Control.EndIf
	F.Intrinsic.Control.If(V.Local.sTemp(3),=,"")
		V.Local.sTemp(3).Set("1")
	F.Intrinsic.Control.EndIf
	F.Intrinsic.Control.If(V.Local.sTemp(4),=,"")
		V.Local.sTemp(4).Set("1")
	F.Intrinsic.Control.EndIf
	V.Local.fSetUp.Set(V.DataView.RLine!MLine(V.Local.i).Set_Up!FieldVal)
	F.Intrinsic.Control.CallSub(Get_Shell_Runtime,"Index",V.Local.i,"Len",V.Local.sTemp(3).Float,"Wid",V.Local.sTemp(4).Float)
	V.Local.fRunTime.Set(V.Args.RunTime)
	V.Local.sCuts.Set(V.Args.Cuts)
	
	F.Data.Datatable.AddRow("dtRouterTemp","Router",V.Local.sRouter,"Line_Router",V.DataView.RLine!MLine(V.Local.i).Line_Router!FieldVal,"LMO",V.DataView.RLine!MLine(V.Local.i).LMO!FieldVal,"Part_WC_Outside",V.Local.sPart,"Operation",V.DataView.RLine!MLine(V.Local.i).Operation!FieldVal,"Set_Up",V.Local.fSetUp,"Run_Time",V.Local.fRunTime,"UM_Inventory",V.Local.sTemp(0).Trim,"Rate",V.Local.fRate,"Desc_Rt_Line",V.Local.sTemp(1).Trim,"Cuts",V.Local.sCuts)	
		
F.Intrinsic.Control.Next(V.Local.i)

F.Data.DataTable.DeleteRow("dtRouter")
F.Data.DataTable.AcceptChanges("dtRouter")

F.Intrinsic.Control.For(V.Local.i,0,V.DataTable.dtRouterTemp.RowCount--,1)
	V.Local.fRunTime.Set(V.DataTable.dtRouterTemp(V.Local.i).Run_Time!FieldValFloat)
	F.Intrinsic.Math.Int(V.Local.fRunTime,V.Local.fSetUp)
	F.Intrinsic.Control.If(V.Local.fRunTime,<,V.Local.fSetUp)
		F.Intrinsic.Math.Sub(V.Local.fSetUp.Long,1,V.Local.fRunTime)
	F.Intrinsic.Control.Else
		F.Intrinsic.Math.Add(V.Local.fSetUp.Long,1,V.Local.fRunTime)
	F.Intrinsic.Control.EndIf
	F.Data.DataTable.SetValue("dtRouterTemp",V.Local.i,"Run_Time",V.Local.fRunTime)
F.Intrinsic.Control.Next(V.Local.i)

F.Data.DataTable.Merge("dtRouterTemp","dtRouter",4,2)

F.Data.DataView.Close("RLine","MLine")

Gui.FormShell..Enabled(True)

F.Intrinsic.Control.ExitSub

F.Intrinsic.Control.Label("cmdShellCalc_Click_Err")
F.Intrinsic.Control.If(V.Ambient.ErrorNumber,<>,0)
	F.Intrinsic.String.Build("Project: GCG_6721_Shell_Crate_Calc.g2u {0}{0}Subroutine: {1}{0}Error Occurred {2} with description {3}",V.Ambient.NewLine,V.Ambient.CurrentSubroutine,V.Ambient.ErrorNumber,V.Ambient.ErrorDescription,V.Local.sError)
	F.Intrinsic.UI.Msgbox(V.Local.sError)
	F.Intrinsic.Control.CallSub(FormShell_UnLoad)
Function.Intrinsic.Control.EndIf
Program.Sub.cmdShellCalc_Click.End

Program.Sub.txtNotes_GotFocus.Start
F.Intrinsic.Control.SetErrorHandler("txtNotes_GotFocus_Err")
F.Intrinsic.Control.ClearErrors

V.Local.sError.Declare(String,"")

Gui.FormShell.txtNotes.SelectAll

F.Intrinsic.Control.ExitSub

F.Intrinsic.Control.Label("txtNotes_GotFocus_Err")
F.Intrinsic.Control.If(V.Ambient.ErrorNumber,<>,0)
	F.Intrinsic.String.Build("Project: GCG_6721_Shell_Crate_Calc.g2u {0}{0}Subroutine: {1}{0}Error Occurred {2} with description {3}",V.Ambient.NewLine,V.Ambient.CurrentSubroutine,V.Ambient.ErrorNumber,V.Ambient.ErrorDescription,V.Local.sError)
	F.Intrinsic.UI.Msgbox(V.Local.sError)
	F.Intrinsic.Control.CallSub(FormShell_UnLoad)
Function.Intrinsic.Control.EndIf
Program.Sub.txtNotes_GotFocus.End

Program.Sub.cmdShellTemplate_Click.Start
F.Intrinsic.Control.SetErrorHandler("cmdShellTemplate_Click_Err")
F.Intrinsic.Control.ClearErrors

V.Local.sError.Declare(String,"")
V.Local.sRet.Declare(String,"")
V.Local.sSql.Declare(String,"")
V.Local.sTitles.Declare(String,"")
V.Local.sWidths.Declare(String,"")

F.Intrinsic.UI.SetBrowserHotTypeAhead(True)

F.ODBC.Connection!Con.OpenCompanyConnection

V.Local.sSql.Set("Select rtrim(Router), rtrim(Description_Router) From V_Router_Header Where ltrim(rtrim(ucase(Sort_1))) = 'SHELL TEMPLATE' Order by Router")

V.Local.sTitles.Set("Router*!*Description")
V.Local.sWidths.Set("1800*!*2400")

F.Intrinsic.String.Split(V.Local.sTitles,"*!*",V.Local.sTitles)
F.Intrinsic.String.Split(V.Local.sWidths,"*!*",V.Local.sWidths)

F.Intrinsic.UI.Browser("Select Template","con",V.Local.sSql,V.Local.sTitles,V.Local.sWidths,10200,8700,V.Local.sRet)

F.ODBC.Connection!Con.Close

F.Intrinsic.Control.If(V.Local.sRet,<>,"***CANCEL***")
	F.Intrinsic.String.Split(V.Local.sRet,"*!*",V.Local.sRet)
	Gui.FormShell.txtShellTemplate.Text(V.Local.sRet.UCase)
	Gui.FormShell.txtShellDesc.Text(V.Local.sRet.UCase)
	F.Intrinsic.Control.BlockEvents
	F.Intrinsic.Control.CallSub(Get_Data_Shell)
	F.Intrinsic.Control.UnBlockEvents
F.Intrinsic.Control.EndIf
	
F.Intrinsic.Control.ExitSub

F.Intrinsic.Control.Label("cmdShellTemplate_Click_Err")
F.Intrinsic.Control.If(V.Ambient.ErrorNumber,<>,0)
	F.Intrinsic.String.Build("Project: GCG_6721_Shell_Crate_Calc.g2u {0}{0}Subroutine: {1}{0}Error Occurred {2} with description {3}",V.Ambient.NewLine,V.Ambient.CurrentSubroutine,V.Ambient.ErrorNumber,V.Ambient.ErrorDescription,V.Local.sError)
	F.Intrinsic.UI.Msgbox(V.Local.sError)
	F.Intrinsic.Control.CallSub(FormShell_UnLoad)
Function.Intrinsic.Control.EndIf
Program.Sub.cmdShellTemplate_Click.End

Program.Sub.txtShellLen_LostFocus.Start
F.Intrinsic.Control.SetErrorHandler("txtShellLen_LostFocus_Err")
F.Intrinsic.Control.ClearErrors

V.Local.sError.Declare(String,"")
V.Local.i.Declare(Long,0)
V.Local.sSql.Declare(String,"")
V.Local.sEval.Declare(String,"")
V.Local.fWidth.Declare(Float,0)
V.Local.fHeight.Declare(Float,0)
V.Local.fMatWid.Declare(Float,0)
V.Local.fMatLen.Declare(Float,0)
V.Local.fQty1.Declare(Float,0)
V.Local.fQty2.Declare(Float,0)
V.Local.fTemp1.Declare(Float,0)
V.Local.fLength.Declare(Float,0)
V.Local.bMW1.Declare(Boolean,False)
V.Local.bMW2.Declare(Boolean,False)

V.Local.fHeight.Set(V.Screen.FormShell!txtShellHeight.Text)
V.Local.fLength.Set(V.Screen.FormShell!txtShellLen.Text)
V.Local.fWidth.Set(V.Screen.FormShell!txtShellWidth.Text)

F.ODBC.Connection!Con.OpenCompanyConnection

F.Data.DataView.Create("CrateCalc","Temp",22,"Dim1Qty like '*[[]CL[]]*'","")

F.Intrinsic.Control.For(V.Local.i,0,V.Datatable.CrateCalc.RowCount--,1)
	F.Intrinsic.Control.SelectCase(V.Datatable.CrateCalc(V.Local.i).OpCode!FieldValTrim)
		F.Intrinsic.Control.Case("SIDE 1")
			F.Intrinsic.String.Build("Select Length From V_Inventory_Mst2 Where Part = '{0}'",V.Screen.FormShell!ddlSide1Mat.Text,V.Local.sSql)
			F.ODBC.Connection!con.ExecuteAndReturn(V.Local.sSql,V.Local.fMatLen)
			F.Intrinsic.String.Build("Select Width From V_Inventory_Mst2 Where Part = '{0}'",V.Screen.FormShell!ddlSide1Mat.Text,V.Local.sSql)
			F.ODBC.Connection!con.ExecuteAndReturn(V.Local.sSql,V.Local.fMatWid)
			F.Intrinsic.String.IsInString(V.Datatable.CrateCalc(V.Local.i).Dim1Qty!FieldValTrim,"/[MW]",True,V.Local.bMW1)
			F.Intrinsic.String.Replace(V.Datatable.CrateCalc(V.Local.i).Dim1Qty!FieldValTrim,"[CL]",V.Local.fLength,V.Local.sEval)
			F.Intrinsic.String.Replace(V.Local.sEval,"[CW]",V.Local.fWidth,V.Local.sEval)
			F.Intrinsic.String.Replace(V.Local.sEval,"[CH]",V.Local.fHeight,V.Local.sEval)
			F.Intrinsic.String.Replace(V.Local.sEval,"[MW]",V.Local.fMatWid,V.Local.sEval)
			F.Intrinsic.String.Replace(V.Local.sEval,"[ML]",V.Local.fMatLen,V.Local.sEval)
			F.Intrinsic.String.RegExReplace(V.Local.sEval,"/0","/1",True,True,V.Local.sEval)
			F.Intrinsic.Control.If(V.Local.sEval,<>,"")
				F.Intrinsic.Math.Evaluate(V.Local.sEval,V.Local.fQty1)
			F.Intrinsic.Control.Else
				V.Local.fQty1.Set(0)
			F.Intrinsic.Control.EndIf
			F.Intrinsic.Control.If(V.Local.bMW1)
				F.Intrinsic.Math.Int(V.Local.fQty1,V.Local.fTemp1)
				F.Intrinsic.Control.If(V.Local.fQty1,<,V.Local.fTemp1)
					F.Intrinsic.Math.Sub(V.Local.fTemp1.Long,1,V.Local.fQty1)
				F.Intrinsic.Control.Else
					F.Intrinsic.Math.Add(V.Local.fTemp1.Long,1,V.Local.fQty1)
				F.Intrinsic.Control.EndIf
			F.Intrinsic.Control.EndIf
			Gui.FormShell.txtSide1QtyDim1.Text(V.Local.fQty1)
			
		F.Intrinsic.Control.Case("SIDE 2")
			F.Intrinsic.String.Build("Select Length From V_Inventory_Mst2 Where Part = '{0}'",V.Screen.FormShell!ddlSide2Mat.Text,V.Local.sSql)
			F.ODBC.Connection!con.ExecuteAndReturn(V.Local.sSql,V.Local.fMatLen)
			F.Intrinsic.String.Build("Select Width From V_Inventory_Mst2 Where Part = '{0}'",V.Screen.FormShell!ddlSide2Mat.Text,V.Local.sSql)
			F.ODBC.Connection!con.ExecuteAndReturn(V.Local.sSql,V.Local.fMatWid)
			F.Intrinsic.String.IsInString(V.Datatable.CrateCalc(V.Local.i).Dim1Qty!FieldValTrim,"/[MW]",True,V.Local.bMW1)
			F.Intrinsic.String.Replace(V.Datatable.CrateCalc(V.Local.i).Dim1Qty!FieldValTrim,"[CL]",V.Local.fLength,V.Local.sEval)
			F.Intrinsic.String.Replace(V.Local.sEval,"[CW]",V.Local.fWidth,V.Local.sEval)
			F.Intrinsic.String.Replace(V.Local.sEval,"[CH]",V.Local.fHeight,V.Local.sEval)
			F.Intrinsic.String.Replace(V.Local.sEval,"[MW]",V.Local.fMatWid,V.Local.sEval)
			F.Intrinsic.String.Replace(V.Local.sEval,"[ML]",V.Local.fMatLen,V.Local.sEval)
			F.Intrinsic.String.RegExReplace(V.Local.sEval,"/0","/1",True,True,V.Local.sEval)
			F.Intrinsic.Control.If(V.Local.sEval,<>,"")
				F.Intrinsic.Math.Evaluate(V.Local.sEval,V.Local.fQty1)
			F.Intrinsic.Control.Else
				V.Local.fQty1.Set(0)
			F.Intrinsic.Control.EndIf
			F.Intrinsic.Control.If(V.Local.bMW1)
				F.Intrinsic.Math.Int(V.Local.fQty1,V.Local.fTemp1)
				F.Intrinsic.Control.If(V.Local.fQty1,<,V.Local.fTemp1)
					F.Intrinsic.Math.Sub(V.Local.fTemp1.Long,1,V.Local.fQty1)
				F.Intrinsic.Control.Else
					F.Intrinsic.Math.Add(V.Local.fTemp1.Long,1,V.Local.fQty1)
				F.Intrinsic.Control.EndIf
			F.Intrinsic.Control.EndIf
			Gui.FormShell.txtSide2QtyDim1.Text(V.Local.fQty1)
			
		F.Intrinsic.Control.Case("TOP")
			F.Intrinsic.String.Build("Select Length From V_Inventory_Mst2 Where Part = '{0}'",V.Screen.FormShell!ddlTopMat.Text,V.Local.sSql)
			F.ODBC.Connection!con.ExecuteAndReturn(V.Local.sSql,V.Local.fMatLen)
			F.Intrinsic.String.Build("Select Width From V_Inventory_Mst2 Where Part = '{0}'",V.Screen.FormShell!ddlTopMat.Text,V.Local.sSql)
			F.ODBC.Connection!con.ExecuteAndReturn(V.Local.sSql,V.Local.fMatWid)
			F.Intrinsic.String.IsInString(V.Datatable.CrateCalc(V.Local.i).Dim1Qty!FieldValTrim,"/[MW]",True,V.Local.bMW1)
			F.Intrinsic.String.Replace(V.Datatable.CrateCalc(V.Local.i).Dim1Qty!FieldValTrim,"[CL]",V.Local.fLength,V.Local.sEval)
			F.Intrinsic.String.Replace(V.Local.sEval,"[CW]",V.Local.fWidth,V.Local.sEval)
			F.Intrinsic.String.Replace(V.Local.sEval,"[CH]",V.Local.fHeight,V.Local.sEval)
			F.Intrinsic.String.Replace(V.Local.sEval,"[MW]",V.Local.fMatWid,V.Local.sEval)
			F.Intrinsic.String.Replace(V.Local.sEval,"[ML]",V.Local.fMatLen,V.Local.sEval)
			F.Intrinsic.String.RegExReplace(V.Local.sEval,"/0","/1",True,True,V.Local.sEval)
			F.Intrinsic.Control.If(V.Local.sEval,<>,"")
				F.Intrinsic.Math.Evaluate(V.Local.sEval,V.Local.fQty1)
			F.Intrinsic.Control.Else
				V.Local.fQty1.Set(0)
			F.Intrinsic.Control.EndIf
			F.Intrinsic.Control.If(V.Local.bMW1)
				F.Intrinsic.Math.Int(V.Local.fQty1,V.Local.fTemp1)
				F.Intrinsic.Control.If(V.Local.fQty1,<,V.Local.fTemp1)
					F.Intrinsic.Math.Sub(V.Local.fTemp1.Long,1,V.Local.fQty1)
				F.Intrinsic.Control.Else
					F.Intrinsic.Math.Add(V.Local.fTemp1.Long,1,V.Local.fQty1)
				F.Intrinsic.Control.EndIf
			F.Intrinsic.Control.EndIf
			Gui.FormShell.txtTopQtyDim1.Text(V.Local.fQty1)
		
		
		F.Intrinsic.Control.Case("T STRG")
			F.Intrinsic.String.Build("Select Length From V_Inventory_Mst2 Where Part = '{0}'",V.Screen.FormShell!ddlTStrgMat.Text,V.Local.sSql)
			F.ODBC.Connection!con.ExecuteAndReturn(V.Local.sSql,V.Local.fMatLen)
			F.Intrinsic.String.Build("Select Width From V_Inventory_Mst2 Where Part = '{0}'",V.Screen.FormShell!ddlTStrgMat.Text,V.Local.sSql)
			F.ODBC.Connection!con.ExecuteAndReturn(V.Local.sSql,V.Local.fMatWid)
			F.Intrinsic.String.IsInString(V.Datatable.CrateCalc(V.Local.i).Dim1Qty!FieldValTrim,"/[MW]",True,V.Local.bMW1)
			F.Intrinsic.String.Replace(V.Datatable.CrateCalc(V.Local.i).Dim1Qty!FieldValTrim,"[CL]",V.Local.fLength,V.Local.sEval)
			F.Intrinsic.String.Replace(V.Local.sEval,"[CW]",V.Local.fWidth,V.Local.sEval)
			F.Intrinsic.String.Replace(V.Local.sEval,"[CH]",V.Local.fHeight,V.Local.sEval)
			F.Intrinsic.String.Replace(V.Local.sEval,"[MW]",V.Local.fMatWid,V.Local.sEval)
			F.Intrinsic.String.Replace(V.Local.sEval,"[ML]",V.Local.fMatLen,V.Local.sEval)
			F.Intrinsic.String.RegExReplace(V.Local.sEval,"/0","/1",True,True,V.Local.sEval)
			F.Intrinsic.Control.If(V.Local.sEval,<>,"")
				F.Intrinsic.Math.Evaluate(V.Local.sEval,V.Local.fQty1)
			F.Intrinsic.Control.Else
				V.Local.fQty1.Set(0)
			F.Intrinsic.Control.EndIf
			F.Intrinsic.Control.If(V.Local.bMW1)
				F.Intrinsic.Math.Int(V.Local.fQty1,V.Local.fTemp1)
				F.Intrinsic.Control.If(V.Local.fQty1,<,V.Local.fTemp1)
					F.Intrinsic.Math.Sub(V.Local.fTemp1.Long,1,V.Local.fQty1)
				F.Intrinsic.Control.Else
					F.Intrinsic.Math.Add(V.Local.fTemp1.Long,1,V.Local.fQty1)
				F.Intrinsic.Control.EndIf
			F.Intrinsic.Control.EndIf
			gui.FormShell.txtTStrgQty.Text(V.Local.fQty1)
			
		F.Intrinsic.Control.Case("B STRG")
			F.Intrinsic.String.Build("Select Length From V_Inventory_Mst2 Where Part = '{0}'",V.Screen.FormShell!ddlBStrg.Text,V.Local.sSql)
			F.ODBC.Connection!con.ExecuteAndReturn(V.Local.sSql,V.Local.fMatLen)
			F.Intrinsic.String.Build("Select Width From V_Inventory_Mst2 Where Part = '{0}'",V.Screen.FormShell!ddlBStrg.Text,V.Local.sSql)
			F.ODBC.Connection!con.ExecuteAndReturn(V.Local.sSql,V.Local.fMatWid)
			F.Intrinsic.String.IsInString(V.Datatable.CrateCalc(V.Local.i).Dim1Qty!FieldValTrim,"/[MW]",True,V.Local.bMW1)
			F.Intrinsic.String.Replace(V.Datatable.CrateCalc(V.Local.i).Dim1Qty!FieldValTrim,"[CL]",V.Local.fLength,V.Local.sEval)
			F.Intrinsic.String.Replace(V.Local.sEval,"[CW]",V.Local.fWidth,V.Local.sEval)
			F.Intrinsic.String.Replace(V.Local.sEval,"[CH]",V.Local.fHeight,V.Local.sEval)
			F.Intrinsic.String.Replace(V.Local.sEval,"[MW]",V.Local.fMatWid,V.Local.sEval)
			F.Intrinsic.String.Replace(V.Local.sEval,"[ML]",V.Local.fMatLen,V.Local.sEval)
			F.Intrinsic.String.RegExReplace(V.Local.sEval,"/0","/1",True,True,V.Local.sEval)
			F.Intrinsic.Control.If(V.Local.sEval,<>,"")
				F.Intrinsic.Math.Evaluate(V.Local.sEval,V.Local.fQty1)
			F.Intrinsic.Control.Else
				V.Local.fQty1.Set(0)
			F.Intrinsic.Control.EndIf
			F.Intrinsic.Control.If(V.Local.bMW1)
				F.Intrinsic.Math.Int(V.Local.fQty1,V.Local.fTemp1)
				F.Intrinsic.Control.If(V.Local.fQty1,<,V.Local.fTemp1)
					F.Intrinsic.Math.Sub(V.Local.fTemp1.Long,1,V.Local.fQty1)
				F.Intrinsic.Control.Else
					F.Intrinsic.Math.Add(V.Local.fTemp1.Long,1,V.Local.fQty1)
				F.Intrinsic.Control.EndIf
			F.Intrinsic.Control.EndIf
			Gui.FormShell.txtBstrgQty.Text(V.Local.fQty1)
			
		F.Intrinsic.Control.Case("RUN")
			F.Intrinsic.String.Build("Select Length From V_Inventory_Mst2 Where Part = '{0}'",V.Screen.FormShell!ddlRunMat.Text,V.Local.sSql)
			F.ODBC.Connection!con.ExecuteAndReturn(V.Local.sSql,V.Local.fMatLen)
			F.Intrinsic.String.Build("Select Width From V_Inventory_Mst2 Where Part = '{0}'",V.Screen.FormShell!ddlRunMat.Text,V.Local.sSql)
			F.ODBC.Connection!con.ExecuteAndReturn(V.Local.sSql,V.Local.fMatWid)
			F.Intrinsic.String.IsInString(V.Datatable.CrateCalc(V.Local.i).Dim1Qty!FieldValTrim,"/[MW]",True,V.Local.bMW1)
			F.Intrinsic.String.Replace(V.Datatable.CrateCalc(V.Local.i).Dim1Qty!FieldValTrim,"[CL]",V.Local.fLength,V.Local.sEval)
			F.Intrinsic.String.Replace(V.Local.sEval,"[CW]",V.Local.fWidth,V.Local.sEval)
			F.Intrinsic.String.Replace(V.Local.sEval,"[CH]",V.Local.fHeight,V.Local.sEval)
			F.Intrinsic.String.Replace(V.Local.sEval,"[MW]",V.Local.fMatWid,V.Local.sEval)
			F.Intrinsic.String.Replace(V.Local.sEval,"[ML]",V.Local.fMatLen,V.Local.sEval)
			F.Intrinsic.String.RegExReplace(V.Local.sEval,"/0","/1",True,True,V.Local.sEval)
			F.Intrinsic.Control.If(V.Local.sEval,<>,"")
				F.Intrinsic.Math.Evaluate(V.Local.sEval,V.Local.fQty1)
			F.Intrinsic.Control.Else
				V.Local.fQty1.Set(0)
			F.Intrinsic.Control.EndIf
			F.Intrinsic.Control.If(V.Local.bMW1)
				F.Intrinsic.Math.Int(V.Local.fQty1,V.Local.fTemp1)
				F.Intrinsic.Control.If(V.Local.fQty1,<,V.Local.fTemp1)
					F.Intrinsic.Math.Sub(V.Local.fTemp1.Long,1,V.Local.fQty1)
				F.Intrinsic.Control.Else
					F.Intrinsic.Math.Add(V.Local.fTemp1.Long,1,V.Local.fQty1)
				F.Intrinsic.Control.EndIf
			F.Intrinsic.Control.EndIf
			Gui.FormShell.txtRunQty.Text(V.Local.fQty1)
			
	F.Intrinsic.Control.EndSelect
F.Intrinsic.Control.Next(V.Local.i)

F.Data.DataView.Close("CrateCalc","Temp")

F.Data.DataView.Create("CrateCalc","Temp",22,"Dim2Qty like '*[[]CL[]]*'","")

F.Intrinsic.Control.For(V.Local.i,0,V.Datatable.CrateCalc.RowCount--,1)
	F.Intrinsic.Control.SelectCase(V.Datatable.CrateCalc(V.Local.i).OpCode!FieldValTrim)
		F.Intrinsic.Control.Case("SIDE 1")
			F.Intrinsic.String.Build("Select Length From V_Inventory_Mst2 Where Part = '{0}'",V.Screen.FormShell!ddlSide1Mat.Text,V.Local.sSql)
			F.ODBC.Connection!con.ExecuteAndReturn(V.Local.sSql,V.Local.fMatLen)
			F.Intrinsic.String.Build("Select Width From V_Inventory_Mst2 Where Part = '{0}'",V.Screen.FormShell!ddlSide1Mat.Text,V.Local.sSql)
			F.ODBC.Connection!con.ExecuteAndReturn(V.Local.sSql,V.Local.fMatWid)
			F.Intrinsic.String.IsInString(V.Datatable.CrateCalc(V.Local.i).Dim2Qty!FieldValTrim,"/[MW]",True,V.Local.bMW2)
			F.Intrinsic.String.Replace(V.Datatable.CrateCalc(V.Local.i).Dim2Qty!FieldValTrim,"[CL]",V.Local.fLength,V.Local.sEval)
			F.Intrinsic.String.Replace(V.Local.sEval,"[CW]",V.Local.fWidth,V.Local.sEval)
			F.Intrinsic.String.Replace(V.Local.sEval,"[CH]",V.Local.fHeight,V.Local.sEval)
			F.Intrinsic.String.Replace(V.Local.sEval,"[MW]",V.Local.fMatWid,V.Local.sEval)
			F.Intrinsic.String.Replace(V.Local.sEval,"[ML]",V.Local.fMatLen,V.Local.sEval)
			F.Intrinsic.String.RegExReplace(V.Local.sEval,"/0","/1",True,True,V.Local.sEval)
			F.Intrinsic.Control.If(V.Local.sEval,<>,"")
				F.Intrinsic.Math.Evaluate(V.Local.sEval,V.Local.fQty2)
			F.Intrinsic.Control.Else
				V.Local.fQty2.Set(0)
			F.Intrinsic.Control.EndIf
			F.Intrinsic.Control.If(V.Local.bMW2)
				F.Intrinsic.Math.Int(V.Local.fQty2,V.Local.fTemp1)
				F.Intrinsic.Control.If(V.Local.fQty2,<,V.Local.fTemp1)
					F.Intrinsic.Math.Sub(V.Local.fTemp1.Long,1,V.Local.fQty2)
				F.Intrinsic.Control.Else
					F.Intrinsic.Math.Add(V.Local.fTemp1.Long,1,V.Local.fQty2)
				F.Intrinsic.Control.EndIf
			F.Intrinsic.Control.EndIf
			Gui.FormShell.txtSide1QtyDim2.Text(V.Local.fQty2)
			
		F.Intrinsic.Control.Case("SIDE 2")
			F.Intrinsic.String.Build("Select Length From V_Inventory_Mst2 Where Part = '{0}'",V.Screen.FormShell!ddlSide2Mat.Text,V.Local.sSql)
			F.ODBC.Connection!con.ExecuteAndReturn(V.Local.sSql,V.Local.fMatLen)
			F.Intrinsic.String.Build("Select Width From V_Inventory_Mst2 Where Part = '{0}'",V.Screen.FormShell!ddlSide2Mat.Text,V.Local.sSql)
			F.ODBC.Connection!con.ExecuteAndReturn(V.Local.sSql,V.Local.fMatWid)
			F.Intrinsic.String.IsInString(V.Datatable.CrateCalc(V.Local.i).Dim2Qty!FieldValTrim,"/[MW]",True,V.Local.bMW1)
			F.Intrinsic.String.Replace(V.Datatable.CrateCalc(V.Local.i).Dim2Qty!FieldValTrim,"[CL]",V.Local.fLength,V.Local.sEval)
			F.Intrinsic.String.Replace(V.Local.sEval,"[CW]",V.Local.fWidth,V.Local.sEval)
			F.Intrinsic.String.Replace(V.Local.sEval,"[CH]",V.Local.fHeight,V.Local.sEval)
			F.Intrinsic.String.Replace(V.Local.sEval,"[MW]",V.Local.fMatWid,V.Local.sEval)
			F.Intrinsic.String.Replace(V.Local.sEval,"[ML]",V.Local.fMatLen,V.Local.sEval)
			F.Intrinsic.String.RegExReplace(V.Local.sEval,"/0","/1",True,True,V.Local.sEval)
			F.Intrinsic.Control.If(V.Local.sEval,<>,"")
				F.Intrinsic.Math.Evaluate(V.Local.sEval,V.Local.fQty2)
			F.Intrinsic.Control.Else
				V.Local.fQty2.Set(0)
			F.Intrinsic.Control.EndIf
			F.Intrinsic.Control.If(V.Local.bMW2)
				F.Intrinsic.Math.Int(V.Local.fQty2,V.Local.fTemp1)
				F.Intrinsic.Control.If(V.Local.fQty2,<,V.Local.fTemp1)
					F.Intrinsic.Math.Sub(V.Local.fTemp1.Long,1,V.Local.fQty2)
				F.Intrinsic.Control.Else
					F.Intrinsic.Math.Add(V.Local.fTemp1.Long,1,V.Local.fQty2)
				F.Intrinsic.Control.EndIf
			F.Intrinsic.Control.EndIf
			Gui.FormShell.txtSide2QtyDim2.Text(V.Local.fQty2)
			
		F.Intrinsic.Control.Case("TOP")
			F.Intrinsic.String.Build("Select Length From V_Inventory_Mst2 Where Part = '{0}'",V.Screen.FormShell!ddlTopMat.Text,V.Local.sSql)
			F.ODBC.Connection!con.ExecuteAndReturn(V.Local.sSql,V.Local.fMatLen)
			F.Intrinsic.String.Build("Select Width From V_Inventory_Mst2 Where Part = '{0}'",V.Screen.FormShell!ddlTopMat.Text,V.Local.sSql)
			F.ODBC.Connection!con.ExecuteAndReturn(V.Local.sSql,V.Local.fMatWid)
			F.Intrinsic.String.IsInString(V.Datatable.CrateCalc(V.Local.i).Dim2Qty!FieldValTrim,"/[MW]",True,V.Local.bMW2)
			F.Intrinsic.String.Replace(V.Datatable.CrateCalc(V.Local.i).Dim2Qty!FieldValTrim,"[CL]",V.Local.fLength,V.Local.sEval)
			F.Intrinsic.String.Replace(V.Local.sEval,"[CW]",V.Local.fWidth,V.Local.sEval)
			F.Intrinsic.String.Replace(V.Local.sEval,"[CH]",V.Local.fHeight,V.Local.sEval)
			F.Intrinsic.String.Replace(V.Local.sEval,"[MW]",V.Local.fMatWid,V.Local.sEval)
			F.Intrinsic.String.Replace(V.Local.sEval,"[ML]",V.Local.fMatLen,V.Local.sEval)
			F.Intrinsic.String.RegExReplace(V.Local.sEval,"/0","/1",True,True,V.Local.sEval)
			F.Intrinsic.Control.If(V.Local.sEval,<>,"")
				F.Intrinsic.Math.Evaluate(V.Local.sEval,V.Local.fQty1)
			F.Intrinsic.Control.Else
				V.Local.fQty2.Set(0)
			F.Intrinsic.Control.EndIf
			F.Intrinsic.Control.If(V.Local.bMW2)
				F.Intrinsic.Math.Int(V.Local.fQty2,V.Local.fTemp1)
				F.Intrinsic.Control.If(V.Local.fQty2,<,V.Local.fTemp1)
					F.Intrinsic.Math.Sub(V.Local.fTemp1.Long,1,V.Local.fQty2)
				F.Intrinsic.Control.Else
					F.Intrinsic.Math.Add(V.Local.fTemp1.Long,1,V.Local.fQty2)
				F.Intrinsic.Control.EndIf
			F.Intrinsic.Control.EndIf
			Gui.FormShell.txtTopQtyDim2.Text(V.Local.fQty2)
			
	F.Intrinsic.Control.EndSelect
F.Intrinsic.Control.Next(V.Local.i)

F.Data.DataView.Close("CrateCalc","Temp")

F.Data.DataView.Create("CrateCalc","Temp",22,"Dim1Form like '*[[]CL[]]*'","")

F.Intrinsic.Control.For(V.Local.i,0,V.Datatable.CrateCalc.RowCount--,1)
	F.Intrinsic.Control.SelectCase(V.Datatable.CrateCalc(V.Local.i).OpCode!FieldValTrim)
		F.Intrinsic.Control.Case("SIDE 1")
			F.Intrinsic.String.Build("Select Length From V_Inventory_Mst2 Where Part = '{0}'",V.Screen.FormShell!ddlSide1Mat.Text,V.Local.sSql)
			F.ODBC.Connection!con.ExecuteAndReturn(V.Local.sSql,V.Local.fMatLen)
			F.Intrinsic.String.Build("Select Width From V_Inventory_Mst2 Where Part = '{0}'",V.Screen.FormShell!ddlSide1Mat.Text,V.Local.sSql)
			F.ODBC.Connection!con.ExecuteAndReturn(V.Local.sSql,V.Local.fMatWid)
			F.Intrinsic.String.Replace(V.Datatable.CrateCalc(V.Local.i).Dim1Form!FieldValTrim,"[CL]",V.Local.fLength,V.Local.sEval)
			F.Intrinsic.String.Replace(V.Local.sEval,"[CW]",V.Local.fWidth,V.Local.sEval)
			F.Intrinsic.String.Replace(V.Local.sEval,"[CH]",V.Local.fHeight,V.Local.sEval)
			F.Intrinsic.String.Replace(V.Local.sEval,"[MW]",V.Local.fMatWid,V.Local.sEval)
			F.Intrinsic.String.Replace(V.Local.sEval,"[ML]",V.Local.fMatLen,V.Local.sEval)
			F.Intrinsic.String.RegExReplace(V.Local.sEval,"/0","/1",True,True,V.Local.sEval)
			F.Intrinsic.Control.If(V.Local.sEval,<>,"")
				F.Intrinsic.Math.Evaluate(V.Local.sEval,V.Local.fQty1)
			F.Intrinsic.Control.Else
				V.Local.fQty1.Set(0)
			F.Intrinsic.Control.EndIf
			Gui.FormShell.txtSide1CutLenDim1.Text(V.Local.fQty1)
			
		F.Intrinsic.Control.Case("SIDE 2")
			F.Intrinsic.String.Build("Select Length From V_Inventory_Mst2 Where Part = '{0}'",V.Screen.FormShell!ddlSide2Mat.Text,V.Local.sSql)
			F.ODBC.Connection!con.ExecuteAndReturn(V.Local.sSql,V.Local.fMatLen)
			F.Intrinsic.String.Build("Select Width From V_Inventory_Mst2 Where Part = '{0}'",V.Screen.FormShell!ddlSide2Mat.Text,V.Local.sSql)
			F.ODBC.Connection!con.ExecuteAndReturn(V.Local.sSql,V.Local.fMatWid)
			F.Intrinsic.String.Replace(V.Datatable.CrateCalc(V.Local.i).Dim1Form!FieldValTrim,"[CL]",V.Local.fLength,V.Local.sEval)
			F.Intrinsic.String.Replace(V.Local.sEval,"[CW]",V.Local.fWidth,V.Local.sEval)
			F.Intrinsic.String.Replace(V.Local.sEval,"[CH]",V.Local.fHeight,V.Local.sEval)
			F.Intrinsic.String.Replace(V.Local.sEval,"[MW]",V.Local.fMatWid,V.Local.sEval)
			F.Intrinsic.String.Replace(V.Local.sEval,"[ML]",V.Local.fMatLen,V.Local.sEval)
			F.Intrinsic.String.RegExReplace(V.Local.sEval,"/0","/1",True,True,V.Local.sEval)
			F.Intrinsic.Control.If(V.Local.sEval,<>,"")
				F.Intrinsic.Math.Evaluate(V.Local.sEval,V.Local.fQty1)
			F.Intrinsic.Control.Else
				V.Local.fQty1.Set(0)
			F.Intrinsic.Control.EndIf
			Gui.FormShell.txtSide2CutLenDim1.Text(V.Local.fQty1)
			
		F.Intrinsic.Control.Case("TOP")
			F.Intrinsic.String.Build("Select Length From V_Inventory_Mst2 Where Part = '{0}'",V.Screen.FormShell!ddlTopMat.Text,V.Local.sSql)
			F.ODBC.Connection!con.ExecuteAndReturn(V.Local.sSql,V.Local.fMatLen)
			F.Intrinsic.String.Build("Select Width From V_Inventory_Mst2 Where Part = '{0}'",V.Screen.FormShell!ddlTopMat.Text,V.Local.sSql)
			F.ODBC.Connection!con.ExecuteAndReturn(V.Local.sSql,V.Local.fMatWid)
			F.Intrinsic.String.Replace(V.Datatable.CrateCalc(V.Local.i).Dim1Form!FieldValTrim,"[CL]",V.Local.fLength,V.Local.sEval)
			F.Intrinsic.String.Replace(V.Local.sEval,"[CW]",V.Local.fWidth,V.Local.sEval)
			F.Intrinsic.String.Replace(V.Local.sEval,"[CH]",V.Local.fHeight,V.Local.sEval)
			F.Intrinsic.String.Replace(V.Local.sEval,"[MW]",V.Local.fMatWid,V.Local.sEval)
			F.Intrinsic.String.Replace(V.Local.sEval,"[ML]",V.Local.fMatLen,V.Local.sEval)
			F.Intrinsic.String.RegExReplace(V.Local.sEval,"/0","/1",True,True,V.Local.sEval)
			F.Intrinsic.Control.If(V.Local.sEval,<>,"")
				F.Intrinsic.Math.Evaluate(V.Local.sEval,V.Local.fQty1)
			F.Intrinsic.Control.Else
				V.Local.fQty1.Set(0)
			F.Intrinsic.Control.EndIf
			Gui.FormShell.txtTopCutLenDim1.Text(V.Local.fQty1)
			
		F.Intrinsic.Control.Case("T STRG")
			F.Intrinsic.String.Build("Select Length From V_Inventory_Mst2 Where Part = '{0}'",V.Screen.FormShell!ddlTStrgMat.Text,V.Local.sSql)
			F.ODBC.Connection!con.ExecuteAndReturn(V.Local.sSql,V.Local.fMatLen)
			F.Intrinsic.String.Build("Select Width From V_Inventory_Mst2 Where Part = '{0}'",V.Screen.FormShell!ddlTStrgMat.Text,V.Local.sSql)
			F.ODBC.Connection!con.ExecuteAndReturn(V.Local.sSql,V.Local.fMatWid)
			F.Intrinsic.String.Replace(V.Datatable.CrateCalc(V.Local.i).Dim1Form!FieldValTrim,"[CL]",V.Local.fLength,V.Local.sEval)
			F.Intrinsic.String.Replace(V.Local.sEval,"[CW]",V.Local.fWidth,V.Local.sEval)
			F.Intrinsic.String.Replace(V.Local.sEval,"[CH]",V.Local.fHeight,V.Local.sEval)
			F.Intrinsic.String.Replace(V.Local.sEval,"[MW]",V.Local.fMatWid,V.Local.sEval)
			F.Intrinsic.String.Replace(V.Local.sEval,"[ML]",V.Local.fMatLen,V.Local.sEval)
			F.Intrinsic.String.RegExReplace(V.Local.sEval,"/0","/1",True,True,V.Local.sEval)
			F.Intrinsic.Control.If(V.Local.sEval,<>,"")
				F.Intrinsic.Math.Evaluate(V.Local.sEval,V.Local.fQty1)
			F.Intrinsic.Control.Else
				V.Local.fQty1.Set(0)
			F.Intrinsic.Control.EndIf
			gui.FormShell.txtTStrg.Text(V.Local.fQty1)
			
		F.Intrinsic.Control.Case("B STRG")
			F.Intrinsic.String.Build("Select Length From V_Inventory_Mst2 Where Part = '{0}'",V.Screen.FormShell!ddlBStrg.Text,V.Local.sSql)
			F.ODBC.Connection!con.ExecuteAndReturn(V.Local.sSql,V.Local.fMatLen)
			F.Intrinsic.String.Build("Select Width From V_Inventory_Mst2 Where Part = '{0}'",V.Screen.FormShell!ddlBStrg.Text,V.Local.sSql)
			F.ODBC.Connection!con.ExecuteAndReturn(V.Local.sSql,V.Local.fMatWid)
			F.Intrinsic.String.Replace(V.Datatable.CrateCalc(V.Local.i).Dim1Form!FieldValTrim,"[CL]",V.Local.fLength,V.Local.sEval)
			F.Intrinsic.String.Replace(V.Local.sEval,"[CW]",V.Local.fWidth,V.Local.sEval)
			F.Intrinsic.String.Replace(V.Local.sEval,"[CH]",V.Local.fHeight,V.Local.sEval)
			F.Intrinsic.String.Replace(V.Local.sEval,"[MW]",V.Local.fMatWid,V.Local.sEval)
			F.Intrinsic.String.Replace(V.Local.sEval,"[ML]",V.Local.fMatLen,V.Local.sEval)
			F.Intrinsic.String.RegExReplace(V.Local.sEval,"/0","/1",True,True,V.Local.sEval)
			F.Intrinsic.Control.If(V.Local.sEval,<>,"")
				F.Intrinsic.Math.Evaluate(V.Local.sEval,V.Local.fQty1)
			F.Intrinsic.Control.Else
				V.Local.fQty1.Set(0)
			F.Intrinsic.Control.EndIf
			Gui.FormShell.txtBStrg.Text(V.Local.fQty1)
			
		F.Intrinsic.Control.Case("RUN")
			F.Intrinsic.String.Build("Select Length From V_Inventory_Mst2 Where Part = '{0}'",V.Screen.FormShell!ddlRunMat.Text,V.Local.sSql)
			F.ODBC.Connection!con.ExecuteAndReturn(V.Local.sSql,V.Local.fMatLen)
			F.Intrinsic.String.Build("Select Width From V_Inventory_Mst2 Where Part = '{0}'",V.Screen.FormShell!ddlRunMat.Text,V.Local.sSql)
			F.ODBC.Connection!con.ExecuteAndReturn(V.Local.sSql,V.Local.fMatWid)
			F.Intrinsic.String.Replace(V.Datatable.CrateCalc(V.Local.i).Dim1Form!FieldValTrim,"[CL]",V.Local.fLength,V.Local.sEval)
			F.Intrinsic.String.Replace(V.Local.sEval,"[CW]",V.Local.fWidth,V.Local.sEval)
			F.Intrinsic.String.Replace(V.Local.sEval,"[CH]",V.Local.fHeight,V.Local.sEval)
			F.Intrinsic.String.Replace(V.Local.sEval,"[MW]",V.Local.fMatWid,V.Local.sEval)
			F.Intrinsic.String.Replace(V.Local.sEval,"[ML]",V.Local.fMatLen,V.Local.sEval)
			F.Intrinsic.String.RegExReplace(V.Local.sEval,"/0","/1",True,True,V.Local.sEval)
			F.Intrinsic.Control.If(V.Local.sEval,<>,"")
				F.Intrinsic.Math.Evaluate(V.Local.sEval,V.Local.fQty1)
			F.Intrinsic.Control.Else
				V.Local.fQty1.Set(0)
			F.Intrinsic.Control.EndIf
			Gui.FormShell.txtLRun.Text(V.Local.fQty1)
			
	F.Intrinsic.Control.EndSelect
F.Intrinsic.Control.Next(V.Local.i)

F.Data.DataView.Close("CrateCalc","Temp")

F.Data.DataView.Create("CrateCalc","Temp",22,"Dim2Form like '*[[]CL[]]*'","")

F.Intrinsic.Control.For(V.Local.i,0,V.Datatable.CrateCalc.RowCount--,1)
	F.Intrinsic.Control.SelectCase(V.Datatable.CrateCalc(V.Local.i).OpCode!FieldValTrim)
		F.Intrinsic.Control.Case("SIDE 1")
			F.Intrinsic.String.Build("Select Length From V_Inventory_Mst2 Where Part = '{0}'",V.Screen.FormShell!ddlSide1Mat.Text,V.Local.sSql)
			F.ODBC.Connection!con.ExecuteAndReturn(V.Local.sSql,V.Local.fMatLen)
			F.Intrinsic.String.Build("Select Width From V_Inventory_Mst2 Where Part = '{0}'",V.Screen.FormShell!ddlSide1Mat.Text,V.Local.sSql)
			F.ODBC.Connection!con.ExecuteAndReturn(V.Local.sSql,V.Local.fMatWid)
			F.Intrinsic.String.Replace(V.Datatable.CrateCalc(V.Local.i).Dim2Form!FieldValTrim,"[CL]",V.Local.fLength,V.Local.sEval)
			F.Intrinsic.String.Replace(V.Local.sEval,"[CW]",V.Local.fWidth,V.Local.sEval)
			F.Intrinsic.String.Replace(V.Local.sEval,"[CH]",V.Local.fHeight,V.Local.sEval)
			F.Intrinsic.String.Replace(V.Local.sEval,"[MW]",V.Local.fMatWid,V.Local.sEval)
			F.Intrinsic.String.Replace(V.Local.sEval,"[ML]",V.Local.fMatLen,V.Local.sEval)
			F.Intrinsic.String.RegExReplace(V.Local.sEval,"/0","/1",True,True,V.Local.sEval)
			F.Intrinsic.Control.If(V.Local.sEval,<>,"")
				F.Intrinsic.Math.Evaluate(V.Local.sEval,V.Local.fQty2)
			F.Intrinsic.Control.Else
				V.Local.fQty2.Set(0)
			F.Intrinsic.Control.EndIf
			Gui.FormShell.txtSide1CutLenDim2.Text(V.Local.fQty2)
			
		F.Intrinsic.Control.Case("SIDE 2")
			F.Intrinsic.String.Build("Select Length From V_Inventory_Mst2 Where Part = '{0}'",V.Screen.FormShell!ddlSide2Mat.Text,V.Local.sSql)
			F.ODBC.Connection!con.ExecuteAndReturn(V.Local.sSql,V.Local.fMatLen)
			F.Intrinsic.String.Build("Select Width From V_Inventory_Mst2 Where Part = '{0}'",V.Screen.FormShell!ddlSide2Mat.Text,V.Local.sSql)
			F.ODBC.Connection!con.ExecuteAndReturn(V.Local.sSql,V.Local.fMatWid)
			F.Intrinsic.String.Replace(V.Datatable.CrateCalc(V.Local.i).Dim2Form!FieldValTrim,"[CL]",V.Local.fLength,V.Local.sEval)
			F.Intrinsic.String.Replace(V.Local.sEval,"[CW]",V.Local.fWidth,V.Local.sEval)
			F.Intrinsic.String.Replace(V.Local.sEval,"[CH]",V.Local.fHeight,V.Local.sEval)
			F.Intrinsic.String.Replace(V.Local.sEval,"[MW]",V.Local.fMatWid,V.Local.sEval)
			F.Intrinsic.String.Replace(V.Local.sEval,"[ML]",V.Local.fMatLen,V.Local.sEval)
			F.Intrinsic.String.RegExReplace(V.Local.sEval,"/0","/1",True,True,V.Local.sEval)
			F.Intrinsic.Control.If(V.Local.sEval,<>,"")
				F.Intrinsic.Math.Evaluate(V.Local.sEval,V.Local.fQty2)
			F.Intrinsic.Control.Else
				V.Local.fQty2.Set(0)
			F.Intrinsic.Control.EndIf
			Gui.FormShell.txtSide2CutLenDim2.Text(V.Local.fQty2)
			
		F.Intrinsic.Control.Case("TOP")
			F.Intrinsic.String.Build("Select Length From V_Inventory_Mst2 Where Part = '{0}'",V.Screen.FormShell!ddlTopMat.Text,V.Local.sSql)
			F.ODBC.Connection!con.ExecuteAndReturn(V.Local.sSql,V.Local.fMatLen)
			F.Intrinsic.String.Build("Select Width From V_Inventory_Mst2 Where Part = '{0}'",V.Screen.FormShell!ddlTopMat.Text,V.Local.sSql)
			F.ODBC.Connection!con.ExecuteAndReturn(V.Local.sSql,V.Local.fMatWid)
			F.Intrinsic.String.Replace(V.Datatable.CrateCalc(V.Local.i).Dim2Form!FieldValTrim,"[CL]",V.Local.fLength,V.Local.sEval)
			F.Intrinsic.String.Replace(V.Local.sEval,"[CW]",V.Local.fWidth,V.Local.sEval)
			F.Intrinsic.String.Replace(V.Local.sEval,"[CH]",V.Local.fHeight,V.Local.sEval)
			F.Intrinsic.String.Replace(V.Local.sEval,"[MW]",V.Local.fMatWid,V.Local.sEval)
			F.Intrinsic.String.Replace(V.Local.sEval,"[ML]",V.Local.fMatLen,V.Local.sEval)
			F.Intrinsic.String.RegExReplace(V.Local.sEval,"/0","/1",True,True,V.Local.sEval)
			F.Intrinsic.Control.If(V.Local.sEval,<>,"")
				F.Intrinsic.Math.Evaluate(V.Local.sEval,V.Local.fQty2)
			F.Intrinsic.Control.Else
				V.Local.fQty2.Set(0)
			F.Intrinsic.Control.EndIf
			Gui.FormShell.txtTopCutLenDim2.Text(V.Local.fQty2)
			
	F.Intrinsic.Control.EndSelect
F.Intrinsic.Control.Next(V.Local.i)

F.Data.DataView.Close("CrateCalc","Temp")

F.ODBC.Connection!Con.Close
	
F.Intrinsic.Control.ExitSub

F.Intrinsic.Control.Label("txtShellLen_LostFocus_Err")
F.Intrinsic.Control.If(V.Ambient.ErrorNumber,<>,0)
	F.Intrinsic.String.Build("Project: GCG_6721_Shell_Crate_Calc.g2u {0}{0}Subroutine: {1}{0}Error Occurred {2} with description {3}",V.Ambient.NewLine,V.Ambient.CurrentSubroutine,V.Ambient.ErrorNumber,V.Ambient.ErrorDescription,V.Local.sError)
	F.Intrinsic.UI.Msgbox(V.Local.sError)
	F.Intrinsic.Control.CallSub(FormShell_UnLoad)
Function.Intrinsic.Control.EndIf
Program.Sub.txtShellLen_LostFocus.End

Program.Sub.txtShellWidth_LostFocus.Start
F.Intrinsic.Control.SetErrorHandler("txtShellWidth_LostFocus_Err")
F.Intrinsic.Control.ClearErrors

V.Local.sError.Declare(String,"")
V.Local.i.Declare(Long,0)
V.Local.sSql.Declare(String,"")
V.Local.sEval.Declare(String,"")
V.Local.fWidth.Declare(Float,0)
V.Local.fHeight.Declare(Float,0)
V.Local.fMatWid.Declare(Float,0)
V.Local.fMatLen.Declare(Float,0)
V.Local.fQty1.Declare(Float,0)
V.Local.fQty2.Declare(Float,0)
V.Local.fTemp1.Declare(Float,0)
V.Local.fLength.Declare(Float,0)
V.Local.bMW1.Declare(Boolean,False)
V.Local.bMW2.Declare(Boolean,False)

V.Local.fHeight.Set(V.Screen.FormShell!txtShellHeight.Text)
V.Local.fLength.Set(V.Screen.FormShell!txtShellLen.Text)
V.Local.fWidth.Set(V.Screen.FormShell!txtShellWidth.Text)

F.ODBC.Connection!Con.OpenCompanyConnection

F.Data.DataView.Create("CrateCalc","Temp",22,"Dim1Qty like '*[[]CW[]]*'","")

F.Intrinsic.Control.For(V.Local.i,0,V.Datatable.CrateCalc.RowCount--,1)
	F.Intrinsic.Control.SelectCase(V.Datatable.CrateCalc(V.Local.i).OpCode!FieldValTrim)
		F.Intrinsic.Control.Case("SIDE 1")
			F.Intrinsic.String.Build("Select Length From V_Inventory_Mst2 Where Part = '{0}'",V.Screen.FormShell!ddlSide1Mat.Text,V.Local.sSql)
			F.ODBC.Connection!con.ExecuteAndReturn(V.Local.sSql,V.Local.fMatLen)
			F.Intrinsic.String.Build("Select Width From V_Inventory_Mst2 Where Part = '{0}'",V.Screen.FormShell!ddlSide1Mat.Text,V.Local.sSql)
			F.ODBC.Connection!con.ExecuteAndReturn(V.Local.sSql,V.Local.fMatWid)
			F.Intrinsic.String.IsInString(V.Datatable.CrateCalc(V.Local.i).Dim1Qty!FieldValTrim,"/[MW]",True,V.Local.bMW1)
			F.Intrinsic.String.Replace(V.Datatable.CrateCalc(V.Local.i).Dim1Qty!FieldValTrim,"[CL]",V.Local.fLength,V.Local.sEval)
			F.Intrinsic.String.Replace(V.Local.sEval,"[CW]",V.Local.fWidth,V.Local.sEval)
			F.Intrinsic.String.Replace(V.Local.sEval,"[CH]",V.Local.fHeight,V.Local.sEval)
			F.Intrinsic.String.Replace(V.Local.sEval,"[MW]",V.Local.fMatWid,V.Local.sEval)
			F.Intrinsic.String.Replace(V.Local.sEval,"[ML]",V.Local.fMatLen,V.Local.sEval)
			F.Intrinsic.String.RegExReplace(V.Local.sEval,"/0","/1",True,True,V.Local.sEval)
			F.Intrinsic.Control.If(V.Local.sEval,<>,"")
				F.Intrinsic.Math.Evaluate(V.Local.sEval,V.Local.fQty1)
			F.Intrinsic.Control.Else
				V.Local.fQty1.Set(0)
			F.Intrinsic.Control.EndIf
			F.Intrinsic.Control.If(V.Local.bMW1)
				F.Intrinsic.Math.Int(V.Local.fQty1,V.Local.fTemp1)
				F.Intrinsic.Control.If(V.Local.fQty1,<,V.Local.fTemp1)
					F.Intrinsic.Math.Sub(V.Local.fTemp1.Long,1,V.Local.fQty1)
				F.Intrinsic.Control.Else
					F.Intrinsic.Math.Add(V.Local.fTemp1.Long,1,V.Local.fQty1)
				F.Intrinsic.Control.EndIf
			F.Intrinsic.Control.EndIf
			Gui.FormShell.txtSide1QtyDim1.Text(V.Local.fQty1)
			
		F.Intrinsic.Control.Case("SIDE 2")
			F.Intrinsic.String.Build("Select Length From V_Inventory_Mst2 Where Part = '{0}'",V.Screen.FormShell!ddlSide2Mat.Text,V.Local.sSql)
			F.ODBC.Connection!con.ExecuteAndReturn(V.Local.sSql,V.Local.fMatLen)
			F.Intrinsic.String.Build("Select Width From V_Inventory_Mst2 Where Part = '{0}'",V.Screen.FormShell!ddlSide2Mat.Text,V.Local.sSql)
			F.ODBC.Connection!con.ExecuteAndReturn(V.Local.sSql,V.Local.fMatWid)
			F.Intrinsic.String.IsInString(V.Datatable.CrateCalc(V.Local.i).Dim1Qty!FieldValTrim,"/[MW]",True,V.Local.bMW1)
			F.Intrinsic.String.Replace(V.Datatable.CrateCalc(V.Local.i).Dim1Qty!FieldValTrim,"[CL]",V.Local.fLength,V.Local.sEval)
			F.Intrinsic.String.Replace(V.Local.sEval,"[CW]",V.Local.fWidth,V.Local.sEval)
			F.Intrinsic.String.Replace(V.Local.sEval,"[CH]",V.Local.fHeight,V.Local.sEval)
			F.Intrinsic.String.Replace(V.Local.sEval,"[MW]",V.Local.fMatWid,V.Local.sEval)
			F.Intrinsic.String.Replace(V.Local.sEval,"[ML]",V.Local.fMatLen,V.Local.sEval)
			F.Intrinsic.String.RegExReplace(V.Local.sEval,"/0","/1",True,True,V.Local.sEval)
			F.Intrinsic.Control.If(V.Local.sEval,<>,"")
				F.Intrinsic.Math.Evaluate(V.Local.sEval,V.Local.fQty1)
			F.Intrinsic.Control.Else
				V.Local.fQty1.Set(0)
			F.Intrinsic.Control.EndIf
			F.Intrinsic.Control.If(V.Local.bMW1)
				F.Intrinsic.Math.Int(V.Local.fQty1,V.Local.fTemp1)
				F.Intrinsic.Control.If(V.Local.fQty1,<,V.Local.fTemp1)
					F.Intrinsic.Math.Sub(V.Local.fTemp1.Long,1,V.Local.fQty1)
				F.Intrinsic.Control.Else
					F.Intrinsic.Math.Add(V.Local.fTemp1.Long,1,V.Local.fQty1)
				F.Intrinsic.Control.EndIf
			F.Intrinsic.Control.EndIf
			Gui.FormShell.txtSide2QtyDim1.Text(V.Local.fQty1)
			
		F.Intrinsic.Control.Case("TOP")
			F.Intrinsic.String.Build("Select Length From V_Inventory_Mst2 Where Part = '{0}'",V.Screen.FormShell!ddlTopMat.Text,V.Local.sSql)
			F.ODBC.Connection!con.ExecuteAndReturn(V.Local.sSql,V.Local.fMatLen)
			F.Intrinsic.String.Build("Select Width From V_Inventory_Mst2 Where Part = '{0}'",V.Screen.FormShell!ddlTopMat.Text,V.Local.sSql)
			F.ODBC.Connection!con.ExecuteAndReturn(V.Local.sSql,V.Local.fMatWid)
			F.Intrinsic.String.IsInString(V.Datatable.CrateCalc(V.Local.i).Dim1Qty!FieldValTrim,"/[MW]",True,V.Local.bMW1)
			F.Intrinsic.String.Replace(V.Datatable.CrateCalc(V.Local.i).Dim1Qty!FieldValTrim,"[CL]",V.Local.fLength,V.Local.sEval)
			F.Intrinsic.String.Replace(V.Local.sEval,"[CW]",V.Local.fWidth,V.Local.sEval)
			F.Intrinsic.String.Replace(V.Local.sEval,"[CH]",V.Local.fHeight,V.Local.sEval)
			F.Intrinsic.String.Replace(V.Local.sEval,"[MW]",V.Local.fMatWid,V.Local.sEval)
			F.Intrinsic.String.Replace(V.Local.sEval,"[ML]",V.Local.fMatLen,V.Local.sEval)
			F.Intrinsic.String.RegExReplace(V.Local.sEval,"/0","/1",True,True,V.Local.sEval)
			F.Intrinsic.Control.If(V.Local.sEval,<>,"")
				F.Intrinsic.Math.Evaluate(V.Local.sEval,V.Local.fQty1)
			F.Intrinsic.Control.Else
				V.Local.fQty1.Set(0)
			F.Intrinsic.Control.EndIf
			F.Intrinsic.Control.If(V.Local.bMW1)
				F.Intrinsic.Math.Int(V.Local.fQty1,V.Local.fTemp1)
				F.Intrinsic.Control.If(V.Local.fQty1,<,V.Local.fTemp1)
					F.Intrinsic.Math.Sub(V.Local.fTemp1.Long,1,V.Local.fQty1)
				F.Intrinsic.Control.Else
					F.Intrinsic.Math.Add(V.Local.fTemp1.Long,1,V.Local.fQty1)
				F.Intrinsic.Control.EndIf
			F.Intrinsic.Control.EndIf
			Gui.FormShell.txtTopQtyDim1.Text(V.Local.fQty1)
			
		F.Intrinsic.Control.Case("T STRG")
			F.Intrinsic.String.Build("Select Length From V_Inventory_Mst2 Where Part = '{0}'",V.Screen.FormShell!ddlTStrgMat.Text,V.Local.sSql)
			F.ODBC.Connection!con.ExecuteAndReturn(V.Local.sSql,V.Local.fMatLen)
			F.Intrinsic.String.Build("Select Width From V_Inventory_Mst2 Where Part = '{0}'",V.Screen.FormShell!ddlTStrgMat.Text,V.Local.sSql)
			F.ODBC.Connection!con.ExecuteAndReturn(V.Local.sSql,V.Local.fMatWid)
			F.Intrinsic.String.IsInString(V.Datatable.CrateCalc(V.Local.i).Dim1Qty!FieldValTrim,"/[MW]",True,V.Local.bMW1)
			F.Intrinsic.String.Replace(V.Datatable.CrateCalc(V.Local.i).Dim1Qty!FieldValTrim,"[CL]",V.Local.fLength,V.Local.sEval)
			F.Intrinsic.String.Replace(V.Local.sEval,"[CW]",V.Local.fWidth,V.Local.sEval)
			F.Intrinsic.String.Replace(V.Local.sEval,"[CH]",V.Local.fHeight,V.Local.sEval)
			F.Intrinsic.String.Replace(V.Local.sEval,"[MW]",V.Local.fMatWid,V.Local.sEval)
			F.Intrinsic.String.Replace(V.Local.sEval,"[ML]",V.Local.fMatLen,V.Local.sEval)
			F.Intrinsic.String.RegExReplace(V.Local.sEval,"/0","/1",True,True,V.Local.sEval)
			F.Intrinsic.Control.If(V.Local.sEval,<>,"")
				F.Intrinsic.Math.Evaluate(V.Local.sEval,V.Local.fQty1)
			F.Intrinsic.Control.Else
				V.Local.fQty1.Set(0)
			F.Intrinsic.Control.EndIf
			F.Intrinsic.Control.If(V.Local.bMW1)
				F.Intrinsic.Math.Int(V.Local.fQty1,V.Local.fTemp1)
				F.Intrinsic.Control.If(V.Local.fQty1,<,V.Local.fTemp1)
					F.Intrinsic.Math.Sub(V.Local.fTemp1.Long,1,V.Local.fQty1)
				F.Intrinsic.Control.Else
					F.Intrinsic.Math.Add(V.Local.fTemp1.Long,1,V.Local.fQty1)
				F.Intrinsic.Control.EndIf
			F.Intrinsic.Control.EndIf
			gui.FormShell.txtTStrgQty.Text(V.Local.fQty1)
			
		F.Intrinsic.Control.Case("B STRG")
			F.Intrinsic.String.Build("Select Length From V_Inventory_Mst2 Where Part = '{0}'",V.Screen.FormShell!ddlBStrg.Text,V.Local.sSql)
			F.ODBC.Connection!con.ExecuteAndReturn(V.Local.sSql,V.Local.fMatLen)
			F.Intrinsic.String.Build("Select Width From V_Inventory_Mst2 Where Part = '{0}'",V.Screen.FormShell!ddlBStrg.Text,V.Local.sSql)
			F.ODBC.Connection!con.ExecuteAndReturn(V.Local.sSql,V.Local.fMatWid)
			F.Intrinsic.String.IsInString(V.Datatable.CrateCalc(V.Local.i).Dim1Qty!FieldValTrim,"/[MW]",True,V.Local.bMW1)
			F.Intrinsic.String.Replace(V.Datatable.CrateCalc(V.Local.i).Dim1Qty!FieldValTrim,"[CL]",V.Local.fLength,V.Local.sEval)
			F.Intrinsic.String.Replace(V.Local.sEval,"[CW]",V.Local.fWidth,V.Local.sEval)
			F.Intrinsic.String.Replace(V.Local.sEval,"[CH]",V.Local.fHeight,V.Local.sEval)
			F.Intrinsic.String.Replace(V.Local.sEval,"[MW]",V.Local.fMatWid,V.Local.sEval)
			F.Intrinsic.String.Replace(V.Local.sEval,"[ML]",V.Local.fMatLen,V.Local.sEval)
			F.Intrinsic.String.RegExReplace(V.Local.sEval,"/0","/1",True,True,V.Local.sEval)
			F.Intrinsic.Control.If(V.Local.sEval,<>,"")
				F.Intrinsic.Math.Evaluate(V.Local.sEval,V.Local.fQty1)
			F.Intrinsic.Control.Else
				V.Local.fQty1.Set(0)
			F.Intrinsic.Control.EndIf
			F.Intrinsic.Control.If(V.Local.bMW1)
				F.Intrinsic.Math.Int(V.Local.fQty1,V.Local.fTemp1)
				F.Intrinsic.Control.If(V.Local.fQty1,<,V.Local.fTemp1)
					F.Intrinsic.Math.Sub(V.Local.fTemp1.Long,1,V.Local.fQty1)
				F.Intrinsic.Control.Else
					F.Intrinsic.Math.Add(V.Local.fTemp1.Long,1,V.Local.fQty1)
				F.Intrinsic.Control.EndIf
			F.Intrinsic.Control.EndIf
			Gui.FormShell.txtBstrgQty.Text(V.Local.fQty1)
			
		F.Intrinsic.Control.Case("RUN")
			F.Intrinsic.String.Build("Select Length From V_Inventory_Mst2 Where Part = '{0}'",V.Screen.FormShell!ddlRunMat.Text,V.Local.sSql)
			F.ODBC.Connection!con.ExecuteAndReturn(V.Local.sSql,V.Local.fMatLen)
			F.Intrinsic.String.Build("Select Width From V_Inventory_Mst2 Where Part = '{0}'",V.Screen.FormShell!ddlRunMat.Text,V.Local.sSql)
			F.ODBC.Connection!con.ExecuteAndReturn(V.Local.sSql,V.Local.fMatWid)
			F.Intrinsic.String.IsInString(V.Datatable.CrateCalc(V.Local.i).Dim1Qty!FieldValTrim,"/[MW]",True,V.Local.bMW1)
			F.Intrinsic.String.Replace(V.Datatable.CrateCalc(V.Local.i).Dim1Qty!FieldValTrim,"[CL]",V.Local.fLength,V.Local.sEval)
			F.Intrinsic.String.Replace(V.Local.sEval,"[CW]",V.Local.fWidth,V.Local.sEval)
			F.Intrinsic.String.Replace(V.Local.sEval,"[CH]",V.Local.fHeight,V.Local.sEval)
			F.Intrinsic.String.Replace(V.Local.sEval,"[MW]",V.Local.fMatWid,V.Local.sEval)
			F.Intrinsic.String.Replace(V.Local.sEval,"[ML]",V.Local.fMatLen,V.Local.sEval)
			F.Intrinsic.String.RegExReplace(V.Local.sEval,"/0","/1",True,True,V.Local.sEval)
			F.Intrinsic.Control.If(V.Local.sEval,<>,"")
				F.Intrinsic.Math.Evaluate(V.Local.sEval,V.Local.fQty1)
			F.Intrinsic.Control.Else
				V.Local.fQty1.Set(0)
			F.Intrinsic.Control.EndIf
			F.Intrinsic.Control.If(V.Local.bMW1)
				F.Intrinsic.Math.Int(V.Local.fQty1,V.Local.fTemp1)
				F.Intrinsic.Control.If(V.Local.fQty1,<,V.Local.fTemp1)
					F.Intrinsic.Math.Sub(V.Local.fTemp1.Long,1,V.Local.fQty1)
				F.Intrinsic.Control.Else
					F.Intrinsic.Math.Add(V.Local.fTemp1.Long,1,V.Local.fQty1)
				F.Intrinsic.Control.EndIf
			F.Intrinsic.Control.EndIf
			Gui.FormShell.txtRunQty.Text(V.Local.fQty1)
			
	F.Intrinsic.Control.EndSelect
F.Intrinsic.Control.Next(V.Local.i)

F.Data.DataView.Close("CrateCalc","Temp")

F.Data.DataView.Create("CrateCalc","Temp",22,"Dim2Qty like '*[[]CW[]]*'","")

F.Intrinsic.Control.For(V.Local.i,0,V.Datatable.CrateCalc.RowCount--,1)
	F.Intrinsic.Control.SelectCase(V.Datatable.CrateCalc(V.Local.i).OpCode!FieldValTrim)
		F.Intrinsic.Control.Case("SIDE 1")
			F.Intrinsic.String.Build("Select Length From V_Inventory_Mst2 Where Part = '{0}'",V.Screen.FormShell!ddlSide1Mat.Text,V.Local.sSql)
			F.ODBC.Connection!con.ExecuteAndReturn(V.Local.sSql,V.Local.fMatLen)
			F.Intrinsic.String.Build("Select Width From V_Inventory_Mst2 Where Part = '{0}'",V.Screen.FormShell!ddlSide1Mat.Text,V.Local.sSql)
			F.ODBC.Connection!con.ExecuteAndReturn(V.Local.sSql,V.Local.fMatWid)
			F.Intrinsic.String.IsInString(V.Datatable.CrateCalc(V.Local.i).Dim2Qty!FieldValTrim,"/[MW]",True,V.Local.bMW2)
			F.Intrinsic.String.Replace(V.Datatable.CrateCalc(V.Local.i).Dim2Qty!FieldValTrim,"[CL]",V.Local.fLength,V.Local.sEval)
			F.Intrinsic.String.Replace(V.Local.sEval,"[CW]",V.Local.fWidth,V.Local.sEval)
			F.Intrinsic.String.Replace(V.Local.sEval,"[CH]",V.Local.fHeight,V.Local.sEval)
			F.Intrinsic.String.Replace(V.Local.sEval,"[MW]",V.Local.fMatWid,V.Local.sEval)
			F.Intrinsic.String.Replace(V.Local.sEval,"[ML]",V.Local.fMatLen,V.Local.sEval)
			F.Intrinsic.String.RegExReplace(V.Local.sEval,"/0","/1",True,True,V.Local.sEval)
			F.Intrinsic.Control.If(V.Local.sEval,<>,"")
				F.Intrinsic.Math.Evaluate(V.Local.sEval,V.Local.fQty2)
			F.Intrinsic.Control.Else
				V.Local.fQty2.Set(0)
			F.Intrinsic.Control.EndIf
			F.Intrinsic.Control.If(V.Local.bMW2)
				F.Intrinsic.Math.Int(V.Local.fQty2,V.Local.fTemp1)
				F.Intrinsic.Control.If(V.Local.fQty2,<,V.Local.fTemp1)
					F.Intrinsic.Math.Sub(V.Local.fTemp1.Long,1,V.Local.fQty2)
				F.Intrinsic.Control.Else
					F.Intrinsic.Math.Add(V.Local.fTemp1.Long,1,V.Local.fQty2)
				F.Intrinsic.Control.EndIf
			F.Intrinsic.Control.EndIf
			Gui.FormShell.txtSide1QtyDim2.Text(V.Local.fQty2)
			
		F.Intrinsic.Control.Case("SIDE 2")
			F.Intrinsic.String.Build("Select Length From V_Inventory_Mst2 Where Part = '{0}'",V.Screen.FormShell!ddlSide2Mat.Text,V.Local.sSql)
			F.ODBC.Connection!con.ExecuteAndReturn(V.Local.sSql,V.Local.fMatLen)
			F.Intrinsic.String.Build("Select Width From V_Inventory_Mst2 Where Part = '{0}'",V.Screen.FormShell!ddlSide2Mat.Text,V.Local.sSql)
			F.ODBC.Connection!con.ExecuteAndReturn(V.Local.sSql,V.Local.fMatWid)
			F.Intrinsic.String.IsInString(V.Datatable.CrateCalc(V.Local.i).Dim2Qty!FieldValTrim,"/[MW]",True,V.Local.bMW1)
			F.Intrinsic.String.Replace(V.Datatable.CrateCalc(V.Local.i).Dim2Qty!FieldValTrim,"[CL]",V.Local.fLength,V.Local.sEval)
			F.Intrinsic.String.Replace(V.Local.sEval,"[CW]",V.Local.fWidth,V.Local.sEval)
			F.Intrinsic.String.Replace(V.Local.sEval,"[CH]",V.Local.fHeight,V.Local.sEval)
			F.Intrinsic.String.Replace(V.Local.sEval,"[MW]",V.Local.fMatWid,V.Local.sEval)
			F.Intrinsic.String.Replace(V.Local.sEval,"[ML]",V.Local.fMatLen,V.Local.sEval)
			F.Intrinsic.String.RegExReplace(V.Local.sEval,"/0","/1",True,True,V.Local.sEval)
			F.Intrinsic.Control.If(V.Local.sEval,<>,"")
				F.Intrinsic.Math.Evaluate(V.Local.sEval,V.Local.fQty2)
			F.Intrinsic.Control.Else
				V.Local.fQty2.Set(0)
			F.Intrinsic.Control.EndIf
			F.Intrinsic.Control.If(V.Local.bMW2)
				F.Intrinsic.Math.Int(V.Local.fQty2,V.Local.fTemp1)
				F.Intrinsic.Control.If(V.Local.fQty2,<,V.Local.fTemp1)
					F.Intrinsic.Math.Sub(V.Local.fTemp1.Long,1,V.Local.fQty2)
				F.Intrinsic.Control.Else
					F.Intrinsic.Math.Add(V.Local.fTemp1.Long,1,V.Local.fQty2)
				F.Intrinsic.Control.EndIf
			F.Intrinsic.Control.EndIf
			Gui.FormShell.txtSide2QtyDim2.Text(V.Local.fQty2)
			
		F.Intrinsic.Control.Case("TOP")
			F.Intrinsic.String.Build("Select Length From V_Inventory_Mst2 Where Part = '{0}'",V.Screen.FormShell!ddlTopMat.Text,V.Local.sSql)
			F.ODBC.Connection!con.ExecuteAndReturn(V.Local.sSql,V.Local.fMatLen)
			F.Intrinsic.String.Build("Select Width From V_Inventory_Mst2 Where Part = '{0}'",V.Screen.FormShell!ddlTopMat.Text,V.Local.sSql)
			F.ODBC.Connection!con.ExecuteAndReturn(V.Local.sSql,V.Local.fMatWid)
			F.Intrinsic.String.IsInString(V.Datatable.CrateCalc(V.Local.i).Dim2Qty!FieldValTrim,"/[MW]",True,V.Local.bMW2)
			F.Intrinsic.String.Replace(V.Datatable.CrateCalc(V.Local.i).Dim2Qty!FieldValTrim,"[CL]",V.Local.fLength,V.Local.sEval)
			F.Intrinsic.String.Replace(V.Local.sEval,"[CW]",V.Local.fWidth,V.Local.sEval)
			F.Intrinsic.String.Replace(V.Local.sEval,"[CH]",V.Local.fHeight,V.Local.sEval)
			F.Intrinsic.String.Replace(V.Local.sEval,"[MW]",V.Local.fMatWid,V.Local.sEval)
			F.Intrinsic.String.Replace(V.Local.sEval,"[ML]",V.Local.fMatLen,V.Local.sEval)
			F.Intrinsic.String.RegExReplace(V.Local.sEval,"/0","/1",True,True,V.Local.sEval)
			F.Intrinsic.Control.If(V.Local.sEval,<>,"")
				F.Intrinsic.Math.Evaluate(V.Local.sEval,V.Local.fQty1)
			F.Intrinsic.Control.Else
				V.Local.fQty2.Set(0)
			F.Intrinsic.Control.EndIf
			F.Intrinsic.Control.If(V.Local.bMW2)
				F.Intrinsic.Math.Int(V.Local.fQty2,V.Local.fTemp1)
				F.Intrinsic.Control.If(V.Local.fQty2,<,V.Local.fTemp1)
					F.Intrinsic.Math.Sub(V.Local.fTemp1.Long,1,V.Local.fQty2)
				F.Intrinsic.Control.Else
					F.Intrinsic.Math.Add(V.Local.fTemp1.Long,1,V.Local.fQty2)
				F.Intrinsic.Control.EndIf
			F.Intrinsic.Control.EndIf
			Gui.FormShell.txtTopQtyDim2.Text(V.Local.fQty2)
			
	F.Intrinsic.Control.EndSelect
F.Intrinsic.Control.Next(V.Local.i)

F.Data.DataView.Close("CrateCalc","Temp")

F.Data.DataView.Create("CrateCalc","Temp",22,"Dim1Form like '*[[]CW[]]*'","")

F.Intrinsic.Control.For(V.Local.i,0,V.Datatable.CrateCalc.RowCount--,1)
	F.Intrinsic.Control.SelectCase(V.Datatable.CrateCalc(V.Local.i).OpCode!FieldValTrim)
		F.Intrinsic.Control.Case("SIDE 1")
			F.Intrinsic.String.Build("Select Length From V_Inventory_Mst2 Where Part = '{0}'",V.Screen.FormShell!ddlSide1Mat.Text,V.Local.sSql)
			F.ODBC.Connection!con.ExecuteAndReturn(V.Local.sSql,V.Local.fMatLen)
			F.Intrinsic.String.Build("Select Width From V_Inventory_Mst2 Where Part = '{0}'",V.Screen.FormShell!ddlSide1Mat.Text,V.Local.sSql)
			F.ODBC.Connection!con.ExecuteAndReturn(V.Local.sSql,V.Local.fMatWid)
			F.Intrinsic.String.Replace(V.Datatable.CrateCalc(V.Local.i).Dim1Form!FieldValTrim,"[CL]",V.Local.fLength,V.Local.sEval)
			F.Intrinsic.String.Replace(V.Local.sEval,"[CW]",V.Local.fWidth,V.Local.sEval)
			F.Intrinsic.String.Replace(V.Local.sEval,"[CH]",V.Local.fHeight,V.Local.sEval)
			F.Intrinsic.String.Replace(V.Local.sEval,"[MW]",V.Local.fMatWid,V.Local.sEval)
			F.Intrinsic.String.Replace(V.Local.sEval,"[ML]",V.Local.fMatLen,V.Local.sEval)
			F.Intrinsic.String.RegExReplace(V.Local.sEval,"/0","/1",True,True,V.Local.sEval)
			F.Intrinsic.Control.If(V.Local.sEval,<>,"")
				F.Intrinsic.Math.Evaluate(V.Local.sEval,V.Local.fQty1)
			F.Intrinsic.Control.Else
				V.Local.fQty1.Set(0)
			F.Intrinsic.Control.EndIf
			Gui.FormShell.txtSide1CutLenDim1.Text(V.Local.fQty1)
			
		F.Intrinsic.Control.Case("SIDE 2")
			F.Intrinsic.String.Build("Select Length From V_Inventory_Mst2 Where Part = '{0}'",V.Screen.FormShell!ddlSide2Mat.Text,V.Local.sSql)
			F.ODBC.Connection!con.ExecuteAndReturn(V.Local.sSql,V.Local.fMatLen)
			F.Intrinsic.String.Build("Select Width From V_Inventory_Mst2 Where Part = '{0}'",V.Screen.FormShell!ddlSide2Mat.Text,V.Local.sSql)
			F.ODBC.Connection!con.ExecuteAndReturn(V.Local.sSql,V.Local.fMatWid)
			F.Intrinsic.String.Replace(V.Datatable.CrateCalc(V.Local.i).Dim1Form!FieldValTrim,"[CL]",V.Local.fLength,V.Local.sEval)
			F.Intrinsic.String.Replace(V.Local.sEval,"[CW]",V.Local.fWidth,V.Local.sEval)
			F.Intrinsic.String.Replace(V.Local.sEval,"[CH]",V.Local.fHeight,V.Local.sEval)
			F.Intrinsic.String.Replace(V.Local.sEval,"[MW]",V.Local.fMatWid,V.Local.sEval)
			F.Intrinsic.String.Replace(V.Local.sEval,"[ML]",V.Local.fMatLen,V.Local.sEval)
			F.Intrinsic.String.RegExReplace(V.Local.sEval,"/0","/1",True,True,V.Local.sEval)
			F.Intrinsic.Control.If(V.Local.sEval,<>,"")
				F.Intrinsic.Math.Evaluate(V.Local.sEval,V.Local.fQty1)
			F.Intrinsic.Control.Else
				V.Local.fQty1.Set(0)
			F.Intrinsic.Control.EndIf
			Gui.FormShell.txtSide2CutLenDim1.Text(V.Local.fQty1)
			
		F.Intrinsic.Control.Case("TOP")
			F.Intrinsic.String.Build("Select Length From V_Inventory_Mst2 Where Part = '{0}'",V.Screen.FormShell!ddlTopMat.Text,V.Local.sSql)
			F.ODBC.Connection!con.ExecuteAndReturn(V.Local.sSql,V.Local.fMatLen)
			F.Intrinsic.String.Build("Select Width From V_Inventory_Mst2 Where Part = '{0}'",V.Screen.FormShell!ddlTopMat.Text,V.Local.sSql)
			F.ODBC.Connection!con.ExecuteAndReturn(V.Local.sSql,V.Local.fMatWid)
			F.Intrinsic.String.Replace(V.Datatable.CrateCalc(V.Local.i).Dim1Form!FieldValTrim,"[CL]",V.Local.fLength,V.Local.sEval)
			F.Intrinsic.String.Replace(V.Local.sEval,"[CW]",V.Local.fWidth,V.Local.sEval)
			F.Intrinsic.String.Replace(V.Local.sEval,"[CH]",V.Local.fHeight,V.Local.sEval)
			F.Intrinsic.String.Replace(V.Local.sEval,"[MW]",V.Local.fMatWid,V.Local.sEval)
			F.Intrinsic.String.Replace(V.Local.sEval,"[ML]",V.Local.fMatLen,V.Local.sEval)
			F.Intrinsic.String.RegExReplace(V.Local.sEval,"/0","/1",True,True,V.Local.sEval)
			F.Intrinsic.Control.If(V.Local.sEval,<>,"")
				F.Intrinsic.Math.Evaluate(V.Local.sEval,V.Local.fQty1)
			F.Intrinsic.Control.Else
				V.Local.fQty1.Set(0)
			F.Intrinsic.Control.EndIf
			Gui.FormShell.txtTopCutLenDim1.Text(V.Local.fQty1)
			
		F.Intrinsic.Control.Case("T STRG")
			F.Intrinsic.String.Build("Select Length From V_Inventory_Mst2 Where Part = '{0}'",V.Screen.FormShell!ddlTStrgMat.Text,V.Local.sSql)
			F.ODBC.Connection!con.ExecuteAndReturn(V.Local.sSql,V.Local.fMatLen)
			F.Intrinsic.String.Build("Select Width From V_Inventory_Mst2 Where Part = '{0}'",V.Screen.FormShell!ddlTStrgMat.Text,V.Local.sSql)
			F.ODBC.Connection!con.ExecuteAndReturn(V.Local.sSql,V.Local.fMatWid)
			F.Intrinsic.String.Replace(V.Datatable.CrateCalc(V.Local.i).Dim1Form!FieldValTrim,"[CL]",V.Local.fLength,V.Local.sEval)
			F.Intrinsic.String.Replace(V.Local.sEval,"[CW]",V.Local.fWidth,V.Local.sEval)
			F.Intrinsic.String.Replace(V.Local.sEval,"[CH]",V.Local.fHeight,V.Local.sEval)
			F.Intrinsic.String.Replace(V.Local.sEval,"[MW]",V.Local.fMatWid,V.Local.sEval)
			F.Intrinsic.String.Replace(V.Local.sEval,"[ML]",V.Local.fMatLen,V.Local.sEval)
			F.Intrinsic.String.RegExReplace(V.Local.sEval,"/0","/1",True,True,V.Local.sEval)
			F.Intrinsic.Control.If(V.Local.sEval,<>,"")
				F.Intrinsic.Math.Evaluate(V.Local.sEval,V.Local.fQty1)
			F.Intrinsic.Control.Else
				V.Local.fQty1.Set(0)
			F.Intrinsic.Control.EndIf
			gui.FormShell.txtTStrg.Text(V.Local.fQty1)
			
		F.Intrinsic.Control.Case("B STRG")
			F.Intrinsic.String.Build("Select Length From V_Inventory_Mst2 Where Part = '{0}'",V.Screen.FormShell!ddlBStrg.Text,V.Local.sSql)
			F.ODBC.Connection!con.ExecuteAndReturn(V.Local.sSql,V.Local.fMatLen)
			F.Intrinsic.String.Build("Select Width From V_Inventory_Mst2 Where Part = '{0}'",V.Screen.FormShell!ddlBStrg.Text,V.Local.sSql)
			F.ODBC.Connection!con.ExecuteAndReturn(V.Local.sSql,V.Local.fMatWid)
			F.Intrinsic.String.Replace(V.Datatable.CrateCalc(V.Local.i).Dim1Form!FieldValTrim,"[CL]",V.Local.fLength,V.Local.sEval)
			F.Intrinsic.String.Replace(V.Local.sEval,"[CW]",V.Local.fWidth,V.Local.sEval)
			F.Intrinsic.String.Replace(V.Local.sEval,"[CH]",V.Local.fHeight,V.Local.sEval)
			F.Intrinsic.String.Replace(V.Local.sEval,"[MW]",V.Local.fMatWid,V.Local.sEval)
			F.Intrinsic.String.Replace(V.Local.sEval,"[ML]",V.Local.fMatLen,V.Local.sEval)
			F.Intrinsic.String.RegExReplace(V.Local.sEval,"/0","/1",True,True,V.Local.sEval)
			F.Intrinsic.Control.If(V.Local.sEval,<>,"")
				F.Intrinsic.Math.Evaluate(V.Local.sEval,V.Local.fQty1)
			F.Intrinsic.Control.Else
				V.Local.fQty1.Set(0)
			F.Intrinsic.Control.EndIf
			Gui.FormShell.txtBStrg.Text(V.Local.fQty1)
			
		F.Intrinsic.Control.Case("RUN")
			F.Intrinsic.String.Build("Select Length From V_Inventory_Mst2 Where Part = '{0}'",V.Screen.FormShell!ddlRunMat.Text,V.Local.sSql)
			F.ODBC.Connection!con.ExecuteAndReturn(V.Local.sSql,V.Local.fMatLen)
			F.Intrinsic.String.Build("Select Width From V_Inventory_Mst2 Where Part = '{0}'",V.Screen.FormShell!ddlRunMat.Text,V.Local.sSql)
			F.ODBC.Connection!con.ExecuteAndReturn(V.Local.sSql,V.Local.fMatWid)
			F.Intrinsic.String.Replace(V.Datatable.CrateCalc(V.Local.i).Dim1Form!FieldValTrim,"[CL]",V.Local.fLength,V.Local.sEval)
			F.Intrinsic.String.Replace(V.Local.sEval,"[CW]",V.Local.fWidth,V.Local.sEval)
			F.Intrinsic.String.Replace(V.Local.sEval,"[CH]",V.Local.fHeight,V.Local.sEval)
			F.Intrinsic.String.Replace(V.Local.sEval,"[MW]",V.Local.fMatWid,V.Local.sEval)
			F.Intrinsic.String.Replace(V.Local.sEval,"[ML]",V.Local.fMatLen,V.Local.sEval)
			F.Intrinsic.String.RegExReplace(V.Local.sEval,"/0","/1",True,True,V.Local.sEval)
			F.Intrinsic.Control.If(V.Local.sEval,<>,"")
				F.Intrinsic.Math.Evaluate(V.Local.sEval,V.Local.fQty1)
			F.Intrinsic.Control.Else
				V.Local.fQty1.Set(0)
			F.Intrinsic.Control.EndIf
			Gui.FormShell.txtLRun.Text(V.Local.fQty1)
			
	F.Intrinsic.Control.EndSelect
F.Intrinsic.Control.Next(V.Local.i)

F.Data.DataView.Close("CrateCalc","Temp")

F.Data.DataView.Create("CrateCalc","Temp",22,"Dim2Form like '*[[]CW[]]*'","")

F.Intrinsic.Control.For(V.Local.i,0,V.Datatable.CrateCalc.RowCount--,1)
	F.Intrinsic.Control.SelectCase(V.Datatable.CrateCalc(V.Local.i).OpCode!FieldValTrim)
		F.Intrinsic.Control.Case("SIDE 1")
			F.Intrinsic.String.Build("Select Length From V_Inventory_Mst2 Where Part = '{0}'",V.Screen.FormShell!ddlSide1Mat.Text,V.Local.sSql)
			F.ODBC.Connection!con.ExecuteAndReturn(V.Local.sSql,V.Local.fMatLen)
			F.Intrinsic.String.Build("Select Width From V_Inventory_Mst2 Where Part = '{0}'",V.Screen.FormShell!ddlSide1Mat.Text,V.Local.sSql)
			F.ODBC.Connection!con.ExecuteAndReturn(V.Local.sSql,V.Local.fMatWid)
			F.Intrinsic.String.Replace(V.Datatable.CrateCalc(V.Local.i).Dim2Form!FieldValTrim,"[CL]",V.Local.fLength,V.Local.sEval)
			F.Intrinsic.String.Replace(V.Local.sEval,"[CW]",V.Local.fWidth,V.Local.sEval)
			F.Intrinsic.String.Replace(V.Local.sEval,"[CH]",V.Local.fHeight,V.Local.sEval)
			F.Intrinsic.String.Replace(V.Local.sEval,"[MW]",V.Local.fMatWid,V.Local.sEval)
			F.Intrinsic.String.Replace(V.Local.sEval,"[ML]",V.Local.fMatLen,V.Local.sEval)
			F.Intrinsic.String.RegExReplace(V.Local.sEval,"/0","/1",True,True,V.Local.sEval)
			F.Intrinsic.Control.If(V.Local.sEval,<>,"")
				F.Intrinsic.Math.Evaluate(V.Local.sEval,V.Local.fQty2)
			F.Intrinsic.Control.Else
				V.Local.fQty2.Set(0)
			F.Intrinsic.Control.EndIf
			Gui.FormShell.txtSide1CutLenDim2.Text(V.Local.fQty2)
			
		F.Intrinsic.Control.Case("SIDE 2")
			F.Intrinsic.String.Build("Select Length From V_Inventory_Mst2 Where Part = '{0}'",V.Screen.FormShell!ddlSide2Mat.Text,V.Local.sSql)
			F.ODBC.Connection!con.ExecuteAndReturn(V.Local.sSql,V.Local.fMatLen)
			F.Intrinsic.String.Build("Select Width From V_Inventory_Mst2 Where Part = '{0}'",V.Screen.FormShell!ddlSide2Mat.Text,V.Local.sSql)
			F.ODBC.Connection!con.ExecuteAndReturn(V.Local.sSql,V.Local.fMatWid)
			F.Intrinsic.String.Replace(V.Datatable.CrateCalc(V.Local.i).Dim2Form!FieldValTrim,"[CL]",V.Local.fLength,V.Local.sEval)
			F.Intrinsic.String.Replace(V.Local.sEval,"[CW]",V.Local.fWidth,V.Local.sEval)
			F.Intrinsic.String.Replace(V.Local.sEval,"[CH]",V.Local.fHeight,V.Local.sEval)
			F.Intrinsic.String.Replace(V.Local.sEval,"[MW]",V.Local.fMatWid,V.Local.sEval)
			F.Intrinsic.String.Replace(V.Local.sEval,"[ML]",V.Local.fMatLen,V.Local.sEval)
			F.Intrinsic.String.RegExReplace(V.Local.sEval,"/0","/1",True,True,V.Local.sEval)
			F.Intrinsic.Control.If(V.Local.sEval,<>,"")
				F.Intrinsic.Math.Evaluate(V.Local.sEval,V.Local.fQty2)
			F.Intrinsic.Control.Else
				V.Local.fQty2.Set(0)
			F.Intrinsic.Control.EndIf
			Gui.FormShell.txtSide2CutLenDim2.Text(V.Local.fQty2)
			
		F.Intrinsic.Control.Case("TOP")
			F.Intrinsic.String.Build("Select Length From V_Inventory_Mst2 Where Part = '{0}'",V.Screen.FormShell!ddlTopMat.Text,V.Local.sSql)
			F.ODBC.Connection!con.ExecuteAndReturn(V.Local.sSql,V.Local.fMatLen)
			F.Intrinsic.String.Build("Select Width From V_Inventory_Mst2 Where Part = '{0}'",V.Screen.FormShell!ddlTopMat.Text,V.Local.sSql)
			F.ODBC.Connection!con.ExecuteAndReturn(V.Local.sSql,V.Local.fMatWid)
			F.Intrinsic.String.Replace(V.Datatable.CrateCalc(V.Local.i).Dim2Form!FieldValTrim,"[CL]",V.Local.fLength,V.Local.sEval)
			F.Intrinsic.String.Replace(V.Local.sEval,"[CW]",V.Local.fWidth,V.Local.sEval)
			F.Intrinsic.String.Replace(V.Local.sEval,"[CH]",V.Local.fHeight,V.Local.sEval)
			F.Intrinsic.String.Replace(V.Local.sEval,"[MW]",V.Local.fMatWid,V.Local.sEval)
			F.Intrinsic.String.Replace(V.Local.sEval,"[ML]",V.Local.fMatLen,V.Local.sEval)
			F.Intrinsic.String.RegExReplace(V.Local.sEval,"/0","/1",True,True,V.Local.sEval)
			F.Intrinsic.Control.If(V.Local.sEval,<>,"")
				F.Intrinsic.Math.Evaluate(V.Local.sEval,V.Local.fQty2)
			F.Intrinsic.Control.Else
				V.Local.fQty2.Set(0)
			F.Intrinsic.Control.EndIf
			Gui.FormShell.txtTopCutLenDim2.Text(V.Local.fQty2)
			
	F.Intrinsic.Control.EndSelect
F.Intrinsic.Control.Next(V.Local.i)

F.Data.DataView.Close("CrateCalc","Temp")

F.ODBC.Connection!Con.Close

F.Intrinsic.Control.ExitSub

F.Intrinsic.Control.Label("txtShellWidth_LostFocus_Err")
F.Intrinsic.Control.If(V.Ambient.ErrorNumber,<>,0)
	F.Intrinsic.String.Build("Project: GCG_6721_Shell_Crate_Calc.g2u {0}{0}Subroutine: {1}{0}Error Occurred {2} with description {3}",V.Ambient.NewLine,V.Ambient.CurrentSubroutine,V.Ambient.ErrorNumber,V.Ambient.ErrorDescription,V.Local.sError)
	F.Intrinsic.UI.Msgbox(V.Local.sError)
	F.Intrinsic.Control.CallSub(FormShell_UnLoad)
Function.Intrinsic.Control.EndIf
Program.Sub.txtShellWidth_LostFocus.End

Program.Sub.txtShellHeight_LostFocus.Start
F.Intrinsic.Control.SetErrorHandler("txtShellHeight_LostFocus_Err")
F.Intrinsic.Control.ClearErrors

V.Local.sError.Declare(String,"")
V.Local.i.Declare(Long,0)
V.Local.sSql.Declare(String,"")
V.Local.sEval.Declare(String,"")
V.Local.fWidth.Declare(Float,0)
V.Local.fHeight.Declare(Float,0)
V.Local.fMatWid.Declare(Float,0)
V.Local.fMatLen.Declare(Float,0)
V.Local.fQty1.Declare(Float,0)
V.Local.fQty2.Declare(Float,0)
V.Local.fTemp1.Declare(Float,0)
V.Local.fLength.Declare(Float,0)
V.Local.bMW1.Declare(Boolean,False)
V.Local.bMW2.Declare(Boolean,False)

V.Local.fHeight.Set(V.Screen.FormShell!txtShellHeight.Text)
V.Local.fLength.Set(V.Screen.FormShell!txtShellLen.Text)
V.Local.fWidth.Set(V.Screen.FormShell!txtShellWidth.Text)

F.ODBC.Connection!Con.OpenCompanyConnection

F.Data.DataView.Create("CrateCalc","Temp",22,"Dim1Qty like '*[[]CH[]]*'","")

F.Intrinsic.Control.For(V.Local.i,0,V.Datatable.CrateCalc.RowCount--,1)
	F.Intrinsic.Control.SelectCase(V.Datatable.CrateCalc(V.Local.i).OpCode!FieldValTrim)
		F.Intrinsic.Control.Case("SIDE 1")
			F.Intrinsic.String.Build("Select Length From V_Inventory_Mst2 Where Part = '{0}'",V.Screen.FormShell!ddlSide1Mat.Text,V.Local.sSql)
			F.ODBC.Connection!con.ExecuteAndReturn(V.Local.sSql,V.Local.fMatLen)
			F.Intrinsic.String.Build("Select Width From V_Inventory_Mst2 Where Part = '{0}'",V.Screen.FormShell!ddlSide1Mat.Text,V.Local.sSql)
			F.ODBC.Connection!con.ExecuteAndReturn(V.Local.sSql,V.Local.fMatWid)
			F.Intrinsic.String.IsInString(V.Datatable.CrateCalc(V.Local.i).Dim1Qty!FieldValTrim,"/[MW]",True,V.Local.bMW1)
			F.Intrinsic.String.Replace(V.Datatable.CrateCalc(V.Local.i).Dim1Qty!FieldValTrim,"[CL]",V.Local.fLength,V.Local.sEval)
			F.Intrinsic.String.Replace(V.Local.sEval,"[CW]",V.Local.fWidth,V.Local.sEval)
			F.Intrinsic.String.Replace(V.Local.sEval,"[CH]",V.Local.fHeight,V.Local.sEval)
			F.Intrinsic.String.Replace(V.Local.sEval,"[MW]",V.Local.fMatWid,V.Local.sEval)
			F.Intrinsic.String.Replace(V.Local.sEval,"[ML]",V.Local.fMatLen,V.Local.sEval)
			F.Intrinsic.String.RegExReplace(V.Local.sEval,"/0","/1",True,True,V.Local.sEval)
			F.Intrinsic.Control.If(V.Local.sEval,<>,"")
				F.Intrinsic.Math.Evaluate(V.Local.sEval,V.Local.fQty1)
			F.Intrinsic.Control.Else
				V.Local.fQty1.Set(0)
			F.Intrinsic.Control.EndIf
			F.Intrinsic.Control.If(V.Local.bMW1)
				F.Intrinsic.Math.Int(V.Local.fQty1,V.Local.fTemp1)
				F.Intrinsic.Control.If(V.Local.fQty1,<,V.Local.fTemp1)
					F.Intrinsic.Math.Sub(V.Local.fTemp1.Long,1,V.Local.fQty1)
				F.Intrinsic.Control.Else
					F.Intrinsic.Math.Add(V.Local.fTemp1.Long,1,V.Local.fQty1)
				F.Intrinsic.Control.EndIf
			F.Intrinsic.Control.EndIf
			Gui.FormShell.txtSide1QtyDim1.Text(V.Local.fQty1)
			
		F.Intrinsic.Control.Case("SIDE 2")
			F.Intrinsic.String.Build("Select Length From V_Inventory_Mst2 Where Part = '{0}'",V.Screen.FormShell!ddlSide2Mat.Text,V.Local.sSql)
			F.ODBC.Connection!con.ExecuteAndReturn(V.Local.sSql,V.Local.fMatLen)
			F.Intrinsic.String.Build("Select Width From V_Inventory_Mst2 Where Part = '{0}'",V.Screen.FormShell!ddlSide2Mat.Text,V.Local.sSql)
			F.ODBC.Connection!con.ExecuteAndReturn(V.Local.sSql,V.Local.fMatWid)
			F.Intrinsic.String.IsInString(V.Datatable.CrateCalc(V.Local.i).Dim1Qty!FieldValTrim,"/[MW]",True,V.Local.bMW1)
			F.Intrinsic.String.Replace(V.Datatable.CrateCalc(V.Local.i).Dim1Qty!FieldValTrim,"[CL]",V.Local.fLength,V.Local.sEval)
			F.Intrinsic.String.Replace(V.Local.sEval,"[CW]",V.Local.fWidth,V.Local.sEval)
			F.Intrinsic.String.Replace(V.Local.sEval,"[CH]",V.Local.fHeight,V.Local.sEval)
			F.Intrinsic.String.Replace(V.Local.sEval,"[MW]",V.Local.fMatWid,V.Local.sEval)
			F.Intrinsic.String.Replace(V.Local.sEval,"[ML]",V.Local.fMatLen,V.Local.sEval)
			F.Intrinsic.String.RegExReplace(V.Local.sEval,"/0","/1",True,True,V.Local.sEval)
			F.Intrinsic.Control.If(V.Local.sEval,<>,"")
				F.Intrinsic.Math.Evaluate(V.Local.sEval,V.Local.fQty1)
			F.Intrinsic.Control.Else
				V.Local.fQty1.Set(0)
			F.Intrinsic.Control.EndIf
			F.Intrinsic.Control.If(V.Local.bMW1)
				F.Intrinsic.Math.Int(V.Local.fQty1,V.Local.fTemp1)
				F.Intrinsic.Control.If(V.Local.fQty1,<,V.Local.fTemp1)
					F.Intrinsic.Math.Sub(V.Local.fTemp1.Long,1,V.Local.fQty1)
				F.Intrinsic.Control.Else
					F.Intrinsic.Math.Add(V.Local.fTemp1.Long,1,V.Local.fQty1)
				F.Intrinsic.Control.EndIf
			F.Intrinsic.Control.EndIf
			Gui.FormShell.txtSide2QtyDim1.Text(V.Local.fQty1)
			
		F.Intrinsic.Control.Case("TOP")
			F.Intrinsic.String.Build("Select Length From V_Inventory_Mst2 Where Part = '{0}'",V.Screen.FormShell!ddlTopMat.Text,V.Local.sSql)
			F.ODBC.Connection!con.ExecuteAndReturn(V.Local.sSql,V.Local.fMatLen)
			F.Intrinsic.String.Build("Select Width From V_Inventory_Mst2 Where Part = '{0}'",V.Screen.FormShell!ddlTopMat.Text,V.Local.sSql)
			F.ODBC.Connection!con.ExecuteAndReturn(V.Local.sSql,V.Local.fMatWid)
			F.Intrinsic.String.IsInString(V.Datatable.CrateCalc(V.Local.i).Dim1Qty!FieldValTrim,"/[MW]",True,V.Local.bMW1)
			F.Intrinsic.String.Replace(V.Datatable.CrateCalc(V.Local.i).Dim1Qty!FieldValTrim,"[CL]",V.Local.fLength,V.Local.sEval)
			F.Intrinsic.String.Replace(V.Local.sEval,"[CW]",V.Local.fWidth,V.Local.sEval)
			F.Intrinsic.String.Replace(V.Local.sEval,"[CH]",V.Local.fHeight,V.Local.sEval)
			F.Intrinsic.String.Replace(V.Local.sEval,"[MW]",V.Local.fMatWid,V.Local.sEval)
			F.Intrinsic.String.Replace(V.Local.sEval,"[ML]",V.Local.fMatLen,V.Local.sEval)
			F.Intrinsic.String.RegExReplace(V.Local.sEval,"/0","/1",True,True,V.Local.sEval)
			F.Intrinsic.Control.If(V.Local.sEval,<>,"")
				F.Intrinsic.Math.Evaluate(V.Local.sEval,V.Local.fQty1)
			F.Intrinsic.Control.Else
				V.Local.fQty1.Set(0)
			F.Intrinsic.Control.EndIf
			F.Intrinsic.Control.If(V.Local.bMW1)
				F.Intrinsic.Math.Int(V.Local.fQty1,V.Local.fTemp1)
				F.Intrinsic.Control.If(V.Local.fQty1,<,V.Local.fTemp1)
					F.Intrinsic.Math.Sub(V.Local.fTemp1.Long,1,V.Local.fQty1)
				F.Intrinsic.Control.Else
					F.Intrinsic.Math.Add(V.Local.fTemp1.Long,1,V.Local.fQty1)
				F.Intrinsic.Control.EndIf
			F.Intrinsic.Control.EndIf
			Gui.FormShell.txtTopQtyDim1.Text(V.Local.fQty1)
			
		F.Intrinsic.Control.Case("T STRG")
			F.Intrinsic.String.Build("Select Length From V_Inventory_Mst2 Where Part = '{0}'",V.Screen.FormShell!ddlTStrgMat.Text,V.Local.sSql)
			F.ODBC.Connection!con.ExecuteAndReturn(V.Local.sSql,V.Local.fMatLen)
			F.Intrinsic.String.Build("Select Width From V_Inventory_Mst2 Where Part = '{0}'",V.Screen.FormShell!ddlTStrgMat.Text,V.Local.sSql)
			F.ODBC.Connection!con.ExecuteAndReturn(V.Local.sSql,V.Local.fMatWid)
			F.Intrinsic.String.IsInString(V.Datatable.CrateCalc(V.Local.i).Dim1Qty!FieldValTrim,"/[MW]",True,V.Local.bMW1)
			F.Intrinsic.String.Replace(V.Datatable.CrateCalc(V.Local.i).Dim1Qty!FieldValTrim,"[CL]",V.Local.fLength,V.Local.sEval)
			F.Intrinsic.String.Replace(V.Local.sEval,"[CW]",V.Local.fWidth,V.Local.sEval)
			F.Intrinsic.String.Replace(V.Local.sEval,"[CH]",V.Local.fHeight,V.Local.sEval)
			F.Intrinsic.String.Replace(V.Local.sEval,"[MW]",V.Local.fMatWid,V.Local.sEval)
			F.Intrinsic.String.Replace(V.Local.sEval,"[ML]",V.Local.fMatLen,V.Local.sEval)
			F.Intrinsic.String.RegExReplace(V.Local.sEval,"/0","/1",True,True,V.Local.sEval)
			F.Intrinsic.Control.If(V.Local.sEval,<>,"")
				F.Intrinsic.Math.Evaluate(V.Local.sEval,V.Local.fQty1)
			F.Intrinsic.Control.Else
				V.Local.fQty1.Set(0)
			F.Intrinsic.Control.EndIf
			F.Intrinsic.Control.If(V.Local.bMW1)
				F.Intrinsic.Math.Int(V.Local.fQty1,V.Local.fTemp1)
				F.Intrinsic.Control.If(V.Local.fQty1,<,V.Local.fTemp1)
					F.Intrinsic.Math.Sub(V.Local.fTemp1.Long,1,V.Local.fQty1)
				F.Intrinsic.Control.Else
					F.Intrinsic.Math.Add(V.Local.fTemp1.Long,1,V.Local.fQty1)
				F.Intrinsic.Control.EndIf
			F.Intrinsic.Control.EndIf
			gui.FormShell.txtTStrgQty.Text(V.Local.fQty1)
			
		F.Intrinsic.Control.Case("B STRG")
			F.Intrinsic.String.Build("Select Length From V_Inventory_Mst2 Where Part = '{0}'",V.Screen.FormShell!ddlBStrg.Text,V.Local.sSql)
			F.ODBC.Connection!con.ExecuteAndReturn(V.Local.sSql,V.Local.fMatLen)
			F.Intrinsic.String.Build("Select Width From V_Inventory_Mst2 Where Part = '{0}'",V.Screen.FormShell!ddlBStrg.Text,V.Local.sSql)
			F.ODBC.Connection!con.ExecuteAndReturn(V.Local.sSql,V.Local.fMatWid)
			F.Intrinsic.String.IsInString(V.Datatable.CrateCalc(V.Local.i).Dim1Qty!FieldValTrim,"/[MW]",True,V.Local.bMW1)
			F.Intrinsic.String.Replace(V.Datatable.CrateCalc(V.Local.i).Dim1Qty!FieldValTrim,"[CL]",V.Local.fLength,V.Local.sEval)
			F.Intrinsic.String.Replace(V.Local.sEval,"[CW]",V.Local.fWidth,V.Local.sEval)
			F.Intrinsic.String.Replace(V.Local.sEval,"[CH]",V.Local.fHeight,V.Local.sEval)
			F.Intrinsic.String.Replace(V.Local.sEval,"[MW]",V.Local.fMatWid,V.Local.sEval)
			F.Intrinsic.String.Replace(V.Local.sEval,"[ML]",V.Local.fMatLen,V.Local.sEval)
			F.Intrinsic.String.RegExReplace(V.Local.sEval,"/0","/1",True,True,V.Local.sEval)
			F.Intrinsic.Control.If(V.Local.sEval,<>,"")
				F.Intrinsic.Math.Evaluate(V.Local.sEval,V.Local.fQty1)
			F.Intrinsic.Control.Else
				V.Local.fQty1.Set(0)
			F.Intrinsic.Control.EndIf
			F.Intrinsic.Control.If(V.Local.bMW1)
				F.Intrinsic.Math.Int(V.Local.fQty1,V.Local.fTemp1)
				F.Intrinsic.Control.If(V.Local.fQty1,<,V.Local.fTemp1)
					F.Intrinsic.Math.Sub(V.Local.fTemp1.Long,1,V.Local.fQty1)
				F.Intrinsic.Control.Else
					F.Intrinsic.Math.Add(V.Local.fTemp1.Long,1,V.Local.fQty1)
				F.Intrinsic.Control.EndIf
			F.Intrinsic.Control.EndIf
			Gui.FormShell.txtBstrgQty.Text(V.Local.fQty1)
			
		F.Intrinsic.Control.Case("RUN")
			F.Intrinsic.String.Build("Select Length From V_Inventory_Mst2 Where Part = '{0}'",V.Screen.FormShell!ddlRunMat.Text,V.Local.sSql)
			F.ODBC.Connection!con.ExecuteAndReturn(V.Local.sSql,V.Local.fMatLen)
			F.Intrinsic.String.Build("Select Width From V_Inventory_Mst2 Where Part = '{0}'",V.Screen.FormShell!ddlRunMat.Text,V.Local.sSql)
			F.ODBC.Connection!con.ExecuteAndReturn(V.Local.sSql,V.Local.fMatWid)
			F.Intrinsic.String.IsInString(V.Datatable.CrateCalc(V.Local.i).Dim1Qty!FieldValTrim,"/[MW]",True,V.Local.bMW1)
			F.Intrinsic.String.Replace(V.Datatable.CrateCalc(V.Local.i).Dim1Qty!FieldValTrim,"[CL]",V.Local.fLength,V.Local.sEval)
			F.Intrinsic.String.Replace(V.Local.sEval,"[CW]",V.Local.fWidth,V.Local.sEval)
			F.Intrinsic.String.Replace(V.Local.sEval,"[CH]",V.Local.fHeight,V.Local.sEval)
			F.Intrinsic.String.Replace(V.Local.sEval,"[MW]",V.Local.fMatWid,V.Local.sEval)
			F.Intrinsic.String.Replace(V.Local.sEval,"[ML]",V.Local.fMatLen,V.Local.sEval)
			F.Intrinsic.String.RegExReplace(V.Local.sEval,"/0","/1",True,True,V.Local.sEval)
			F.Intrinsic.Control.If(V.Local.sEval,<>,"")
				F.Intrinsic.Math.Evaluate(V.Local.sEval,V.Local.fQty1)
			F.Intrinsic.Control.Else
				V.Local.fQty1.Set(0)
			F.Intrinsic.Control.EndIf
			F.Intrinsic.Control.If(V.Local.bMW1)
				F.Intrinsic.Math.Int(V.Local.fQty1,V.Local.fTemp1)
				F.Intrinsic.Control.If(V.Local.fQty1,<,V.Local.fTemp1)
					F.Intrinsic.Math.Sub(V.Local.fTemp1.Long,1,V.Local.fQty1)
				F.Intrinsic.Control.Else
					F.Intrinsic.Math.Add(V.Local.fTemp1.Long,1,V.Local.fQty1)
				F.Intrinsic.Control.EndIf
			F.Intrinsic.Control.EndIf
			Gui.FormShell.txtRunQty.Text(V.Local.fQty1)
			
	F.Intrinsic.Control.EndSelect
F.Intrinsic.Control.Next(V.Local.i)

F.Data.DataView.Close("CrateCalc","Temp")

F.Data.DataView.Create("CrateCalc","Temp",22,"Dim2Qty like '*[[]CH[]]*'","")

F.Intrinsic.Control.For(V.Local.i,0,V.Datatable.CrateCalc.RowCount--,1)
	F.Intrinsic.Control.SelectCase(V.Datatable.CrateCalc(V.Local.i).OpCode!FieldValTrim)
		F.Intrinsic.Control.Case("SIDE 1")
			F.Intrinsic.String.Build("Select Length From V_Inventory_Mst2 Where Part = '{0}'",V.Screen.FormShell!ddlSide1Mat.Text,V.Local.sSql)
			F.ODBC.Connection!con.ExecuteAndReturn(V.Local.sSql,V.Local.fMatLen)
			F.Intrinsic.String.Build("Select Width From V_Inventory_Mst2 Where Part = '{0}'",V.Screen.FormShell!ddlSide1Mat.Text,V.Local.sSql)
			F.ODBC.Connection!con.ExecuteAndReturn(V.Local.sSql,V.Local.fMatWid)
			F.Intrinsic.String.IsInString(V.Datatable.CrateCalc(V.Local.i).Dim2Qty!FieldValTrim,"/[MW]",True,V.Local.bMW2)
			F.Intrinsic.String.Replace(V.Datatable.CrateCalc(V.Local.i).Dim2Qty!FieldValTrim,"[CL]",V.Local.fLength,V.Local.sEval)
			F.Intrinsic.String.Replace(V.Local.sEval,"[CW]",V.Local.fWidth,V.Local.sEval)
			F.Intrinsic.String.Replace(V.Local.sEval,"[CH]",V.Local.fHeight,V.Local.sEval)
			F.Intrinsic.String.Replace(V.Local.sEval,"[MW]",V.Local.fMatWid,V.Local.sEval)
			F.Intrinsic.String.Replace(V.Local.sEval,"[ML]",V.Local.fMatLen,V.Local.sEval)
			F.Intrinsic.String.RegExReplace(V.Local.sEval,"/0","/1",True,True,V.Local.sEval)
			F.Intrinsic.Control.If(V.Local.sEval,<>,"")
				F.Intrinsic.Math.Evaluate(V.Local.sEval,V.Local.fQty2)
			F.Intrinsic.Control.Else
				V.Local.fQty2.Set(0)
			F.Intrinsic.Control.EndIf
			F.Intrinsic.Control.If(V.Local.bMW2)
				F.Intrinsic.Math.Int(V.Local.fQty2,V.Local.fTemp1)
				F.Intrinsic.Control.If(V.Local.fQty2,<,V.Local.fTemp1)
					F.Intrinsic.Math.Sub(V.Local.fTemp1.Long,1,V.Local.fQty2)
				F.Intrinsic.Control.Else
					F.Intrinsic.Math.Add(V.Local.fTemp1.Long,1,V.Local.fQty2)
				F.Intrinsic.Control.EndIf
			F.Intrinsic.Control.EndIf
			Gui.FormShell.txtSide1QtyDim2.Text(V.Local.fQty2)
			
		F.Intrinsic.Control.Case("SIDE 2")
			F.Intrinsic.String.Build("Select Length From V_Inventory_Mst2 Where Part = '{0}'",V.Screen.FormShell!ddlSide2Mat.Text,V.Local.sSql)
			F.ODBC.Connection!con.ExecuteAndReturn(V.Local.sSql,V.Local.fMatLen)
			F.Intrinsic.String.Build("Select Width From V_Inventory_Mst2 Where Part = '{0}'",V.Screen.FormShell!ddlSide2Mat.Text,V.Local.sSql)
			F.ODBC.Connection!con.ExecuteAndReturn(V.Local.sSql,V.Local.fMatWid)
			F.Intrinsic.String.IsInString(V.Datatable.CrateCalc(V.Local.i).Dim2Qty!FieldValTrim,"/[MW]",True,V.Local.bMW1)
			F.Intrinsic.String.Replace(V.Datatable.CrateCalc(V.Local.i).Dim2Qty!FieldValTrim,"[CL]",V.Local.fLength,V.Local.sEval)
			F.Intrinsic.String.Replace(V.Local.sEval,"[CW]",V.Local.fWidth,V.Local.sEval)
			F.Intrinsic.String.Replace(V.Local.sEval,"[CH]",V.Local.fHeight,V.Local.sEval)
			F.Intrinsic.String.Replace(V.Local.sEval,"[MW]",V.Local.fMatWid,V.Local.sEval)
			F.Intrinsic.String.Replace(V.Local.sEval,"[ML]",V.Local.fMatLen,V.Local.sEval)
			F.Intrinsic.String.RegExReplace(V.Local.sEval,"/0","/1",True,True,V.Local.sEval)
			F.Intrinsic.Control.If(V.Local.sEval,<>,"")
				F.Intrinsic.Math.Evaluate(V.Local.sEval,V.Local.fQty2)
			F.Intrinsic.Control.Else
				V.Local.fQty2.Set(0)
			F.Intrinsic.Control.EndIf
			F.Intrinsic.Control.If(V.Local.bMW2)
				F.Intrinsic.Math.Int(V.Local.fQty2,V.Local.fTemp1)
				F.Intrinsic.Control.If(V.Local.fQty2,<,V.Local.fTemp1)
					F.Intrinsic.Math.Sub(V.Local.fTemp1.Long,1,V.Local.fQty2)
				F.Intrinsic.Control.Else
					F.Intrinsic.Math.Add(V.Local.fTemp1.Long,1,V.Local.fQty2)
				F.Intrinsic.Control.EndIf
			F.Intrinsic.Control.EndIf
			Gui.FormShell.txtSide2QtyDim2.Text(V.Local.fQty2)
			
		F.Intrinsic.Control.Case("TOP")
			F.Intrinsic.String.Build("Select Length From V_Inventory_Mst2 Where Part = '{0}'",V.Screen.FormShell!ddlTopMat.Text,V.Local.sSql)
			F.ODBC.Connection!con.ExecuteAndReturn(V.Local.sSql,V.Local.fMatLen)
			F.Intrinsic.String.Build("Select Width From V_Inventory_Mst2 Where Part = '{0}'",V.Screen.FormShell!ddlTopMat.Text,V.Local.sSql)
			F.ODBC.Connection!con.ExecuteAndReturn(V.Local.sSql,V.Local.fMatWid)
			F.Intrinsic.String.IsInString(V.Datatable.CrateCalc(V.Local.i).Dim2Qty!FieldValTrim,"/[MW]",True,V.Local.bMW2)
			F.Intrinsic.String.Replace(V.Datatable.CrateCalc(V.Local.i).Dim2Qty!FieldValTrim,"[CL]",V.Local.fLength,V.Local.sEval)
			F.Intrinsic.String.Replace(V.Local.sEval,"[CW]",V.Local.fWidth,V.Local.sEval)
			F.Intrinsic.String.Replace(V.Local.sEval,"[CH]",V.Local.fHeight,V.Local.sEval)
			F.Intrinsic.String.Replace(V.Local.sEval,"[MW]",V.Local.fMatWid,V.Local.sEval)
			F.Intrinsic.String.Replace(V.Local.sEval,"[ML]",V.Local.fMatLen,V.Local.sEval)
			F.Intrinsic.String.RegExReplace(V.Local.sEval,"/0","/1",True,True,V.Local.sEval)
			F.Intrinsic.Control.If(V.Local.sEval,<>,"")
				F.Intrinsic.Math.Evaluate(V.Local.sEval,V.Local.fQty1)
			F.Intrinsic.Control.Else
				V.Local.fQty2.Set(0)
			F.Intrinsic.Control.EndIf
			F.Intrinsic.Control.If(V.Local.bMW2)
				F.Intrinsic.Math.Int(V.Local.fQty2,V.Local.fTemp1)
				F.Intrinsic.Control.If(V.Local.fQty2,<,V.Local.fTemp1)
					F.Intrinsic.Math.Sub(V.Local.fTemp1.Long,1,V.Local.fQty2)
				F.Intrinsic.Control.Else
					F.Intrinsic.Math.Add(V.Local.fTemp1.Long,1,V.Local.fQty2)
				F.Intrinsic.Control.EndIf
			F.Intrinsic.Control.EndIf
			Gui.FormShell.txtTopQtyDim2.Text(V.Local.fQty2)
			
	F.Intrinsic.Control.EndSelect
F.Intrinsic.Control.Next(V.Local.i)

F.Data.DataView.Close("CrateCalc","Temp")

F.Data.DataView.Create("CrateCalc","Temp",22,"Dim1Form like '*[[]CH[]]*'","")

F.Intrinsic.Control.For(V.Local.i,0,V.Datatable.CrateCalc.RowCount--,1)
	F.Intrinsic.Control.SelectCase(V.Datatable.CrateCalc(V.Local.i).OpCode!FieldValTrim)
		F.Intrinsic.Control.Case("SIDE 1")
			F.Intrinsic.String.Build("Select Length From V_Inventory_Mst2 Where Part = '{0}'",V.Screen.FormShell!ddlSide1Mat.Text,V.Local.sSql)
			F.ODBC.Connection!con.ExecuteAndReturn(V.Local.sSql,V.Local.fMatLen)
			F.Intrinsic.String.Build("Select Width From V_Inventory_Mst2 Where Part = '{0}'",V.Screen.FormShell!ddlSide1Mat.Text,V.Local.sSql)
			F.ODBC.Connection!con.ExecuteAndReturn(V.Local.sSql,V.Local.fMatWid)
			F.Intrinsic.String.Replace(V.Datatable.CrateCalc(V.Local.i).Dim1Form!FieldValTrim,"[CL]",V.Local.fLength,V.Local.sEval)
			F.Intrinsic.String.Replace(V.Local.sEval,"[CW]",V.Local.fWidth,V.Local.sEval)
			F.Intrinsic.String.Replace(V.Local.sEval,"[CH]",V.Local.fHeight,V.Local.sEval)
			F.Intrinsic.String.Replace(V.Local.sEval,"[MW]",V.Local.fMatWid,V.Local.sEval)
			F.Intrinsic.String.Replace(V.Local.sEval,"[ML]",V.Local.fMatLen,V.Local.sEval)
			F.Intrinsic.String.RegExReplace(V.Local.sEval,"/0","/1",True,True,V.Local.sEval)
			F.Intrinsic.Control.If(V.Local.sEval,<>,"")
				F.Intrinsic.Math.Evaluate(V.Local.sEval,V.Local.fQty1)
			F.Intrinsic.Control.Else
				V.Local.fQty1.Set(0)
			F.Intrinsic.Control.EndIf
			Gui.FormShell.txtSide1CutLenDim1.Text(V.Local.fQty1)
			
		F.Intrinsic.Control.Case("SIDE 2")
			F.Intrinsic.String.Build("Select Length From V_Inventory_Mst2 Where Part = '{0}'",V.Screen.FormShell!ddlSide2Mat.Text,V.Local.sSql)
			F.ODBC.Connection!con.ExecuteAndReturn(V.Local.sSql,V.Local.fMatLen)
			F.Intrinsic.String.Build("Select Width From V_Inventory_Mst2 Where Part = '{0}'",V.Screen.FormShell!ddlSide2Mat.Text,V.Local.sSql)
			F.ODBC.Connection!con.ExecuteAndReturn(V.Local.sSql,V.Local.fMatWid)
			F.Intrinsic.String.Replace(V.Datatable.CrateCalc(V.Local.i).Dim1Form!FieldValTrim,"[CL]",V.Local.fLength,V.Local.sEval)
			F.Intrinsic.String.Replace(V.Local.sEval,"[CW]",V.Local.fWidth,V.Local.sEval)
			F.Intrinsic.String.Replace(V.Local.sEval,"[CH]",V.Local.fHeight,V.Local.sEval)
			F.Intrinsic.String.Replace(V.Local.sEval,"[MW]",V.Local.fMatWid,V.Local.sEval)
			F.Intrinsic.String.Replace(V.Local.sEval,"[ML]",V.Local.fMatLen,V.Local.sEval)
			F.Intrinsic.String.RegExReplace(V.Local.sEval,"/0","/1",True,True,V.Local.sEval)
			F.Intrinsic.Control.If(V.Local.sEval,<>,"")
				F.Intrinsic.Math.Evaluate(V.Local.sEval,V.Local.fQty1)
			F.Intrinsic.Control.Else
				V.Local.fQty1.Set(0)
			F.Intrinsic.Control.EndIf
			Gui.FormShell.txtSide2CutLenDim1.Text(V.Local.fQty1)
			
		F.Intrinsic.Control.Case("TOP")
			F.Intrinsic.String.Build("Select Length From V_Inventory_Mst2 Where Part = '{0}'",V.Screen.FormShell!ddlTopMat.Text,V.Local.sSql)
			F.ODBC.Connection!con.ExecuteAndReturn(V.Local.sSql,V.Local.fMatLen)
			F.Intrinsic.String.Build("Select Width From V_Inventory_Mst2 Where Part = '{0}'",V.Screen.FormShell!ddlTopMat.Text,V.Local.sSql)
			F.ODBC.Connection!con.ExecuteAndReturn(V.Local.sSql,V.Local.fMatWid)
			F.Intrinsic.String.Replace(V.Datatable.CrateCalc(V.Local.i).Dim1Form!FieldValTrim,"[CL]",V.Local.fLength,V.Local.sEval)
			F.Intrinsic.String.Replace(V.Local.sEval,"[CW]",V.Local.fWidth,V.Local.sEval)
			F.Intrinsic.String.Replace(V.Local.sEval,"[CH]",V.Local.fHeight,V.Local.sEval)
			F.Intrinsic.String.Replace(V.Local.sEval,"[MW]",V.Local.fMatWid,V.Local.sEval)
			F.Intrinsic.String.Replace(V.Local.sEval,"[ML]",V.Local.fMatLen,V.Local.sEval)
			F.Intrinsic.String.RegExReplace(V.Local.sEval,"/0","/1",True,True,V.Local.sEval)
			F.Intrinsic.Control.If(V.Local.sEval,<>,"")
				F.Intrinsic.Math.Evaluate(V.Local.sEval,V.Local.fQty1)
			F.Intrinsic.Control.Else
				V.Local.fQty1.Set(0)
			F.Intrinsic.Control.EndIf
			Gui.FormShell.txtTopCutLenDim1.Text(V.Local.fQty1)
			
		F.Intrinsic.Control.Case("T STRG")
			F.Intrinsic.String.Build("Select Length From V_Inventory_Mst2 Where Part = '{0}'",V.Screen.FormShell!ddlTStrgMat.Text,V.Local.sSql)
			F.ODBC.Connection!con.ExecuteAndReturn(V.Local.sSql,V.Local.fMatLen)
			F.Intrinsic.String.Build("Select Width From V_Inventory_Mst2 Where Part = '{0}'",V.Screen.FormShell!ddlTStrgMat.Text,V.Local.sSql)
			F.ODBC.Connection!con.ExecuteAndReturn(V.Local.sSql,V.Local.fMatWid)
			F.Intrinsic.String.Replace(V.Datatable.CrateCalc(V.Local.i).Dim1Form!FieldValTrim,"[CL]",V.Local.fLength,V.Local.sEval)
			F.Intrinsic.String.Replace(V.Local.sEval,"[CW]",V.Local.fWidth,V.Local.sEval)
			F.Intrinsic.String.Replace(V.Local.sEval,"[CH]",V.Local.fHeight,V.Local.sEval)
			F.Intrinsic.String.Replace(V.Local.sEval,"[MW]",V.Local.fMatWid,V.Local.sEval)
			F.Intrinsic.String.Replace(V.Local.sEval,"[ML]",V.Local.fMatLen,V.Local.sEval)
			F.Intrinsic.String.RegExReplace(V.Local.sEval,"/0","/1",True,True,V.Local.sEval)
			F.Intrinsic.Control.If(V.Local.sEval,<>,"")
				F.Intrinsic.Math.Evaluate(V.Local.sEval,V.Local.fQty1)
			F.Intrinsic.Control.Else
				V.Local.fQty1.Set(0)
			F.Intrinsic.Control.EndIf
			gui.FormShell.txtTStrg.Text(V.Local.fQty1)
			
		F.Intrinsic.Control.Case("B STRG")
			F.Intrinsic.String.Build("Select Length From V_Inventory_Mst2 Where Part = '{0}'",V.Screen.FormShell!ddlBStrg.Text,V.Local.sSql)
			F.ODBC.Connection!con.ExecuteAndReturn(V.Local.sSql,V.Local.fMatLen)
			F.Intrinsic.String.Build("Select Width From V_Inventory_Mst2 Where Part = '{0}'",V.Screen.FormShell!ddlBStrg.Text,V.Local.sSql)
			F.ODBC.Connection!con.ExecuteAndReturn(V.Local.sSql,V.Local.fMatWid)
			F.Intrinsic.String.Replace(V.Datatable.CrateCalc(V.Local.i).Dim1Form!FieldValTrim,"[CL]",V.Local.fLength,V.Local.sEval)
			F.Intrinsic.String.Replace(V.Local.sEval,"[CW]",V.Local.fWidth,V.Local.sEval)
			F.Intrinsic.String.Replace(V.Local.sEval,"[CH]",V.Local.fHeight,V.Local.sEval)
			F.Intrinsic.String.Replace(V.Local.sEval,"[MW]",V.Local.fMatWid,V.Local.sEval)
			F.Intrinsic.String.Replace(V.Local.sEval,"[ML]",V.Local.fMatLen,V.Local.sEval)
			F.Intrinsic.String.RegExReplace(V.Local.sEval,"/0","/1",True,True,V.Local.sEval)
			F.Intrinsic.Control.If(V.Local.sEval,<>,"")
				F.Intrinsic.Math.Evaluate(V.Local.sEval,V.Local.fQty1)
			F.Intrinsic.Control.Else
				V.Local.fQty1.Set(0)
			F.Intrinsic.Control.EndIf
			Gui.FormShell.txtBStrg.Text(V.Local.fQty1)
			
		F.Intrinsic.Control.Case("RUN")
			F.Intrinsic.String.Build("Select Length From V_Inventory_Mst2 Where Part = '{0}'",V.Screen.FormShell!ddlRunMat.Text,V.Local.sSql)
			F.ODBC.Connection!con.ExecuteAndReturn(V.Local.sSql,V.Local.fMatLen)
			F.Intrinsic.String.Build("Select Width From V_Inventory_Mst2 Where Part = '{0}'",V.Screen.FormShell!ddlRunMat.Text,V.Local.sSql)
			F.ODBC.Connection!con.ExecuteAndReturn(V.Local.sSql,V.Local.fMatWid)
			F.Intrinsic.String.Replace(V.Datatable.CrateCalc(V.Local.i).Dim1Form!FieldValTrim,"[CL]",V.Local.fLength,V.Local.sEval)
			F.Intrinsic.String.Replace(V.Local.sEval,"[CW]",V.Local.fWidth,V.Local.sEval)
			F.Intrinsic.String.Replace(V.Local.sEval,"[CH]",V.Local.fHeight,V.Local.sEval)
			F.Intrinsic.String.Replace(V.Local.sEval,"[MW]",V.Local.fMatWid,V.Local.sEval)
			F.Intrinsic.String.Replace(V.Local.sEval,"[ML]",V.Local.fMatLen,V.Local.sEval)
			F.Intrinsic.String.RegExReplace(V.Local.sEval,"/0","/1",True,True,V.Local.sEval)
			F.Intrinsic.Control.If(V.Local.sEval,<>,"")
				F.Intrinsic.Math.Evaluate(V.Local.sEval,V.Local.fQty1)
			F.Intrinsic.Control.Else
				V.Local.fQty1.Set(0)
			F.Intrinsic.Control.EndIf
			Gui.FormShell.txtLRun.Text(V.Local.fQty1)
			
	F.Intrinsic.Control.EndSelect
F.Intrinsic.Control.Next(V.Local.i)

F.Data.DataView.Close("CrateCalc","Temp")

F.Data.DataView.Create("CrateCalc","Temp",22,"Dim2Form like '*[[]CH[]]*'","")

F.Intrinsic.Control.For(V.Local.i,0,V.Datatable.CrateCalc.RowCount--,1)
	F.Intrinsic.Control.SelectCase(V.Datatable.CrateCalc(V.Local.i).OpCode!FieldValTrim)
		F.Intrinsic.Control.Case("SIDE 1")
			F.Intrinsic.String.Build("Select Length From V_Inventory_Mst2 Where Part = '{0}'",V.Screen.FormShell!ddlSide1Mat.Text,V.Local.sSql)
			F.ODBC.Connection!con.ExecuteAndReturn(V.Local.sSql,V.Local.fMatLen)
			F.Intrinsic.String.Build("Select Width From V_Inventory_Mst2 Where Part = '{0}'",V.Screen.FormShell!ddlSide1Mat.Text,V.Local.sSql)
			F.ODBC.Connection!con.ExecuteAndReturn(V.Local.sSql,V.Local.fMatWid)
			F.Intrinsic.String.Replace(V.Datatable.CrateCalc(V.Local.i).Dim2Form!FieldValTrim,"[CL]",V.Local.fLength,V.Local.sEval)
			F.Intrinsic.String.Replace(V.Local.sEval,"[CW]",V.Local.fWidth,V.Local.sEval)
			F.Intrinsic.String.Replace(V.Local.sEval,"[CH]",V.Local.fHeight,V.Local.sEval)
			F.Intrinsic.String.Replace(V.Local.sEval,"[MW]",V.Local.fMatWid,V.Local.sEval)
			F.Intrinsic.String.Replace(V.Local.sEval,"[ML]",V.Local.fMatLen,V.Local.sEval)
			F.Intrinsic.String.RegExReplace(V.Local.sEval,"/0","/1",True,True,V.Local.sEval)
			F.Intrinsic.Control.If(V.Local.sEval,<>,"")
				F.Intrinsic.Math.Evaluate(V.Local.sEval,V.Local.fQty2)
			F.Intrinsic.Control.Else
				V.Local.fQty2.Set(0)
			F.Intrinsic.Control.EndIf
			Gui.FormShell.txtSide1CutLenDim2.Text(V.Local.fQty2)
			
		F.Intrinsic.Control.Case("SIDE 2")
			F.Intrinsic.String.Build("Select Length From V_Inventory_Mst2 Where Part = '{0}'",V.Screen.FormShell!ddlSide2Mat.Text,V.Local.sSql)
			F.ODBC.Connection!con.ExecuteAndReturn(V.Local.sSql,V.Local.fMatLen)
			F.Intrinsic.String.Build("Select Width From V_Inventory_Mst2 Where Part = '{0}'",V.Screen.FormShell!ddlSide2Mat.Text,V.Local.sSql)
			F.ODBC.Connection!con.ExecuteAndReturn(V.Local.sSql,V.Local.fMatWid)
			F.Intrinsic.String.Replace(V.Datatable.CrateCalc(V.Local.i).Dim2Form!FieldValTrim,"[CL]",V.Local.fLength,V.Local.sEval)
			F.Intrinsic.String.Replace(V.Local.sEval,"[CW]",V.Local.fWidth,V.Local.sEval)
			F.Intrinsic.String.Replace(V.Local.sEval,"[CH]",V.Local.fHeight,V.Local.sEval)
			F.Intrinsic.String.Replace(V.Local.sEval,"[MW]",V.Local.fMatWid,V.Local.sEval)
			F.Intrinsic.String.Replace(V.Local.sEval,"[ML]",V.Local.fMatLen,V.Local.sEval)
			F.Intrinsic.String.RegExReplace(V.Local.sEval,"/0","/1",True,True,V.Local.sEval)
			F.Intrinsic.Control.If(V.Local.sEval,<>,"")
				F.Intrinsic.Math.Evaluate(V.Local.sEval,V.Local.fQty2)
			F.Intrinsic.Control.Else
				V.Local.fQty2.Set(0)
			F.Intrinsic.Control.EndIf
			Gui.FormShell.txtSide2CutLenDim2.Text(V.Local.fQty2)
			
		F.Intrinsic.Control.Case("TOP")
			F.Intrinsic.String.Build("Select Length From V_Inventory_Mst2 Where Part = '{0}'",V.Screen.FormShell!ddlTopMat.Text,V.Local.sSql)
			F.ODBC.Connection!con.ExecuteAndReturn(V.Local.sSql,V.Local.fMatLen)
			F.Intrinsic.String.Build("Select Width From V_Inventory_Mst2 Where Part = '{0}'",V.Screen.FormShell!ddlTopMat.Text,V.Local.sSql)
			F.ODBC.Connection!con.ExecuteAndReturn(V.Local.sSql,V.Local.fMatWid)
			F.Intrinsic.String.Replace(V.Datatable.CrateCalc(V.Local.i).Dim2Form!FieldValTrim,"[CL]",V.Local.fLength,V.Local.sEval)
			F.Intrinsic.String.Replace(V.Local.sEval,"[CW]",V.Local.fWidth,V.Local.sEval)
			F.Intrinsic.String.Replace(V.Local.sEval,"[CH]",V.Local.fHeight,V.Local.sEval)
			F.Intrinsic.String.Replace(V.Local.sEval,"[MW]",V.Local.fMatWid,V.Local.sEval)
			F.Intrinsic.String.Replace(V.Local.sEval,"[ML]",V.Local.fMatLen,V.Local.sEval)
			F.Intrinsic.String.RegExReplace(V.Local.sEval,"/0","/1",True,True,V.Local.sEval)
			F.Intrinsic.Control.If(V.Local.sEval,<>,"")
				F.Intrinsic.Math.Evaluate(V.Local.sEval,V.Local.fQty2)
			F.Intrinsic.Control.Else
				V.Local.fQty2.Set(0)
			F.Intrinsic.Control.EndIf
			Gui.FormShell.txtTopCutLenDim2.Text(V.Local.fQty2)
			
	F.Intrinsic.Control.EndSelect
F.Intrinsic.Control.Next(V.Local.i)

F.Data.DataView.Close("CrateCalc","Temp")

F.ODBC.Connection!Con.Close

F.Intrinsic.Control.ExitSub

F.Intrinsic.Control.Label("txtShellHeight_LostFocus_Err")
F.Intrinsic.Control.If(V.Ambient.ErrorNumber,<>,0)
	F.Intrinsic.String.Build("Project: GCG_6721_Shell_Crate_Calc.g2u {0}{0}Subroutine: {1}{0}Error Occurred {2} with description {3}",V.Ambient.NewLine,V.Ambient.CurrentSubroutine,V.Ambient.ErrorNumber,V.Ambient.ErrorDescription,V.Local.sError)
	F.Intrinsic.UI.Msgbox(V.Local.sError)
	F.Intrinsic.Control.CallSub(FormShell_UnLoad)
Function.Intrinsic.Control.EndIf
Program.Sub.txtShellHeight_LostFocus.End

Program.Sub.txtTStrg_GotFocus.Start
F.Intrinsic.Control.SetErrorHandler("txtTStrg_GotFocus_Err")
F.Intrinsic.Control.ClearErrors

V.Local.sError.Declare(String,"")

Gui.FormShell.txtTStrg.SelectAll

F.Intrinsic.Control.ExitSub

F.Intrinsic.Control.Label("txtTStrg_GotFocus_Err")
F.Intrinsic.Control.If(V.Ambient.ErrorNumber,<>,0)
	F.Intrinsic.String.Build("Project: GCG_6721_Shell_Crate_Calc.g2u {0}{0}Subroutine: {1}{0}Error Occurred {2} with description {3}",V.Ambient.NewLine,V.Ambient.CurrentSubroutine,V.Ambient.ErrorNumber,V.Ambient.ErrorDescription,V.Local.sError)
	F.Intrinsic.UI.Msgbox(V.Local.sError)
	F.Intrinsic.Control.CallSub(FormShell_UnLoad)
Function.Intrinsic.Control.EndIf
Program.Sub.txtTStrg_GotFocus.End

Program.Sub.txtTStrgQty_GotFocus.Start
F.Intrinsic.Control.SetErrorHandler("txtTStrgQty_GotFocus_Err")
F.Intrinsic.Control.ClearErrors

V.Local.sError.Declare(String,"")

Gui.FormShell.txtTStrgQty.SelectAll

F.Intrinsic.Control.ExitSub

F.Intrinsic.Control.Label("txtTStrgQty_GotFocus_Err")
F.Intrinsic.Control.If(V.Ambient.ErrorNumber,<>,0)
	F.Intrinsic.String.Build("Project: GCG_6721_Shell_Crate_Calc.g2u {0}{0}Subroutine: {1}{0}Error Occurred {2} with description {3}",V.Ambient.NewLine,V.Ambient.CurrentSubroutine,V.Ambient.ErrorNumber,V.Ambient.ErrorDescription,V.Local.sError)
	F.Intrinsic.UI.Msgbox(V.Local.sError)
	F.Intrinsic.Control.CallSub(FormShell_UnLoad)
Function.Intrinsic.Control.EndIf
Program.Sub.txtTStrgQty_GotFocus.End

Program.Sub.txtBStrg_GotFocus.Start
F.Intrinsic.Control.SetErrorHandler("txtBStrg_GotFocus_Err")
F.Intrinsic.Control.ClearErrors

V.Local.sError.Declare(String,"")

Gui.FormShell.txtBStrg.SelectAll

F.Intrinsic.Control.ExitSub

F.Intrinsic.Control.Label("txtBStrg_GotFocus_Err")
F.Intrinsic.Control.If(V.Ambient.ErrorNumber,<>,0)
	F.Intrinsic.String.Build("Project: GCG_6721_Shell_Crate_Calc.g2u {0}{0}Subroutine: {1}{0}Error Occurred {2} with description {3}",V.Ambient.NewLine,V.Ambient.CurrentSubroutine,V.Ambient.ErrorNumber,V.Ambient.ErrorDescription,V.Local.sError)
	F.Intrinsic.UI.Msgbox(V.Local.sError)
	F.Intrinsic.Control.CallSub(FormShell_UnLoad)
Function.Intrinsic.Control.EndIf
Program.Sub.txtBStrg_GotFocus.End

Program.Sub.txtBstrgQty_GotFocus.Start
F.Intrinsic.Control.SetErrorHandler("txtBstrgQty_GotFocus_Err")
F.Intrinsic.Control.ClearErrors

V.Local.sError.Declare(String,"")

Gui.FormShell.txtBstrgQty.SelectAll

F.Intrinsic.Control.ExitSub

F.Intrinsic.Control.Label("txtBstrgQty_GotFocus_Err")
F.Intrinsic.Control.If(V.Ambient.ErrorNumber,<>,0)
	F.Intrinsic.String.Build("Project: GCG_6721_Shell_Crate_Calc.g2u {0}{0}Subroutine: {1}{0}Error Occurred {2} with description {3}",V.Ambient.NewLine,V.Ambient.CurrentSubroutine,V.Ambient.ErrorNumber,V.Ambient.ErrorDescription,V.Local.sError)
	F.Intrinsic.UI.Msgbox(V.Local.sError)
	F.Intrinsic.Control.CallSub(FormShell_UnLoad)
Function.Intrinsic.Control.EndIf
Program.Sub.txtBstrgQty_GotFocus.End

Program.Sub.txtLRun_GotFocus.Start
F.Intrinsic.Control.SetErrorHandler("txtLRun_GotFocus_Err")
F.Intrinsic.Control.ClearErrors

V.Local.sError.Declare(String,"")

Gui.FormShell.txtLRun.SelectAll

F.Intrinsic.Control.ExitSub

F.Intrinsic.Control.Label("txtLRun_GotFocus_Err")
F.Intrinsic.Control.If(V.Ambient.ErrorNumber,<>,0)
	F.Intrinsic.String.Build("Project: GCG_6721_Shell_Crate_Calc.g2u {0}{0}Subroutine: {1}{0}Error Occurred {2} with description {3}",V.Ambient.NewLine,V.Ambient.CurrentSubroutine,V.Ambient.ErrorNumber,V.Ambient.ErrorDescription,V.Local.sError)
	F.Intrinsic.UI.Msgbox(V.Local.sError)
	F.Intrinsic.Control.CallSub(FormShell_UnLoad)
Function.Intrinsic.Control.EndIf
Program.Sub.txtLRun_GotFocus.End

Program.Sub.txtRunQty_GotFocus.Start
F.Intrinsic.Control.SetErrorHandler("txtRunQty_GotFocus_Err")
F.Intrinsic.Control.ClearErrors

V.Local.sError.Declare(String,"")

Gui.FormShell.txtRunQty.SelectAll

F.Intrinsic.Control.ExitSub

F.Intrinsic.Control.Label("txtRunQty_GotFocus_Err")
F.Intrinsic.Control.If(V.Ambient.ErrorNumber,<>,0)
	F.Intrinsic.String.Build("Project: GCG_6721_Shell_Crate_Calc.g2u {0}{0}Subroutine: {1}{0}Error Occurred {2} with description {3}",V.Ambient.NewLine,V.Ambient.CurrentSubroutine,V.Ambient.ErrorNumber,V.Ambient.ErrorDescription,V.Local.sError)
	F.Intrinsic.UI.Msgbox(V.Local.sError)
	F.Intrinsic.Control.CallSub(FormShell_UnLoad)
Function.Intrinsic.Control.EndIf
Program.Sub.txtRunQty_GotFocus.End

Program.Sub.txtSide1QtyDim1_GotFocus.Start
F.Intrinsic.Control.SetErrorHandler("txtSide1QtyDim1_GotFocus_Err")
F.Intrinsic.Control.ClearErrors

V.Local.sError.Declare(String,"")

Gui.FormShell.txtSide1QtyDim1.SelectAll

F.Intrinsic.Control.ExitSub

F.Intrinsic.Control.Label("txtSide1QtyDim1_GotFocus_Err")
F.Intrinsic.Control.If(V.Ambient.ErrorNumber,<>,0)
	F.Intrinsic.String.Build("Project: GCG_6721_Shell_Crate_Calc.g2u {0}{0}Subroutine: {1}{0}Error Occurred {2} with description {3}",V.Ambient.NewLine,V.Ambient.CurrentSubroutine,V.Ambient.ErrorNumber,V.Ambient.ErrorDescription,V.Local.sError)
	F.Intrinsic.UI.Msgbox(V.Local.sError)
	F.Intrinsic.Control.CallSub(FormShell_UnLoad)
Function.Intrinsic.Control.EndIf
Program.Sub.txtSide1QtyDim1_GotFocus.End

Program.Sub.txtSide1CutLenDim1_GotFocus.Start
F.Intrinsic.Control.SetErrorHandler("txtSide1CutLenDim1_GotFocus_Err")
F.Intrinsic.Control.ClearErrors

V.Local.sError.Declare(String,"")

Gui.FormShell.txtSide1CutLenDim1.SelectAll

F.Intrinsic.Control.ExitSub

F.Intrinsic.Control.Label("txtSide1CutLenDim1_GotFocus_Err")
F.Intrinsic.Control.If(V.Ambient.ErrorNumber,<>,0)
	F.Intrinsic.String.Build("Project: GCG_6721_Shell_Crate_Calc.g2u {0}{0}Subroutine: {1}{0}Error Occurred {2} with description {3}",V.Ambient.NewLine,V.Ambient.CurrentSubroutine,V.Ambient.ErrorNumber,V.Ambient.ErrorDescription,V.Local.sError)
	F.Intrinsic.UI.Msgbox(V.Local.sError)
	F.Intrinsic.Control.CallSub(FormShell_UnLoad)
Function.Intrinsic.Control.EndIf
Program.Sub.txtSide1CutLenDim1_GotFocus.End

Program.Sub.txtSide1QtyDim2_GotFocus.Start
F.Intrinsic.Control.SetErrorHandler("txtSide1QtyDim2_GotFocus_Err")
F.Intrinsic.Control.ClearErrors

V.Local.sError.Declare(String,"")

Gui.FormShell.txtSide1QtyDim2.SelectAll

F.Intrinsic.Control.ExitSub

F.Intrinsic.Control.Label("txtSide1QtyDim2_GotFocus_Err")
F.Intrinsic.Control.If(V.Ambient.ErrorNumber,<>,0)
	F.Intrinsic.String.Build("Project: GCG_6721_Shell_Crate_Calc.g2u {0}{0}Subroutine: {1}{0}Error Occurred {2} with description {3}",V.Ambient.NewLine,V.Ambient.CurrentSubroutine,V.Ambient.ErrorNumber,V.Ambient.ErrorDescription,V.Local.sError)
	F.Intrinsic.UI.Msgbox(V.Local.sError)
	F.Intrinsic.Control.CallSub(FormShell_UnLoad)
Function.Intrinsic.Control.EndIf
Program.Sub.txtSide1QtyDim2_GotFocus.End

Program.Sub.txtSide1CutLenDim2_GotFocus.Start
F.Intrinsic.Control.SetErrorHandler("txtSide1CutLenDim2_GotFocus_Err")
F.Intrinsic.Control.ClearErrors

V.Local.sError.Declare(String,"")

Gui.FormShell.txtSide1CutLenDim2.SelectAll

F.Intrinsic.Control.ExitSub

F.Intrinsic.Control.Label("txtSide1CutLenDim2_GotFocus_Err")
F.Intrinsic.Control.If(V.Ambient.ErrorNumber,<>,0)
	F.Intrinsic.String.Build("Project: GCG_6721_Shell_Crate_Calc.g2u {0}{0}Subroutine: {1}{0}Error Occurred {2} with description {3}",V.Ambient.NewLine,V.Ambient.CurrentSubroutine,V.Ambient.ErrorNumber,V.Ambient.ErrorDescription,V.Local.sError)
	F.Intrinsic.UI.Msgbox(V.Local.sError)
	F.Intrinsic.Control.CallSub(FormShell_UnLoad)
Function.Intrinsic.Control.EndIf
Program.Sub.txtSide1CutLenDim2_GotFocus.End

Program.Sub.txtSide2QtyDim1_GotFocus.Start
F.Intrinsic.Control.SetErrorHandler("txtSide2QtyDim1_GotFocus_Err")
F.Intrinsic.Control.ClearErrors

V.Local.sError.Declare(String,"")

Gui.FormShell.txtSide2QtyDim1.SelectAll

F.Intrinsic.Control.ExitSub

F.Intrinsic.Control.Label("txtSide2QtyDim1_GotFocus_Err")
F.Intrinsic.Control.If(V.Ambient.ErrorNumber,<>,0)
	F.Intrinsic.String.Build("Project: GCG_6721_Shell_Crate_Calc.g2u {0}{0}Subroutine: {1}{0}Error Occurred {2} with description {3}",V.Ambient.NewLine,V.Ambient.CurrentSubroutine,V.Ambient.ErrorNumber,V.Ambient.ErrorDescription,V.Local.sError)
	F.Intrinsic.UI.Msgbox(V.Local.sError)
	F.Intrinsic.Control.CallSub(FormShell_UnLoad)
Function.Intrinsic.Control.EndIf
Program.Sub.txtSide2QtyDim1_GotFocus.End

Program.Sub.txtSide2CutLenDim1_GotFocus.Start
F.Intrinsic.Control.SetErrorHandler("txtSide2CutLenDim1_GotFocus_Err")
F.Intrinsic.Control.ClearErrors

V.Local.sError.Declare(String,"")

Gui.FormShell.txtSide2CutLenDim1.SelectAll

F.Intrinsic.Control.ExitSub

F.Intrinsic.Control.Label("txtSide2CutLenDim1_GotFocus_Err")
F.Intrinsic.Control.If(V.Ambient.ErrorNumber,<>,0)
	F.Intrinsic.String.Build("Project: GCG_6721_Shell_Crate_Calc.g2u {0}{0}Subroutine: {1}{0}Error Occurred {2} with description {3}",V.Ambient.NewLine,V.Ambient.CurrentSubroutine,V.Ambient.ErrorNumber,V.Ambient.ErrorDescription,V.Local.sError)
	F.Intrinsic.UI.Msgbox(V.Local.sError)
	F.Intrinsic.Control.CallSub(FormShell_UnLoad)
Function.Intrinsic.Control.EndIf
Program.Sub.txtSide2CutLenDim1_GotFocus.End

Program.Sub.txtSide2QtyDim2_GotFocus.Start
F.Intrinsic.Control.SetErrorHandler("txtSide2QtyDim2_GotFocus_Err")
F.Intrinsic.Control.ClearErrors

V.Local.sError.Declare(String,"")

Gui.FormShell.txtSide2QtyDim2.SelectAll

F.Intrinsic.Control.ExitSub

F.Intrinsic.Control.Label("txtSide2QtyDim2_GotFocus_Err")
F.Intrinsic.Control.If(V.Ambient.ErrorNumber,<>,0)
	F.Intrinsic.String.Build("Project: GCG_6721_Shell_Crate_Calc.g2u {0}{0}Subroutine: {1}{0}Error Occurred {2} with description {3}",V.Ambient.NewLine,V.Ambient.CurrentSubroutine,V.Ambient.ErrorNumber,V.Ambient.ErrorDescription,V.Local.sError)
	F.Intrinsic.UI.Msgbox(V.Local.sError)
	F.Intrinsic.Control.CallSub(FormShell_UnLoad)
Function.Intrinsic.Control.EndIf
Program.Sub.txtSide2QtyDim2_GotFocus.End

Program.Sub.txtSide2CutLenDim2_GotFocus.Start
F.Intrinsic.Control.SetErrorHandler("txtSide2CutLenDim2_GotFocus_Err")
F.Intrinsic.Control.ClearErrors

V.Local.sError.Declare(String,"")

Gui.FormShell.txtSide2CutLenDim2.SelectAll

F.Intrinsic.Control.ExitSub

F.Intrinsic.Control.Label("txtSide2CutLenDim2_GotFocus_Err")
F.Intrinsic.Control.If(V.Ambient.ErrorNumber,<>,0)
	F.Intrinsic.String.Build("Project: GCG_6721_Shell_Crate_Calc.g2u {0}{0}Subroutine: {1}{0}Error Occurred {2} with description {3}",V.Ambient.NewLine,V.Ambient.CurrentSubroutine,V.Ambient.ErrorNumber,V.Ambient.ErrorDescription,V.Local.sError)
	F.Intrinsic.UI.Msgbox(V.Local.sError)
	F.Intrinsic.Control.CallSub(FormShell_UnLoad)
Function.Intrinsic.Control.EndIf
Program.Sub.txtSide2CutLenDim2_GotFocus.End

Program.Sub.txtTopQtyDim1_GotFocus.Start
F.Intrinsic.Control.SetErrorHandler("txtTopQtyDim1_GotFocus_Err")
F.Intrinsic.Control.ClearErrors

V.Local.sError.Declare(String,"")

Gui.FormShell.txtTopQtyDim1.SelectAll

F.Intrinsic.Control.ExitSub

F.Intrinsic.Control.Label("txtTopQtyDim1_GotFocus_Err")
F.Intrinsic.Control.If(V.Ambient.ErrorNumber,<>,0)
	F.Intrinsic.String.Build("Project: GCG_6721_Shell_Crate_Calc.g2u {0}{0}Subroutine: {1}{0}Error Occurred {2} with description {3}",V.Ambient.NewLine,V.Ambient.CurrentSubroutine,V.Ambient.ErrorNumber,V.Ambient.ErrorDescription,V.Local.sError)
	F.Intrinsic.UI.Msgbox(V.Local.sError)
	F.Intrinsic.Control.CallSub(FormShell_UnLoad)
Function.Intrinsic.Control.EndIf
Program.Sub.txtTopQtyDim1_GotFocus.End

Program.Sub.txtTopCutLenDim1_GotFocus.Start
F.Intrinsic.Control.SetErrorHandler("txtTopCutLenDim1_GotFocus_Err")
F.Intrinsic.Control.ClearErrors

V.Local.sError.Declare(String,"")

Gui.FormShell.txtTopCutLenDim1.SelectAll

F.Intrinsic.Control.ExitSub

F.Intrinsic.Control.Label("txtTopCutLenDim1_GotFocus_Err")
F.Intrinsic.Control.If(V.Ambient.ErrorNumber,<>,0)
	F.Intrinsic.String.Build("Project: GCG_6721_Shell_Crate_Calc.g2u {0}{0}Subroutine: {1}{0}Error Occurred {2} with description {3}",V.Ambient.NewLine,V.Ambient.CurrentSubroutine,V.Ambient.ErrorNumber,V.Ambient.ErrorDescription,V.Local.sError)
	F.Intrinsic.UI.Msgbox(V.Local.sError)
	F.Intrinsic.Control.CallSub(FormShell_UnLoad)
Function.Intrinsic.Control.EndIf
Program.Sub.txtTopCutLenDim1_GotFocus.End

Program.Sub.txtTopQtyDim2_GotFocus.Start
F.Intrinsic.Control.SetErrorHandler("txtTopQtyDim2_GotFocus_Err")
F.Intrinsic.Control.ClearErrors

V.Local.sError.Declare(String,"")

Gui.FormShell.txtTopQtyDim2.SelectAll

F.Intrinsic.Control.ExitSub

F.Intrinsic.Control.Label("txtTopQtyDim2_GotFocus_Err")
F.Intrinsic.Control.If(V.Ambient.ErrorNumber,<>,0)
	F.Intrinsic.String.Build("Project: GCG_6721_Shell_Crate_Calc.g2u {0}{0}Subroutine: {1}{0}Error Occurred {2} with description {3}",V.Ambient.NewLine,V.Ambient.CurrentSubroutine,V.Ambient.ErrorNumber,V.Ambient.ErrorDescription,V.Local.sError)
	F.Intrinsic.UI.Msgbox(V.Local.sError)
	F.Intrinsic.Control.CallSub(FormShell_UnLoad)
Function.Intrinsic.Control.EndIf
Program.Sub.txtTopQtyDim2_GotFocus.End

Program.Sub.txtTopCutLenDim2_GotFocus.Start
F.Intrinsic.Control.SetErrorHandler("txtTopCutLenDim2_GotFocus_Err")
F.Intrinsic.Control.ClearErrors

V.Local.sError.Declare(String,"")

Gui.FormShell.txtTopCutLenDim2.SelectAll

F.Intrinsic.Control.ExitSub

F.Intrinsic.Control.Label("txtTopCutLenDim2_GotFocus_Err")
F.Intrinsic.Control.If(V.Ambient.ErrorNumber,<>,0)
	F.Intrinsic.String.Build("Project: GCG_6721_Shell_Crate_Calc.g2u {0}{0}Subroutine: {1}{0}Error Occurred {2} with description {3}",V.Ambient.NewLine,V.Ambient.CurrentSubroutine,V.Ambient.ErrorNumber,V.Ambient.ErrorDescription,V.Local.sError)
	F.Intrinsic.UI.Msgbox(V.Local.sError)
	F.Intrinsic.Control.CallSub(FormShell_UnLoad)
Function.Intrinsic.Control.EndIf
Program.Sub.txtTopCutLenDim2_GotFocus.End

Program.Sub.ddlTStrgMat_SelectedIndexChanged.Start
F.Intrinsic.Control.SetErrorHandler("ddlTStrgMat_SelectedIndexChanged_Err")
F.Intrinsic.Control.ClearErrors

V.Local.sError.Declare(String,"")
V.Local.sSql.Declare(String,"")
V.Local.fMatLen.Declare(Float,0)
V.Local.fMatWid.Declare(Float,0)
V.Local.sEval.Declare(String,"")
V.Local.fWidth.Declare(Float,0)
V.Local.fHeight.Declare(Float,0)
V.Local.fLength.Declare(Float,0)
V.Local.fQty1.Declare(Float,0)
V.Local.fTemp1.Declare(Float,0)

V.Local.fLength.Set(V.Screen.FormShell!txtShellLen.Text)
V.Local.fWidth.Set(V.Screen.FormShell!txtShellWidth.Text)
V.Local.fHeight.Set(V.Screen.FormShell!txtShellHeight.Text)

F.ODBC.Connection!Con.OpenCompanyConnection
F.Intrinsic.String.Build("Select Length From V_Inventory_Mst2 Where Part = '{0}'",V.Screen.FormShell!ddlTStrgMat.Text,V.Local.sSql)
F.ODBC.Connection!con.ExecuteAndReturn(V.Local.sSql,V.Local.fMatLen)
F.Intrinsic.String.Build("Select Width From V_Inventory_Mst2 Where Part = '{0}'",V.Screen.FormShell!ddlTStrgMat.Text,V.Local.sSql)
F.ODBC.Connection!con.ExecuteAndReturn(V.Local.sSql,V.Local.fMatWid)
F.ODBC.Connection!con.Close

F.Data.DataView.Create("CrateCalc","Temp",22,"(Dim1Qty like '*[[]MW[]]*' or Dim1Qty like '*[[]ML[]]*') and OpCode = 'T STRG'","")

F.Intrinsic.Control.If(V.DataView.CrateCalc!Temp.RowCount--,<>,-1)
	F.Intrinsic.String.Replace(V.DataView.CrateCalc!Temp(V.DataView.CrateCalc!Temp.RowCount--).Dim1Qty!FieldValTrim,"[CL]",V.Local.fLength,V.Local.sEval)
	F.Intrinsic.String.Replace(V.Local.sEval,"[CW]",V.Local.fWidth,V.Local.sEval)
	F.Intrinsic.String.Replace(V.Local.sEval,"[CH]",V.Local.fHeight,V.Local.sEval)
	F.Intrinsic.String.Replace(V.Local.sEval,"[MW]",V.Local.fMatWid,V.Local.sEval)
	F.Intrinsic.String.Replace(V.Local.sEval,"[ML]",V.Local.fMatLen,V.Local.sEval)
	F.Intrinsic.String.RegExReplace(V.Local.sEval,"/0","/1",True,True,V.Local.sEval)
	F.Intrinsic.Control.If(V.Local.sEval,<>,"")
		F.Intrinsic.Math.Evaluate(V.Local.sEval,V.Local.fQty1)
	F.Intrinsic.Control.Else
		V.Local.fQty1.Set(0)
	F.Intrinsic.Control.EndIf
	F.Intrinsic.Math.Int(V.Local.fQty1,V.Local.fTemp1)
	F.Intrinsic.Control.If(V.Local.fQty1,<,V.Local.fTemp1)
		F.Intrinsic.Math.Sub(V.Local.fTemp1.Long,1,V.Local.fQty1)
	F.Intrinsic.Control.Else
		F.Intrinsic.Math.Add(V.Local.fTemp1.Long,1,V.Local.fQty1)
	F.Intrinsic.Control.EndIf
	gui.FormShell.txtTStrgQty.Text(V.Local.fQty1)
F.Intrinsic.Control.EndIf

F.Data.DataView.Close("CrateCalc","Temp")

F.Data.DataView.Create("CrateCalc","Temp",22,"(Dim1Form like '*[[]MW[]]*' or Dim1Form like '*[[]ML[]]*') and OpCode = 'T STRG'","")

F.Intrinsic.Control.If(V.DataView.CrateCalc!Temp.RowCount--,<>,-1)
	F.Intrinsic.String.Replace(V.DataView.CrateCalc!Temp(V.DataView.CrateCalc!Temp.RowCount--).Dim1Form!FieldValTrim,"[CL]",V.Local.fLength,V.Local.sEval)
	F.Intrinsic.String.Replace(V.Local.sEval,"[CW]",V.Local.fWidth,V.Local.sEval)
	F.Intrinsic.String.Replace(V.Local.sEval,"[CH]",V.Local.fHeight,V.Local.sEval)
	F.Intrinsic.String.Replace(V.Local.sEval,"[MW]",V.Local.fMatWid,V.Local.sEval)
	F.Intrinsic.String.Replace(V.Local.sEval,"[ML]",V.Local.fMatLen,V.Local.sEval)
	F.Intrinsic.String.RegExReplace(V.Local.sEval,"/0","/1",True,True,V.Local.sEval)
	F.Intrinsic.Control.If(V.Local.sEval,<>,"")
		F.Intrinsic.Math.Evaluate(V.Local.sEval,V.Local.fQty1)
	F.Intrinsic.Control.Else
		V.Local.fQty1.Set(0)
	F.Intrinsic.Control.EndIf
	gui.FormShell.txtTStrg.Text(V.Local.fQty1)
F.Intrinsic.Control.EndIf

F.Data.DataView.Close("CrateCalc","Temp")

F.Intrinsic.Control.ExitSub

F.Intrinsic.Control.Label("ddlTStrgMat_SelectedIndexChanged_Err")
F.Intrinsic.Control.If(V.Ambient.ErrorNumber,<>,0)
	F.Intrinsic.String.Build("Project: GCG_6721_Shell_Crate_Calc.g2u {0}{0}Subroutine: {1}{0}Error Occurred {2} with description {3}",V.Ambient.NewLine,V.Ambient.CurrentSubroutine,V.Ambient.ErrorNumber,V.Ambient.ErrorDescription,V.Local.sError)
	F.Intrinsic.UI.Msgbox(V.Local.sError)
	F.Intrinsic.Control.CallSub(FormShell_UnLoad)
Function.Intrinsic.Control.EndIf
Program.Sub.ddlTStrgMat_SelectedIndexChanged.End

Program.Sub.ddlBStrg_SelectedIndexChanged.Start
F.Intrinsic.Control.SetErrorHandler("ddlBStrg_SelectedIndexChanged_Err")
F.Intrinsic.Control.ClearErrors

V.Local.sError.Declare(String,"")
V.Local.sSql.Declare(String,"")
V.Local.fMatLen.Declare(Float,0)
V.Local.fMatWid.Declare(Float,0)
V.Local.sEval.Declare(String,"")
V.Local.fWidth.Declare(Float,0)
V.Local.fHeight.Declare(Float,0)
V.Local.fLength.Declare(Float,0)
V.Local.fQty1.Declare(Float,0)
V.Local.fTemp1.Declare(Float,0)

V.Local.fLength.Set(V.Screen.FormShell!txtShellLen.Text)
V.Local.fWidth.Set(V.Screen.FormShell!txtShellWidth.Text)
V.Local.fHeight.Set(V.Screen.FormShell!txtShellHeight.Text)

F.ODBC.Connection!Con.OpenCompanyConnection
F.Intrinsic.String.Build("Select Length From V_Inventory_Mst2 Where Part = '{0}'",V.Screen.FormShell!ddlBStrg.Text,V.Local.sSql)
F.ODBC.Connection!con.ExecuteAndReturn(V.Local.sSql,V.Local.fMatLen)
F.Intrinsic.String.Build("Select Width From V_Inventory_Mst2 Where Part = '{0}'",V.Screen.FormShell!ddlBStrg.Text,V.Local.sSql)
F.ODBC.Connection!con.ExecuteAndReturn(V.Local.sSql,V.Local.fMatWid)
F.ODBC.Connection!con.Close

F.Data.DataView.Create("CrateCalc","Temp",22,"(Dim2Qty like '*[[]MW[]]*' or Dim2Qty like '*[[]ML[]]*') and OpCode = 'B STRG'","")

F.Intrinsic.Control.If(V.DataView.CrateCalc!Temp.RowCount--,<>,-1)
	F.Intrinsic.String.Replace(V.DataView.CrateCalc!Temp(V.DataView.CrateCalc!Temp.RowCount--).Dim2Qty!FieldValTrim,"[CL]",V.Local.fLength,V.Local.sEval)
	F.Intrinsic.String.Replace(V.Local.sEval,"[CW]",V.Local.fWidth,V.Local.sEval)
	F.Intrinsic.String.Replace(V.Local.sEval,"[CH]",V.Local.fHeight,V.Local.sEval)
	F.Intrinsic.String.Replace(V.Local.sEval,"[MW]",V.Local.fMatWid,V.Local.sEval)
	F.Intrinsic.String.Replace(V.Local.sEval,"[ML]",V.Local.fMatLen,V.Local.sEval)
	F.Intrinsic.String.RegExReplace(V.Local.sEval,"/0","/1",True,True,V.Local.sEval)
	F.Intrinsic.Control.If(V.Local.sEval,<>,"")
		F.Intrinsic.Math.Evaluate(V.Local.sEval,V.Local.fQty1)
	F.Intrinsic.Control.Else
		V.Local.fQty1.Set(0)
	F.Intrinsic.Control.EndIf
	F.Intrinsic.Math.Int(V.Local.fQty1,V.Local.fTemp1)
	F.Intrinsic.Control.If(V.Local.fQty1,<,V.Local.fTemp1)
		F.Intrinsic.Math.Sub(V.Local.fTemp1.Long,1,V.Local.fQty1)
	F.Intrinsic.Control.Else
		F.Intrinsic.Math.Add(V.Local.fTemp1.Long,1,V.Local.fQty1)
	F.Intrinsic.Control.EndIf
	gui.FormShell.txtBstrgQty.Text(V.Local.fQty1)
F.Intrinsic.Control.EndIf

F.Data.DataView.Close("CrateCalc","Temp")

F.Data.DataView.Create("CrateCalc","Temp",22,"(Dim2Form like '*[[]MW[]]*' or Dim2Form like '*[[]ML[]]*') and OpCode = 'B STRG'","")

F.Intrinsic.Control.If(V.DataView.CrateCalc!Temp.RowCount--,<>,-1)
	F.Intrinsic.String.Replace(V.DataView.CrateCalc!Temp(V.DataView.CrateCalc!Temp.RowCount--).Dim2Form!FieldValTrim,"[CL]",V.Local.fLength,V.Local.sEval)
	F.Intrinsic.String.Replace(V.Local.sEval,"[CW]",V.Local.fWidth,V.Local.sEval)
	F.Intrinsic.String.Replace(V.Local.sEval,"[CH]",V.Local.fHeight,V.Local.sEval)
	F.Intrinsic.String.Replace(V.Local.sEval,"[MW]",V.Local.fMatWid,V.Local.sEval)
	F.Intrinsic.String.Replace(V.Local.sEval,"[ML]",V.Local.fMatLen,V.Local.sEval)
	F.Intrinsic.String.RegExReplace(V.Local.sEval,"/0","/1",True,True,V.Local.sEval)
	F.Intrinsic.Control.If(V.Local.sEval,<>,"")
		F.Intrinsic.Math.Evaluate(V.Local.sEval,V.Local.fQty1)
	F.Intrinsic.Control.Else
		V.Local.fQty1.Set(0)
	F.Intrinsic.Control.EndIf
	gui.FormShell.txtBstrg.Text(V.Local.fQty1)
F.Intrinsic.Control.EndIf

F.Data.DataView.Close("CrateCalc","Temp")

F.Intrinsic.Control.ExitSub

F.Intrinsic.Control.Label("ddlBStrg_SelectedIndexChanged_Err")
F.Intrinsic.Control.If(V.Ambient.ErrorNumber,<>,0)
	F.Intrinsic.String.Build("Project: GCG_6721_Shell_Crate_Calc.g2u {0}{0}Subroutine: {1}{0}Error Occurred {2} with description {3}",V.Ambient.NewLine,V.Ambient.CurrentSubroutine,V.Ambient.ErrorNumber,V.Ambient.ErrorDescription,V.Local.sError)
	F.Intrinsic.UI.Msgbox(V.Local.sError)
	F.Intrinsic.Control.CallSub(FormShell_UnLoad)
Function.Intrinsic.Control.EndIf
Program.Sub.ddlBStrg_SelectedIndexChanged.End

Program.Sub.ddlRunMat_SelectedIndexChanged.Start
F.Intrinsic.Control.SetErrorHandler("ddlRunMat_SelectedIndexChanged_Err")
F.Intrinsic.Control.ClearErrors

V.Local.sError.Declare(String,"")
V.Local.sSql.Declare(String,"")
V.Local.fMatLen.Declare(Float,0)
V.Local.fMatWid.Declare(Float,0)
V.Local.sEval.Declare(String,"")
V.Local.fWidth.Declare(Float,0)
V.Local.fHeight.Declare(Float,0)
V.Local.fLength.Declare(Float,0)
V.Local.fQty1.Declare(Float,0)
V.Local.fTemp1.Declare(Float,0)

V.Local.fLength.Set(V.Screen.FormShell!txtShellLen.Text)
V.Local.fWidth.Set(V.Screen.FormShell!txtShellWidth.Text)
V.Local.fHeight.Set(V.Screen.FormShell!txtShellHeight.Text)

F.ODBC.Connection!Con.OpenCompanyConnection
F.Intrinsic.String.Build("Select Length From V_Inventory_Mst2 Where Part = '{0}'",V.Screen.FormShell!ddlRunMat.Text,V.Local.sSql)
F.ODBC.Connection!con.ExecuteAndReturn(V.Local.sSql,V.Local.fMatLen)
F.Intrinsic.String.Build("Select Width From V_Inventory_Mst2 Where Part = '{0}'",V.Screen.FormShell!ddlRunMat.Text,V.Local.sSql)
F.ODBC.Connection!con.ExecuteAndReturn(V.Local.sSql,V.Local.fMatWid)
F.ODBC.Connection!con.Close

F.Data.DataView.Create("CrateCalc","Temp",22,"(Dim1Qty like '*[[]MW[]]*' or Dim1Qty like '*[[]ML[]]*') and OpCode = 'RUN'","")

F.Intrinsic.Control.If(V.DataView.CrateCalc!Temp.RowCount--,<>,-1)
	F.Intrinsic.String.Replace(V.DataView.CrateCalc!Temp(V.DataView.CrateCalc!Temp.RowCount--).Dim1Qty!FieldValTrim,"[CL]",V.Local.fLength,V.Local.sEval)
	F.Intrinsic.String.Replace(V.Local.sEval,"[CW]",V.Local.fWidth,V.Local.sEval)
	F.Intrinsic.String.Replace(V.Local.sEval,"[CH]",V.Local.fHeight,V.Local.sEval)
	F.Intrinsic.String.Replace(V.Local.sEval,"[MW]",V.Local.fMatWid,V.Local.sEval)
	F.Intrinsic.String.Replace(V.Local.sEval,"[ML]",V.Local.fMatLen,V.Local.sEval)
	F.Intrinsic.String.RegExReplace(V.Local.sEval,"/0","/1",True,True,V.Local.sEval)
	F.Intrinsic.Control.If(V.Local.sEval,<>,"")
		F.Intrinsic.Math.Evaluate(V.Local.sEval,V.Local.fQty1)
	F.Intrinsic.Control.Else
		V.Local.fQty1.Set(0)
	F.Intrinsic.Control.EndIf
	F.Intrinsic.Math.Int(V.Local.fQty1,V.Local.fTemp1)
	F.Intrinsic.Control.If(V.Local.fQty1,<,V.Local.fTemp1)
		F.Intrinsic.Math.Sub(V.Local.fTemp1.Long,1,V.Local.fQty1)
	F.Intrinsic.Control.Else
		F.Intrinsic.Math.Add(V.Local.fTemp1.Long,1,V.Local.fQty1)
	F.Intrinsic.Control.EndIf
	gui.FormShell.txtRunQty.Text(V.Local.fQty1)
F.Intrinsic.Control.EndIf

F.Data.DataView.Close("CrateCalc","Temp")

F.Data.DataView.Create("CrateCalc","Temp",22,"(Dim1Form like '*[[]MW[]]*' or Dim1Form like '*[[]ML[]]*') and OpCode = 'RUN'","")

F.Intrinsic.Control.If(V.DataView.CrateCalc!Temp.RowCount--,<>,-1)
	F.Intrinsic.String.Replace(V.DataView.CrateCalc!Temp(V.DataView.CrateCalc!Temp.RowCount--).Dim1Form!FieldValTrim,"[CL]",V.Local.fLength,V.Local.sEval)
	F.Intrinsic.String.Replace(V.Local.sEval,"[CW]",V.Local.fWidth,V.Local.sEval)
	F.Intrinsic.String.Replace(V.Local.sEval,"[CH]",V.Local.fHeight,V.Local.sEval)
	F.Intrinsic.String.Replace(V.Local.sEval,"[MW]",V.Local.fMatWid,V.Local.sEval)
	F.Intrinsic.String.Replace(V.Local.sEval,"[ML]",V.Local.fMatLen,V.Local.sEval)
	F.Intrinsic.String.RegExReplace(V.Local.sEval,"/0","/1",True,True,V.Local.sEval)
	F.Intrinsic.Control.If(V.Local.sEval,<>,"")
		F.Intrinsic.Math.Evaluate(V.Local.sEval,V.Local.fQty1)
	F.Intrinsic.Control.Else
		V.Local.fQty1.Set(0)
	F.Intrinsic.Control.EndIf
	gui.FormShell.txtLRun.Text(V.Local.fQty1)
F.Intrinsic.Control.EndIf

F.Data.DataView.Close("CrateCalc","Temp")

F.Intrinsic.Control.ExitSub

F.Intrinsic.Control.Label("ddlRunMat_SelectedIndexChanged_Err")
F.Intrinsic.Control.If(V.Ambient.ErrorNumber,<>,0)
	F.Intrinsic.String.Build("Project: GCG_6721_Shell_Crate_Calc.g2u {0}{0}Subroutine: {1}{0}Error Occurred {2} with description {3}",V.Ambient.NewLine,V.Ambient.CurrentSubroutine,V.Ambient.ErrorNumber,V.Ambient.ErrorDescription,V.Local.sError)
	F.Intrinsic.UI.Msgbox(V.Local.sError)
	F.Intrinsic.Control.CallSub(FormShell_UnLoad)
Function.Intrinsic.Control.EndIf
Program.Sub.ddlRunMat_SelectedIndexChanged.End

Program.Sub.ddlSide1Mat_SelectedIndexChanged.Start
F.Intrinsic.Control.SetErrorHandler("ddlSide1Mat_SelectedIndexChanged_Err")
F.Intrinsic.Control.ClearErrors

V.Local.sError.Declare(String,"")
V.Local.sSql.Declare(String,"")
V.Local.fMatLen.Declare(Float,0)
V.Local.fMatWid.Declare(Float,0)
V.Local.sEval.Declare(String,"")
V.Local.fWidth.Declare(Float,0)
V.Local.fHeight.Declare(Float,0)
V.Local.fLength.Declare(Float,0)
V.Local.fQty1.Declare(Float,0)
V.Local.fTemp1.Declare(Float,0)

V.Local.fLength.Set(V.Screen.FormShell!txtShellLen.Text)
V.Local.fWidth.Set(V.Screen.FormShell!txtShellWidth.Text)
V.Local.fHeight.Set(V.Screen.FormShell!txtShellHeight.Text)

F.ODBC.Connection!Con.OpenCompanyConnection
F.Intrinsic.String.Build("Select Length From V_Inventory_Mst2 Where Part = '{0}'",V.Screen.FormShell!ddlRunMat.Text,V.Local.sSql)
F.ODBC.Connection!con.ExecuteAndReturn(V.Local.sSql,V.Local.fMatLen)
F.Intrinsic.String.Build("Select Width From V_Inventory_Mst2 Where Part = '{0}'",V.Screen.FormShell!ddlRunMat.Text,V.Local.sSql)
F.ODBC.Connection!con.ExecuteAndReturn(V.Local.sSql,V.Local.fMatWid)
F.ODBC.Connection!con.Close

F.Data.DataView.Create("CrateCalc","Temp",22,"(Dim1Qty like '*[[]MW[]]*' or Dim1Qty like '*[[]ML[]]*') and OpCode = 'SIDE 1'","")

F.Intrinsic.Control.If(V.DataView.CrateCalc!Temp.RowCount--,<>,-1)
	F.Intrinsic.String.Replace(V.DataView.CrateCalc!Temp(V.DataView.CrateCalc!Temp.RowCount--).Dim1Qty!FieldValTrim,"[CL]",V.Local.fLength,V.Local.sEval)
	F.Intrinsic.String.Replace(V.Local.sEval,"[CW]",V.Local.fWidth,V.Local.sEval)
	F.Intrinsic.String.Replace(V.Local.sEval,"[CH]",V.Local.fHeight,V.Local.sEval)
	F.Intrinsic.String.Replace(V.Local.sEval,"[MW]",V.Local.fMatWid,V.Local.sEval)
	F.Intrinsic.String.Replace(V.Local.sEval,"[ML]",V.Local.fMatLen,V.Local.sEval)
	F.Intrinsic.String.RegExReplace(V.Local.sEval,"/0","/1",True,True,V.Local.sEval)
	F.Intrinsic.Control.If(V.Local.sEval,<>,"")
		F.Intrinsic.Math.Evaluate(V.Local.sEval,V.Local.fQty1)
	F.Intrinsic.Control.Else
		V.Local.fQty1.Set(0)
	F.Intrinsic.Control.EndIf
	F.Intrinsic.Math.Int(V.Local.fQty1,V.Local.fTemp1)
	F.Intrinsic.Control.If(V.Local.fQty1,<,V.Local.fTemp1)
		F.Intrinsic.Math.Sub(V.Local.fTemp1.Long,1,V.Local.fQty1)
	F.Intrinsic.Control.Else
		F.Intrinsic.Math.Add(V.Local.fTemp1.Long,1,V.Local.fQty1)
	F.Intrinsic.Control.EndIf
	gui.FormShell.txtSide1QtyDim1.Text(V.Local.fQty1)
F.Intrinsic.Control.EndIf

F.Data.DataView.Close("CrateCalc","Temp")

F.Data.DataView.Create("CrateCalc","Temp",22,"(Dim1Form like '*[[]MW[]]*' or Dim1Form like '*[[]ML[]]*') and OpCode = 'SIDE 1'","")

F.Intrinsic.Control.If(V.DataView.CrateCalc!Temp.RowCount--,<>,-1)
	F.Intrinsic.String.Replace(V.DataView.CrateCalc!Temp(V.DataView.CrateCalc!Temp.RowCount--).Dim1Form!FieldValTrim,"[CL]",V.Local.fLength,V.Local.sEval)
	F.Intrinsic.String.Replace(V.Local.sEval,"[CW]",V.Local.fWidth,V.Local.sEval)
	F.Intrinsic.String.Replace(V.Local.sEval,"[CH]",V.Local.fHeight,V.Local.sEval)
	F.Intrinsic.String.Replace(V.Local.sEval,"[MW]",V.Local.fMatWid,V.Local.sEval)
	F.Intrinsic.String.Replace(V.Local.sEval,"[ML]",V.Local.fMatLen,V.Local.sEval)
	F.Intrinsic.String.RegExReplace(V.Local.sEval,"/0","/1",True,True,V.Local.sEval)
	F.Intrinsic.Control.If(V.Local.sEval,<>,"")
		F.Intrinsic.Math.Evaluate(V.Local.sEval,V.Local.fQty1)
	F.Intrinsic.Control.Else
		V.Local.fQty1.Set(0)
	F.Intrinsic.Control.EndIf
	gui.FormShell.txtSide1CutLenDim1.Text(V.Local.fQty1)
F.Intrinsic.Control.EndIf

F.Data.DataView.Close("CrateCalc","Temp")

F.Data.DataView.Create("CrateCalc","Temp",22,"(Dim2Qty like '*[[]MW[]]*' or Dim2Qty like '*[[]ML[]]*') and OpCode = 'SIDE 1'","")

F.Intrinsic.Control.If(V.DataView.CrateCalc!Temp.RowCount--,<>,-1)
	F.Intrinsic.String.Replace(V.DataView.CrateCalc!Temp(V.DataView.CrateCalc!Temp.RowCount--).Dim2Qty!FieldValTrim,"[CL]",V.Local.fLength,V.Local.sEval)
	F.Intrinsic.String.Replace(V.Local.sEval,"[CW]",V.Local.fWidth,V.Local.sEval)
	F.Intrinsic.String.Replace(V.Local.sEval,"[CH]",V.Local.fHeight,V.Local.sEval)
	F.Intrinsic.String.Replace(V.Local.sEval,"[MW]",V.Local.fMatWid,V.Local.sEval)
	F.Intrinsic.String.Replace(V.Local.sEval,"[ML]",V.Local.fMatLen,V.Local.sEval)
	F.Intrinsic.String.RegExReplace(V.Local.sEval,"/0","/1",True,True,V.Local.sEval)
	F.Intrinsic.Control.If(V.Local.sEval,<>,"")
		F.Intrinsic.Math.Evaluate(V.Local.sEval,V.Local.fQty1)
	F.Intrinsic.Control.Else
		V.Local.fQty1.Set(0)
	F.Intrinsic.Control.EndIf
	F.Intrinsic.Math.Int(V.Local.fQty1,V.Local.fTemp1)
	F.Intrinsic.Control.If(V.Local.fQty1,<,V.Local.fTemp1)
		F.Intrinsic.Math.Sub(V.Local.fTemp1.Long,1,V.Local.fQty1)
	F.Intrinsic.Control.Else
		F.Intrinsic.Math.Add(V.Local.fTemp1.Long,1,V.Local.fQty1)
	F.Intrinsic.Control.EndIf
	gui.FormShell.txtSide1QtyDim2.Text(V.Local.fQty1)
F.Intrinsic.Control.EndIf

F.Data.DataView.Close("CrateCalc","Temp")

F.Data.DataView.Create("CrateCalc","Temp",22,"(Dim2Form like '*[[]MW[]]*' or Dim2Form like '*[[]ML[]]*') and OpCode = 'SIDE 1'","")

F.Intrinsic.Control.If(V.DataView.CrateCalc!Temp.RowCount--,<>,-1)
	F.Intrinsic.String.Replace(V.DataView.CrateCalc!Temp(V.DataView.CrateCalc!Temp.RowCount--).Dim2Form!FieldValTrim,"[CL]",V.Local.fLength,V.Local.sEval)
	F.Intrinsic.String.Replace(V.Local.sEval,"[CW]",V.Local.fWidth,V.Local.sEval)
	F.Intrinsic.String.Replace(V.Local.sEval,"[CH]",V.Local.fHeight,V.Local.sEval)
	F.Intrinsic.String.Replace(V.Local.sEval,"[MW]",V.Local.fMatWid,V.Local.sEval)
	F.Intrinsic.String.Replace(V.Local.sEval,"[ML]",V.Local.fMatLen,V.Local.sEval)
	F.Intrinsic.String.RegExReplace(V.Local.sEval,"/0","/1",True,True,V.Local.sEval)
	F.Intrinsic.Control.If(V.Local.sEval,<>,"")
		F.Intrinsic.Math.Evaluate(V.Local.sEval,V.Local.fQty1)
	F.Intrinsic.Control.Else
		V.Local.fQty1.Set(0)
	F.Intrinsic.Control.EndIf
	gui.FormShell.txtSide1CutLenDim2.Text(V.Local.fQty1)
F.Intrinsic.Control.EndIf

F.Data.DataView.Close("CrateCalc","Temp")

F.Intrinsic.Control.ExitSub

F.Intrinsic.Control.Label("ddlSide1Mat_SelectedIndexChanged_Err")
F.Intrinsic.Control.If(V.Ambient.ErrorNumber,<>,0)
	F.Intrinsic.String.Build("Project: GCG_6721_Shell_Crate_Calc.g2u {0}{0}Subroutine: {1}{0}Error Occurred {2} with description {3}",V.Ambient.NewLine,V.Ambient.CurrentSubroutine,V.Ambient.ErrorNumber,V.Ambient.ErrorDescription,V.Local.sError)
	F.Intrinsic.UI.Msgbox(V.Local.sError)
	F.Intrinsic.Control.CallSub(FormShell_UnLoad)
Function.Intrinsic.Control.EndIf
Program.Sub.ddlSide1Mat_SelectedIndexChanged.End

Program.Sub.ddlSide2Mat_SelectedIndexChanged.Start
F.Intrinsic.Control.SetErrorHandler("ddlSide2Mat_SelectedIndexChanged_Err")
F.Intrinsic.Control.ClearErrors

V.Local.sError.Declare(String,"")
V.Local.sSql.Declare(String,"")
V.Local.fMatLen.Declare(Float,0)
V.Local.fMatWid.Declare(Float,0)
V.Local.sEval.Declare(String,"")
V.Local.fWidth.Declare(Float,0)
V.Local.fHeight.Declare(Float,0)
V.Local.fLength.Declare(Float,0)
V.Local.fQty1.Declare(Float,0)
V.Local.fTemp1.Declare(Float,0)

V.Local.fLength.Set(V.Screen.FormShell!txtShellLen.Text)
V.Local.fWidth.Set(V.Screen.FormShell!txtShellWidth.Text)
V.Local.fHeight.Set(V.Screen.FormShell!txtShellHeight.Text)

F.ODBC.Connection!Con.OpenCompanyConnection
F.Intrinsic.String.Build("Select Length From V_Inventory_Mst2 Where Part = '{0}'",V.Screen.FormShell!ddlRunMat.Text,V.Local.sSql)
F.ODBC.Connection!con.ExecuteAndReturn(V.Local.sSql,V.Local.fMatLen)
F.Intrinsic.String.Build("Select Width From V_Inventory_Mst2 Where Part = '{0}'",V.Screen.FormShell!ddlRunMat.Text,V.Local.sSql)
F.ODBC.Connection!con.ExecuteAndReturn(V.Local.sSql,V.Local.fMatWid)
F.ODBC.Connection!con.Close

F.Data.DataView.Create("CrateCalc","Temp",22,"(Dim1Qty like '*[[]MW[]]*' or Dim1Qty like '*[[]ML[]]*') and OpCode = 'SIDE 2'","")

F.Intrinsic.Control.If(V.DataView.CrateCalc!Temp.RowCount--,<>,-1)
	F.Intrinsic.String.Replace(V.DataView.CrateCalc!Temp(V.DataView.CrateCalc!Temp.RowCount--).Dim1Qty!FieldValTrim,"[CL]",V.Local.fLength,V.Local.sEval)
	F.Intrinsic.String.Replace(V.Local.sEval,"[CW]",V.Local.fWidth,V.Local.sEval)
	F.Intrinsic.String.Replace(V.Local.sEval,"[CH]",V.Local.fHeight,V.Local.sEval)
	F.Intrinsic.String.Replace(V.Local.sEval,"[MW]",V.Local.fMatWid,V.Local.sEval)
	F.Intrinsic.String.Replace(V.Local.sEval,"[ML]",V.Local.fMatLen,V.Local.sEval)
	F.Intrinsic.String.RegExReplace(V.Local.sEval,"/0","/1",True,True,V.Local.sEval)
	F.Intrinsic.Control.If(V.Local.sEval,<>,"")
		F.Intrinsic.Math.Evaluate(V.Local.sEval,V.Local.fQty1)
	F.Intrinsic.Control.Else
		V.Local.fQty1.Set(0)
	F.Intrinsic.Control.EndIf
	F.Intrinsic.Math.Int(V.Local.fQty1,V.Local.fTemp1)
	F.Intrinsic.Control.If(V.Local.fQty1,<,V.Local.fTemp1)
		F.Intrinsic.Math.Sub(V.Local.fTemp1.Long,1,V.Local.fQty1)
	F.Intrinsic.Control.Else
		F.Intrinsic.Math.Add(V.Local.fTemp1.Long,1,V.Local.fQty1)
	F.Intrinsic.Control.EndIf
	gui.FormShell.txtSide2QtyDim1.Text(V.Local.fQty1)
F.Intrinsic.Control.EndIf

F.Data.DataView.Close("CrateCalc","Temp")

F.Data.DataView.Create("CrateCalc","Temp",22,"(Dim1Form like '*[[]MW[]]*' or Dim1Form like '*[[]ML[]]*') and OpCode = 'SIDE 2'","")

F.Intrinsic.Control.If(V.DataView.CrateCalc!Temp.RowCount--,<>,-1)
	F.Intrinsic.String.Replace(V.DataView.CrateCalc!Temp(V.DataView.CrateCalc!Temp.RowCount--).Dim1Form!FieldValTrim,"[CL]",V.Local.fLength,V.Local.sEval)
	F.Intrinsic.String.Replace(V.Local.sEval,"[CW]",V.Local.fWidth,V.Local.sEval)
	F.Intrinsic.String.Replace(V.Local.sEval,"[CH]",V.Local.fHeight,V.Local.sEval)
	F.Intrinsic.String.Replace(V.Local.sEval,"[MW]",V.Local.fMatWid,V.Local.sEval)
	F.Intrinsic.String.Replace(V.Local.sEval,"[ML]",V.Local.fMatLen,V.Local.sEval)
	F.Intrinsic.String.RegExReplace(V.Local.sEval,"/0","/1",True,True,V.Local.sEval)
	F.Intrinsic.Control.If(V.Local.sEval,<>,"")
		F.Intrinsic.Math.Evaluate(V.Local.sEval,V.Local.fQty1)
	F.Intrinsic.Control.Else
		V.Local.fQty1.Set(0)
	F.Intrinsic.Control.EndIf
	gui.FormShell.txtSide2CutLenDim1.Text(V.Local.fQty1)
F.Intrinsic.Control.EndIf

F.Data.DataView.Close("CrateCalc","Temp")

F.Data.DataView.Create("CrateCalc","Temp",22,"(Dim2Qty like '*[[]MW[]]*' or Dim2Qty like '*[[]ML[]]*') and OpCode = 'SIDE 2'","")

F.Intrinsic.Control.If(V.DataView.CrateCalc!Temp.RowCount--,<>,-1)
	F.Intrinsic.String.Replace(V.DataView.CrateCalc!Temp(V.DataView.CrateCalc!Temp.RowCount--).Dim2Qty!FieldValTrim,"[CL]",V.Local.fLength,V.Local.sEval)
	F.Intrinsic.String.Replace(V.Local.sEval,"[CW]",V.Local.fWidth,V.Local.sEval)
	F.Intrinsic.String.Replace(V.Local.sEval,"[CH]",V.Local.fHeight,V.Local.sEval)
	F.Intrinsic.String.Replace(V.Local.sEval,"[MW]",V.Local.fMatWid,V.Local.sEval)
	F.Intrinsic.String.Replace(V.Local.sEval,"[ML]",V.Local.fMatLen,V.Local.sEval)
	F.Intrinsic.String.RegExReplace(V.Local.sEval,"/0","/1",True,True,V.Local.sEval)
	F.Intrinsic.Control.If(V.Local.sEval,<>,"")
		F.Intrinsic.Math.Evaluate(V.Local.sEval,V.Local.fQty1)
	F.Intrinsic.Control.Else
		V.Local.fQty1.Set(0)
	F.Intrinsic.Control.EndIf
	F.Intrinsic.Math.Int(V.Local.fQty1,V.Local.fTemp1)
	F.Intrinsic.Control.If(V.Local.fQty1,<,V.Local.fTemp1)
		F.Intrinsic.Math.Sub(V.Local.fTemp1.Long,1,V.Local.fQty1)
	F.Intrinsic.Control.Else
		F.Intrinsic.Math.Add(V.Local.fTemp1.Long,1,V.Local.fQty1)
	F.Intrinsic.Control.EndIf
	gui.FormShell.txtSide2QtyDim2.Text(V.Local.fQty1)
F.Intrinsic.Control.EndIf

F.Data.DataView.Close("CrateCalc","Temp")

F.Data.DataView.Create("CrateCalc","Temp",22,"(Dim2Form like '*[[]MW[]]*' or Dim2Form like '*[[]ML[]]*') and OpCode = 'SIDE 2'","")

F.Intrinsic.Control.If(V.DataView.CrateCalc!Temp.RowCount--,<>,-1)
	F.Intrinsic.String.Replace(V.DataView.CrateCalc!Temp(V.DataView.CrateCalc!Temp.RowCount--).Dim2Form!FieldValTrim,"[CL]",V.Local.fLength,V.Local.sEval)
	F.Intrinsic.String.Replace(V.Local.sEval,"[CW]",V.Local.fWidth,V.Local.sEval)
	F.Intrinsic.String.Replace(V.Local.sEval,"[CH]",V.Local.fHeight,V.Local.sEval)
	F.Intrinsic.String.Replace(V.Local.sEval,"[MW]",V.Local.fMatWid,V.Local.sEval)
	F.Intrinsic.String.Replace(V.Local.sEval,"[ML]",V.Local.fMatLen,V.Local.sEval)
	F.Intrinsic.String.RegExReplace(V.Local.sEval,"/0","/1",True,True,V.Local.sEval)
	F.Intrinsic.Control.If(V.Local.sEval,<>,"")
		F.Intrinsic.Math.Evaluate(V.Local.sEval,V.Local.fQty1)
	F.Intrinsic.Control.Else
		V.Local.fQty1.Set(0)
	F.Intrinsic.Control.EndIf
	gui.FormShell.txtSide2CutLenDim2.Text(V.Local.fQty1)
F.Intrinsic.Control.EndIf

F.Data.DataView.Close("CrateCalc","Temp")

F.Intrinsic.Control.ExitSub

F.Intrinsic.Control.Label("ddlSide2Mat_SelectedIndexChanged_Err")
F.Intrinsic.Control.If(V.Ambient.ErrorNumber,<>,0)
	F.Intrinsic.String.Build("Project: GCG_6721_Shell_Crate_Calc.g2u {0}{0}Subroutine: {1}{0}Error Occurred {2} with description {3}",V.Ambient.NewLine,V.Ambient.CurrentSubroutine,V.Ambient.ErrorNumber,V.Ambient.ErrorDescription,V.Local.sError)
	F.Intrinsic.UI.Msgbox(V.Local.sError)
	F.Intrinsic.Control.CallSub(FormShell_UnLoad)
Function.Intrinsic.Control.EndIf
Program.Sub.ddlSide2Mat_SelectedIndexChanged.End

Program.Sub.ddlTopMat_SelectedIndexChanged.Start
F.Intrinsic.Control.SetErrorHandler("ddlTopMat_SelectedIndexChanged_Err")
F.Intrinsic.Control.ClearErrors

V.Local.sError.Declare(String,"")
V.Local.sSql.Declare(String,"")
V.Local.fMatLen.Declare(Float,0)
V.Local.fMatWid.Declare(Float,0)
V.Local.sEval.Declare(String,"")
V.Local.fWidth.Declare(Float,0)
V.Local.fHeight.Declare(Float,0)
V.Local.fLength.Declare(Float,0)
V.Local.fQty1.Declare(Float,0)
V.Local.fTemp1.Declare(Float,0)

V.Local.fLength.Set(V.Screen.FormShell!txtShellLen.Text)
V.Local.fWidth.Set(V.Screen.FormShell!txtShellWidth.Text)
V.Local.fHeight.Set(V.Screen.FormShell!txtShellHeight.Text)

F.ODBC.Connection!Con.OpenCompanyConnection
F.Intrinsic.String.Build("Select Length From V_Inventory_Mst2 Where Part = '{0}'",V.Screen.FormShell!ddlRunMat.Text,V.Local.sSql)
F.ODBC.Connection!con.ExecuteAndReturn(V.Local.sSql,V.Local.fMatLen)
F.Intrinsic.String.Build("Select Width From V_Inventory_Mst2 Where Part = '{0}'",V.Screen.FormShell!ddlRunMat.Text,V.Local.sSql)
F.ODBC.Connection!con.ExecuteAndReturn(V.Local.sSql,V.Local.fMatWid)
F.ODBC.Connection!con.Close

F.Data.DataView.Create("CrateCalc","Temp",22,"(Dim1Qty like '*[[]MW[]]*' or Dim1Qty like '*[[]ML[]]*') and OpCode = 'TOP'","")

F.Intrinsic.Control.If(V.DataView.CrateCalc!Temp.RowCount--,<>,-1)
	F.Intrinsic.String.Replace(V.DataView.CrateCalc!Temp(V.DataView.CrateCalc!Temp.RowCount--).Dim1Qty!FieldValTrim,"[CL]",V.Local.fLength,V.Local.sEval)
	F.Intrinsic.String.Replace(V.Local.sEval,"[CW]",V.Local.fWidth,V.Local.sEval)
	F.Intrinsic.String.Replace(V.Local.sEval,"[CH]",V.Local.fHeight,V.Local.sEval)
	F.Intrinsic.String.Replace(V.Local.sEval,"[MW]",V.Local.fMatWid,V.Local.sEval)
	F.Intrinsic.String.Replace(V.Local.sEval,"[ML]",V.Local.fMatLen,V.Local.sEval)
	F.Intrinsic.String.RegExReplace(V.Local.sEval,"/0","/1",True,True,V.Local.sEval)
	F.Intrinsic.Control.If(V.Local.sEval,<>,"")
		F.Intrinsic.Math.Evaluate(V.Local.sEval,V.Local.fQty1)
	F.Intrinsic.Control.Else
		V.Local.fQty1.Set(0)
	F.Intrinsic.Control.EndIf
	F.Intrinsic.Math.Int(V.Local.fQty1,V.Local.fTemp1)
	F.Intrinsic.Control.If(V.Local.fQty1,<,V.Local.fTemp1)
		F.Intrinsic.Math.Sub(V.Local.fTemp1.Long,1,V.Local.fQty1)
	F.Intrinsic.Control.Else
		F.Intrinsic.Math.Add(V.Local.fTemp1.Long,1,V.Local.fQty1)
	F.Intrinsic.Control.EndIf
	gui.FormShell.txtTopQtyDim1.Text(V.Local.fQty1)
F.Intrinsic.Control.EndIf

F.Data.DataView.Close("CrateCalc","Temp")

F.Data.DataView.Create("CrateCalc","Temp",22,"(Dim1Form like '*[[]MW[]]*' or Dim1Form like '*[[]ML[]]*') and OpCode = 'TOP'","")

F.Intrinsic.Control.If(V.DataView.CrateCalc!Temp.RowCount--,<>,-1)
	F.Intrinsic.String.Replace(V.DataView.CrateCalc!Temp(V.DataView.CrateCalc!Temp.RowCount--).Dim1Form!FieldValTrim,"[CL]",V.Local.fLength,V.Local.sEval)
	F.Intrinsic.String.Replace(V.Local.sEval,"[CW]",V.Local.fWidth,V.Local.sEval)
	F.Intrinsic.String.Replace(V.Local.sEval,"[CH]",V.Local.fHeight,V.Local.sEval)
	F.Intrinsic.String.Replace(V.Local.sEval,"[MW]",V.Local.fMatWid,V.Local.sEval)
	F.Intrinsic.String.Replace(V.Local.sEval,"[ML]",V.Local.fMatLen,V.Local.sEval)
	F.Intrinsic.String.RegExReplace(V.Local.sEval,"/0","/1",True,True,V.Local.sEval)
	F.Intrinsic.Control.If(V.Local.sEval,<>,"")
		F.Intrinsic.Math.Evaluate(V.Local.sEval,V.Local.fQty1)
	F.Intrinsic.Control.Else
		V.Local.fQty1.Set(0)
	F.Intrinsic.Control.EndIf
	gui.FormShell.txtTopCutLenDim1.Text(V.Local.fQty1)
F.Intrinsic.Control.EndIf

F.Data.DataView.Close("CrateCalc","Temp")

F.Data.DataView.Create("CrateCalc","Temp",22,"(Dim2Qty like '*[[]MW[]]*' or Dim2Qty like '*[[]ML[]]*') and OpCode = 'TOP'","")

F.Intrinsic.Control.If(V.DataView.CrateCalc!Temp.RowCount--,<>,-1)
	F.Intrinsic.String.Replace(V.DataView.CrateCalc!Temp(V.DataView.CrateCalc!Temp.RowCount--).Dim2Qty!FieldValTrim,"[CL]",V.Local.fLength,V.Local.sEval)
	F.Intrinsic.String.Replace(V.Local.sEval,"[CW]",V.Local.fWidth,V.Local.sEval)
	F.Intrinsic.String.Replace(V.Local.sEval,"[CH]",V.Local.fHeight,V.Local.sEval)
	F.Intrinsic.String.Replace(V.Local.sEval,"[MW]",V.Local.fMatWid,V.Local.sEval)
	F.Intrinsic.String.Replace(V.Local.sEval,"[ML]",V.Local.fMatLen,V.Local.sEval)
	F.Intrinsic.String.RegExReplace(V.Local.sEval,"/0","/1",True,True,V.Local.sEval)
	F.Intrinsic.Control.If(V.Local.sEval,<>,"")
		F.Intrinsic.Math.Evaluate(V.Local.sEval,V.Local.fQty1)
	F.Intrinsic.Control.Else
		V.Local.fQty1.Set(0)
	F.Intrinsic.Control.EndIf
	F.Intrinsic.Math.Int(V.Local.fQty1,V.Local.fTemp1)
	F.Intrinsic.Control.If(V.Local.fQty1,<,V.Local.fTemp1)
		F.Intrinsic.Math.Sub(V.Local.fTemp1.Long,1,V.Local.fQty1)
	F.Intrinsic.Control.Else
		F.Intrinsic.Math.Add(V.Local.fTemp1.Long,1,V.Local.fQty1)
	F.Intrinsic.Control.EndIf
	gui.FormShell.txtTopQtyDim2.Text(V.Local.fQty1)
F.Intrinsic.Control.EndIf

F.Data.DataView.Close("CrateCalc","Temp")

F.Data.DataView.Create("CrateCalc","Temp",22,"(Dim2Form like '*[[]MW[]]*' or Dim2Form like '*[[]ML[]]*') and OpCode = 'TOP'","")

F.Intrinsic.Control.If(V.DataView.CrateCalc!Temp.RowCount--,<>,-1)
	F.Intrinsic.String.Replace(V.DataView.CrateCalc!Temp(V.DataView.CrateCalc!Temp.RowCount--).Dim2Form!FieldValTrim,"[CL]",V.Local.fLength,V.Local.sEval)
	F.Intrinsic.String.Replace(V.Local.sEval,"[CW]",V.Local.fWidth,V.Local.sEval)
	F.Intrinsic.String.Replace(V.Local.sEval,"[CH]",V.Local.fHeight,V.Local.sEval)
	F.Intrinsic.String.Replace(V.Local.sEval,"[MW]",V.Local.fMatWid,V.Local.sEval)
	F.Intrinsic.String.Replace(V.Local.sEval,"[ML]",V.Local.fMatLen,V.Local.sEval)
	F.Intrinsic.String.RegExReplace(V.Local.sEval,"/0","/1",True,True,V.Local.sEval)
	F.Intrinsic.Control.If(V.Local.sEval,<>,"")
		F.Intrinsic.Math.Evaluate(V.Local.sEval,V.Local.fQty1)
	F.Intrinsic.Control.Else
		V.Local.fQty1.Set(0)
	F.Intrinsic.Control.EndIf
	gui.FormShell.txtTopCutLenDim2.Text(V.Local.fQty1)
F.Intrinsic.Control.EndIf

F.Data.DataView.Close("CrateCalc","Temp")

F.Intrinsic.Control.ExitSub

F.Intrinsic.Control.Label("ddlTopMat_SelectedIndexChanged_Err")
F.Intrinsic.Control.If(V.Ambient.ErrorNumber,<>,0)
	F.Intrinsic.String.Build("Project: GCG_6721_Shell_Crate_Calc.g2u {0}{0}Subroutine: {1}{0}Error Occurred {2} with description {3}",V.Ambient.NewLine,V.Ambient.CurrentSubroutine,V.Ambient.ErrorNumber,V.Ambient.ErrorDescription,V.Local.sError)
	F.Intrinsic.UI.Msgbox(V.Local.sError)
	F.Intrinsic.Control.CallSub(FormShell_UnLoad)
Function.Intrinsic.Control.EndIf
Program.Sub.ddlTopMat_SelectedIndexChanged.End

Program.Sub.Get_Shell_Runtime.Start
F.Intrinsic.Control.SetErrorHandler("Get_Shell_Runtime_Err")
F.Intrinsic.Control.ClearErrors

V.Local.sError.Declare(String,"")
V.Local.fTemp1.Declare(Float,0)
V.Local.fTemp2.Declare(Float,0)
V.Local.fTemp3.Declare(Float,0)
V.Local.fSqft.Declare(Float,0)
V.Local.fMLen.Declare(Float,0)
V.Local.fMWid.Declare(Float,0)
V.Local.fCL.Declare(Float,0)
V.Local.fCW.Declare(Float,0)
V.Local.fCH.Declare(Float,0)
V.Local.fCP1.Declare(Float,0)
V.Local.fCP2.Declare(Float,0)
V.Local.sEval.Declare(String,"")
V.Local.fRunTime.Declare(Float,0)
V.Local.fRunTime1.Declare(Float,0)
V.Local.fRunTime2.Declare(Float,0)
V.Local.sCuts.Declare(String,"")
V.Local.sTemp.Declare(String,"")
V.Local.fRemLen.Declare(Float,0)
V.Local.fRemWid.Declare(Float,0)
V.Local.sTempCut1.Declare(String,"")
V.Local.sTempCut2.Declare(String,"")
V.Local.sTempCut3.Declare(String,"")
V.Local.sTempCut4.Declare(String,"")
V.Local.fTempRunTime1.Declare(Float,0)
V.Local.fHalfLen.Declare(Float,0)
V.Local.fHalfWid.Declare(Float,0)

V.Local.fCL.Set(V.Screen.FormShell!txtShellLen.Text)
V.Local.fCW.Set(V.Screen.FormShell!txtShellWidth.Text)
V.Local.fCH.Set(V.Screen.FormShell!txtShellHeight.Text)

V.Local.fMWid.Set(V.Args.Wid)
F.Intrinsic.Math.Div(V.Local.fMWid,2,V.Local.fHalfWid)
V.Local.fMLen.Set(V.Args.Len)
F.Intrinsic.Math.Div(V.Local.fMLen,2,V.Local.fHalfLen)

F.Intrinsic.Control.SelectCase(V.DataView.RLine!MLine(V.Args.Index).Operation!FieldValTrim)
	F.Intrinsic.Control.Case("SIDE 1")
		V.Local.fCP1.Set(V.Screen.FormShell!txtSide1QtyDim1.Text)
		V.Local.fCP2.Set(V.Screen.FormShell!txtSide1QtyDim2.Text)
		V.Local.fRunTime1.Set(V.Screen.FormShell!txtSide1CutLenDim1.Text)
		V.Local.fRunTime2.Set(V.Screen.FormShell!txtSide1CutLenDim2.Text)
		
	F.Intrinsic.Control.Case("SIDE 2")
		V.Local.fCP1.Set(V.Screen.FormShell!txtSide2QtyDim1.Text)
		V.Local.fCP2.Set(V.Screen.FormShell!txtSide2QtyDim2.Text)
		V.Local.fRunTime1.Set(V.Screen.FormShell!txtSide2CutLenDim1.Text)
		V.Local.fRunTime2.Set(V.Screen.FormShell!txtSide2CutLenDim2.Text)	
			
	F.Intrinsic.Control.Case("TOP")
		V.Local.fCP1.Set(V.Screen.FormShell!txtTopQtyDim1.Text)
		V.Local.fCP2.Set(V.Screen.FormShell!txtTopQtyDim2.Text)
		V.Local.fRunTime1.Set(V.Screen.FormShell!txtTopCutLenDim1.Text)
		V.Local.fRunTime2.Set(V.Screen.FormShell!txtTopCutLenDim2.Text)		
			
	F.Intrinsic.Control.Case("T STRG")
		V.Local.fCP1.Set(V.Screen.FormShell!txtTStrgQty.Text)
		V.Local.fRunTime1.Set(V.Screen.FormShell!txtTStrg.Text)	
		V.Local.fCP2.Set(0)
		V.Local.fRunTime2.Set(0)
		
	F.Intrinsic.Control.Case("B STRG")
		V.Local.fCP1.Set(V.Screen.FormShell!txtBstrgQty.Text)
		V.Local.fRunTime1.Set(V.Screen.FormShell!txtBStrg.Text)		
		V.Local.fCP2.Set(0)
		V.Local.fRunTime2.Set(0)
		
	F.Intrinsic.Control.Case("RUN")
		V.Local.fCP1.Set(V.Screen.FormShell!txtRunQty.Text)
		V.Local.fRunTime1.Set(V.Screen.FormShell!txtLRun.Text)	
		V.Local.fCP2.Set(0)
		V.Local.fRunTime2.Set(0)
		
F.Intrinsic.Control.EndSelect

F.Intrinsic.Control.If(V.Local.fCP1,>,0,"AND",V.Local.fCP2,>,0)
	V.Local.fTemp1.Set(V.Local.fRunTime1)
	V.Local.fTemp2.Set(V.Local.fRunTime2)
	F.Intrinsic.Math.Mult(V.Local.fCP1,V.Local.fRunTime1,V.Local.fRunTime1)
	F.Intrinsic.Math.Mult(V.Local.fCP2,V.Local.fRunTime2,V.Local.fRunTime2)
	F.Intrinsic.Math.Add(V.Local.fRunTime1,V.Local.fRunTime2,V.Local.fRunTime)
	F.Intrinsic.Math.Div(V.Local.fRunTime,V.Local.fMLen,V.Local.fRunTime)
	
	F.Intrinsic.Control.If(V.Local.fTemp1,>,V.Local.fMLen)
		F.Intrinsic.String.Build("{0}: {1}",V.Local.fCP1,V.Local.fMLen,V.Local.sTempCut1)
		F.Intrinsic.Math.Sub(V.Local.fTemp1,V.Local.fMLen,V.Local.fTemp3)
		F.Intrinsic.String.Build("{0} | {1}: {2}",V.Local.sTempCut1,V.Local.fCP1,V.Local.fTemp3,V.Local.sTempCut1)
	F.Intrinsic.Control.EndIf
	F.Intrinsic.Control.If(V.Local.fTemp1,<,V.Local.fMLen)
		F.Intrinsic.String.Build("{0}: {1}",V.Local.fCP1,V.Local.fTemp1,V.Local.sTempCut1)
	F.Intrinsic.Control.EndIf
	F.Intrinsic.Control.If(V.Local.fTemp2,>,V.Local.fMLen)
		F.Intrinsic.String.Build("{0}: {1}",V.Local.fCP2,V.Local.fMLen,V.Local.sTempCut2)
		F.Intrinsic.Math.Sub(V.Local.fTemp2,V.Local.fMLen,V.Local.fTemp3)
		F.Intrinsic.String.Build("{0} | {1}: {2}",V.Local.sTempCut2,V.Local.fCP2,V.Local.fTemp3,V.Local.sTempCut2)
	F.Intrinsic.Control.EndIf
	F.Intrinsic.Control.If(V.Local.fTemp2,<,V.Local.fMLen)
		F.Intrinsic.String.Build("{0}: {1}",V.Local.fCP2,V.Local.fTemp2,V.Local.sTempCut2)
	F.Intrinsic.Control.EndIf
	
	F.Intrinsic.String.Build("{0} | {1}",V.Local.sTempCut1,V.Local.sTempCut2,V.Local.sCuts)
	
F.Intrinsic.Control.ElseIf(V.Local.fCP1,>,0,"AND",V.Local.fCP2,<=,0)
	V.Local.fTemp1.Set(V.Local.fRunTime1)
	F.Intrinsic.Math.Mult(V.Local.fCP1,V.Local.fRunTime1,V.Local.fRunTime1)
	V.Local.fRunTime.Set(V.Local.fRunTime1)
	F.Intrinsic.Math.Div(V.Local.fRunTime,V.Local.fMLen,V.Local.fRunTime)
	F.Intrinsic.Control.If(V.Local.fTemp1,>,V.Local.fMLen)
		F.Intrinsic.String.Build("{0}: {1}",V.Local.fCP1,V.Local.fMLen,V.Local.sCuts)
		F.Intrinsic.Math.Sub(V.Local.fTemp1,V.Local.fMLen,V.Local.fTemp3)
		F.Intrinsic.String.Build("{0} | {1}: {2}",V.Local.sCuts,V.Local.fCP1,V.Local.fTemp3,V.Local.sCuts)
	F.Intrinsic.Control.ElseIf(V.Local.fTemp1,<,V.Local.fMLen)
		F.Intrinsic.String.Build("{0}: {1}",V.Local.fCP1,V.Local.fTemp1,V.Local.sCuts)
	F.Intrinsic.Control.EndIf
	
F.Intrinsic.Control.ElseIf(V.Local.fCP1,<=,0,"AND",V.Local.fCP2,>,0)
	V.Local.fTemp1.Set(V.Local.fRunTime2)
	F.Intrinsic.Math.Mult(V.Local.fCP2,V.Local.fRunTime2,V.Local.fRunTime2)
	V.Local.fRunTime.Set(V.Local.fRunTime2)
	F.Intrinsic.Math.Div(V.Local.fRunTime,V.Local.fMLen,V.Local.fRunTime)
	F.Intrinsic.Control.If(V.Local.fTemp1,>,V.Local.fMLen)
		F.Intrinsic.String.Build("{0}: {1}",V.Local.fCP1,V.Local.fMLen,V.Local.sCuts)
		F.Intrinsic.Math.Sub(V.Local.fTemp1,V.Local.fMLen,V.Local.fTemp3)
		F.Intrinsic.String.Build("{0} | {1}: {2}",V.Local.sCuts,V.Local.fCP1,V.Local.fTemp3,V.Local.sCuts)
	F.Intrinsic.Control.ElseIf(V.Local.fTemp1,<,V.Local.fMLen)
		F.Intrinsic.String.Build("{0}: {1}",V.Local.fCP1,V.Local.fTemp1,V.Local.sCuts)
	F.Intrinsic.Control.EndIf
	
F.Intrinsic.Control.EndIf
			
F.Intrinsic.Variable.AddRV("RunTime",V.Local.fRunTime,"Cuts",V.Local.sCuts)

F.Intrinsic.Control.ExitSub

F.Intrinsic.Control.Label("Get_Shell_Runtime_Err")
F.Intrinsic.Control.If(V.Ambient.ErrorNumber,<>,0)
	F.Intrinsic.String.Build("Project: GCG_6721_Shell_Crate_Calc.g2u {0}{0}Subroutine: {1}{0}Error Occurred {2} with description {3}",V.Ambient.NewLine,V.Ambient.CurrentSubroutine,V.Ambient.ErrorNumber,V.Ambient.ErrorDescription,V.Local.sError)
	F.Intrinsic.UI.Msgbox(V.Local.sError)
	F.Intrinsic.Control.CallSub(FormShell_UnLoad)
Function.Intrinsic.Control.EndIf
Program.Sub.Get_Shell_Runtime.End

Program.Sub.FormShell_SaveButtonClick.Start
F.Intrinsic.Control.SetErrorHandler("FormShell_SaveButtonClick_Err")
F.Intrinsic.Control.ClearErrors

V.Local.sError.Declare(String,"")
V.Local.iRet.Declare(Long,0)
V.Local.i.Declare(Long,0)
V.Local.iC.Declare(Long,0)
V.Local.sDesc.Declare(String,"")
V.Local.sFilter.Declare(String,"")
V.Local.sComment.Declare(String,"")
V.Local.iSeq.Declare(Long,0)
V.Local.sSeq.Declare(String,"")
V.Local.sSql.Declare(String,"")
V.Local.sPart.Declare(String,"")
V.Local.sRunTime.Declare(String,"")
V.Local.sRate.Declare(String,"")
V.Local.sSetup.Declare(String,"")
V.Local.sPL.Declare(String,"")
V.Local.sUM.Declare(String,"")
V.Local.sDate.Declare(String,"")
V.Local.sMDesc.Declare(String,"")

F.Intrinsic.String.Format(V.Ambient.Date,"MMDDYY",V.Local.sDate)

F.Intrinsic.String.Build("{3} Crate {0}x{1}x{2}",V.Screen.FormShell!txtShellLen.Text,V.Screen.FormShell!txtShellWidth.Text,V.Screen.FormShell!txtShellHeight.Text,V.Global.sSort,V.Local.sDesc)

F.Intrinsic.Control.If(V.Local.sDesc.Length,>,30)
	F.Intrinsic.String.Left(V.Local.sDesc,30,V.Local.sDesc)
F.Intrinsic.Control.EndIf

F.ODBC.Connection!Con.OpenCompanyConnection
F.Intrinsic.String.Build("Select Part From V_Inventory_Mstr Where Part = '{0}'",V.DataTable.dtRouter(V.DataTable.dtRouter.RowCount--).Router!FieldValTrim,V.Local.sSql)
F.ODBC.Connection!Con.ExecuteAndReturn(V.Local.sSql,V.Local.sPart)

V.Local.sPL.Set(V.DataTable.RHeader(V.DataTable.RHeader.RowCount--).Prod_Line!FieldValTrim)
V.Local.sUM.Set(V.DataTable.RHeader(V.DataTable.RHeader.RowCount--).UM_Inventory!FieldValTrim)

F.Intrinsic.Control.If(V.Local.sPart.Trim,=,V.DataTable.dtRouter(V.DataTable.dtRouter.RowCount--).Router!FieldValTrim)
	F.Global.Inventory.CreatePart(V.DataTable.dtRouter(V.DataTable.dtRouter.RowCount--).Router!FieldValTrim,V.DataTable.RHeader(V.DataTable.RHeader.RowCount--).UM_Inventory!FieldValTrim,V.Local.sDesc,"",V.DataTable.RHeader(V.DataTable.RHeader.RowCount--).Prod_Line!FieldValTrim,"","","",0,"NOMAINT")
F.Intrinsic.Control.EndIf

F.Intrinsic.Control.If(V.DataTable.dtRouter.RowCount--,<>,-1)
	F.Intrinsic.UI.Msgbox("Are you sure you want to create a New Part/Router?","New Part/Router",4,V.Local.iRet)
	F.Intrinsic.Control.If(V.Local.iRet,=,6)
		F.Intrinsic.Control.For(V.Local.i,0,V.DataTable.RLine.RowCount--,1)
			F.Intrinsic.Control.SelectCase(V.DataTable.RLine(V.Local.i).LMO!FieldValTrim)
				F.Intrinsic.Control.Case("L")
					F.Intrinsic.Math.Add(V.Local.iSeq,V.Global.lOp,V.Local.iSeq)
					F.Intrinsic.String.Format(V.Local.iSeq,"000000",V.Local.sSeq)
					F.Intrinsic.String.Format(V.DataTable.RLine(V.Local.i).Run_Time!FieldVal,"#0.0000",V.Local.sRunTime)
					F.Intrinsic.String.Format(V.DataTable.RLine(V.Local.i).Rate!FieldVal,"#0.0000",V.Local.sRate)
					F.Intrinsic.String.Format(V.DataTable.RLine(V.Local.i).Set_Up!FieldVal,"#0.0000",V.Local.sSetup)
					F.Data.DataTable.AddRow("6021","OriginalDate",V.Local.sDate,"RouterNum",V.DataTable.dtRouter(V.DataTable.dtRouter.RowCount--).Router!FieldValTrim,"RouterDesc",V.Local.sDesc,"RunTimeMatlQty",V.Local.sRunTime,"RateUC",V.Local.sRate,"SetupQty",V.Local.sSetup,"Seq",V.Local.sSeq,"LineType","L","WC",V.DataTable.RLine(V.Local.i).Part_WC_Outside!FieldValTrim,"PartStepDesc",V.DataTable.RLine(V.Local.i).Desc_Rt_Line!FieldValTrim,"UM",V.DataTable.RLine(V.Local.i).UM_Inventory!FieldValTrim,"PL",V.DataTable.RHeader(V.DataTable.RHeader.RowCount--).Prod_Line!FieldValTrim)
					
				F.Intrinsic.Control.Case("M")
					F.Intrinsic.Math.Add(V.Local.iSeq,V.Global.lOp,V.Local.iSeq)
					F.Intrinsic.String.Format(V.Local.iSeq,"000000",V.Local.sSeq)
					F.Intrinsic.String.Build("Line_Router = '{0}'",V.DataTable.RLine(V.Local.i).Line_Router!FieldValTrim,V.Local.sFilter)
					F.Data.DataView.Create("dtRouter","MTemp",22,V.Local.sFilter,"")
					F.Intrinsic.Control.If(V.DataView.dtRouter!MTemp.RowCount--,<>,-1)
						F.Intrinsic.String.Format(V.DataView.dtRouter!MTemp(V.DataView.dtRouter!MTemp.RowCount--).Run_Time!FieldVal,"#0.0000",V.Local.sRunTime)
						F.Intrinsic.String.Format(V.DataView.dtRouter!MTemp(V.DataView.dtRouter!MTemp.RowCount--).Rate!FieldVal,"#0.0000",V.Local.sRate)
						F.Intrinsic.String.Format(V.DataView.dtRouter!MTemp(V.DataView.dtRouter!MTemp.RowCount--).Set_Up!FieldVal,"#0.0000",V.Local.sSetup)
						F.Intrinsic.String.Build("Select Description From V_Inventory_Mstr Where Part = '{0}'",V.DataView.dtRouter!MTemp(V.DataView.dtRouter!MTemp.RowCount--).Part_WC_Outside!FieldValTrim,V.Local.sSql)
						F.ODBC.Connection!Con.ExecuteAndReturn(V.Local.sSql,V.Local.sMDesc)
						F.Data.DataTable.AddRow("6021","OriginalDate",V.Local.sDate,"RouterNum",V.DataTable.dtRouter(V.DataTable.dtRouter.RowCount--).Router!FieldValTrim,"RouterDesc",V.Local.sDesc,"RunTimeMatlQty",V.Local.sRunTime,"RateUC",V.Local.sRate,"SetupQty",V.Local.sSetup,"Seq",V.Local.sSeq,"LineType","M","PartNum",V.DataView.dtRouter!MTemp(V.DataView.dtRouter!MTemp.RowCount--).Part_WC_Outside!FieldValTrim,"PartStepDesc",V.Local.sMDesc.Trim,"UM",V.DataTable.RLine(V.Local.i).UM_Inventory!FieldValTrim,"PL",V.DataTable.RHeader(V.DataTable.RHeader.RowCount--).Prod_Line!FieldValTrim)
					F.Intrinsic.Control.EndIf
					F.Data.DataView.Close("dtRouter","MTemp")
					
				F.Intrinsic.Control.Case("O")
					F.Intrinsic.Math.Add(V.Local.iSeq,V.Global.lOp,V.Local.iSeq)
					F.Intrinsic.String.Format(V.Local.iSeq,"000000",V.Local.sSeq)
					F.Intrinsic.String.Format(V.DataTable.RLine(V.Local.i).Run_Time!FieldVal,"#0.0000",V.Local.sRunTime)
					F.Intrinsic.String.Format(V.DataTable.RLine(V.Local.i).Rate!FieldVal,"#0.0000",V.Local.sRate)
					F.Intrinsic.String.Format(V.DataTable.RLine(V.Local.i).Set_Up!FieldVal,"#0.0000",V.Local.sSetup)
					F.Data.DataTable.AddRow("6021","OriginalDate",V.Local.sDate,"RouterNum",V.DataTable.dtRouter(V.DataTable.dtRouter.RowCount--).Router!FieldValTrim,"RouterDesc",V.Local.sDesc,"RunTimeMatlQty",V.Local.sRunTime,"RateUC",V.Local.sRate,"SetupQty",V.Local.sSetup,"Seq",V.Local.sSeq,"LineType","O","PartNum",V.DataTable.RLine(V.Local.i).Part_WC_Outside!FieldValTrim,"PartStepDesc",V.DataTable.RLine(V.Local.i).Desc_Rt_Line!FieldValTrim,"UM",V.DataTable.RLine(V.Local.i).UM_Inventory!FieldValTrim,"PL",V.DataTable.RHeader(V.DataTable.RHeader.RowCount--).Prod_Line!FieldValTrim)
					
				F.Intrinsic.Control.Case("C")
					F.Intrinsic.String.Format("0","#0.0000",V.Local.sRunTime)
					F.Intrinsic.String.Format("0","#0.0000",V.Local.sRate)
					F.Intrinsic.String.Format("0","#0.0000",V.Local.sSetup)
					V.Local.sComment.Redim(0,0)
					F.Intrinsic.String.Build("Line_Router = '{0}' and LMO = 'M'",V.DataTable.RLine(V.Local.i).Operation!FieldValTrim,V.Local.sFilter)
					F.Data.DataView.Create("dtRouter","MTemp",22,V.Local.sFilter,"")
					
					F.Intrinsic.Control.If(V.DataView.dtRouter!MTemp.RowCount--,<>,-1)
						F.Intrinsic.String.Split(V.DataView.dtRouter!MTemp(V.DataView.dtRouter!MTemp.RowCount--).Cuts!FieldValTrim,"|",V.Local.sComment)
						F.Intrinsic.Control.For(V.Local.iC,0,V.Local.sComment.UBound,1)
							F.Intrinsic.Math.Add(V.Local.iSeq,V.Global.lOp,V.Local.iSeq)
							F.Intrinsic.String.Format(V.Local.iSeq,"000000",V.Local.sSeq)
							F.Data.DataTable.AddRow("6021","OriginalDate",V.Local.sDate,"RouterNum",V.DataTable.dtRouter(V.DataTable.dtRouter.RowCount--).Router!FieldValTrim,"RouterDesc",V.Local.sDesc,"RunTimeMatlQty",V.Local.sRunTime,"RateUC",V.Local.sRate,"SetupQty",V.Local.sSetup,"Seq",V.Local.sSeq,"LineType","C","PartStepDesc",V.Local.sComment(V.Local.iC).Trim,"PL",V.DataTable.RHeader(V.DataTable.RHeader.RowCount--).Prod_Line!FieldValTrim,"Freq", "0", "WCFactor", "0", "Overlap", "0", "LeadTime", "0", "MainCommentFlag", "Y")
						F.Intrinsic.Control.Next(V.Local.iC)
					F.Intrinsic.Control.Else
						F.Intrinsic.Control.If(V.DataTable.RLine(V.Local.i).Operation!FieldValTrim,=,"")
							F.Intrinsic.Math.Add(V.Local.iSeq,V.Global.lOp,V.Local.iSeq)
							F.Intrinsic.String.Format(V.Local.iSeq,"000000",V.Local.sSeq)
							F.Data.DataTable.AddRow("6021","OriginalDate",V.Local.sDate,"RouterNum",V.DataTable.dtRouter(V.DataTable.dtRouter.RowCount--).Router!FieldValTrim,"RouterDesc",V.Local.sDesc,"RunTimeMatlQty",V.Local.sRunTime,"RateUC",V.Local.sRate,"SetupQty",V.Local.sSetup,"Seq",V.Local.sSeq,"LineType","C","PartStepDesc",V.DataTable.RLine(V.Local.i).Desc_Rt_Line!FieldValTrim,"PL",V.DataTable.RHeader(V.DataTable.RHeader.RowCount--).Prod_Line!FieldValTrim,"Freq", "0", "WCFactor", "0", "Overlap", "0", "LeadTime", "0", "MainCommentFlag", "Y")
						F.Intrinsic.Control.Else
							F.Intrinsic.Control.If(V.DataTable.RLine(V.Local.i).Operation!FieldValTrim,=,"BOLT")
								F.Intrinsic.Math.Add(V.Local.iSeq,V.Global.lOp,V.Local.iSeq)
								F.Intrinsic.String.Format(V.Local.iSeq,"000000",V.Local.sSeq)
								F.Intrinsic.Control.If(V.Screen.FormShell!chkBoltTopRun.Value,=,1)
									F.Data.DataTable.AddRow("6021","OriginalDate",V.Local.sDate,"RouterNum",V.DataTable.dtRouter(V.DataTable.dtRouter.RowCount--).Router!FieldValTrim,"RouterDesc",V.Local.sDesc,"RunTimeMatlQty",V.Local.sRunTime,"RateUC",V.Local.sRate,"SetupQty",V.Local.sSetup,"Seq",V.Local.sSeq,"LineType","C","PartStepDesc","Bolt Top Runners: Yes","PL",V.DataTable.RHeader(V.DataTable.RHeader.RowCount--).Prod_Line!FieldValTrim,"Freq", "0", "WCFactor", "0", "Overlap", "0", "LeadTime", "0", "MainCommentFlag", "Y")
								F.Intrinsic.Control.Else
									F.Data.DataTable.AddRow("6021","OriginalDate",V.Local.sDate,"RouterNum",V.DataTable.dtRouter(V.DataTable.dtRouter.RowCount--).Router!FieldValTrim,"RouterDesc",V.Local.sDesc,"RunTimeMatlQty",V.Local.sRunTime,"RateUC",V.Local.sRate,"SetupQty",V.Local.sSetup,"Seq",V.Local.sSeq,"LineType","C","PartStepDesc","Bolt Top Runners: No","PL",V.DataTable.RHeader(V.DataTable.RHeader.RowCount--).Prod_Line!FieldValTrim,"Freq", "0", "WCFactor", "0", "Overlap", "0", "LeadTime", "0", "MainCommentFlag", "Y")
								F.Intrinsic.Control.EndIf
							F.Intrinsic.Control.ElseIf(V.DataTable.RLine(V.Local.i).Operation!FieldValTrim,=,"LAG")
								F.Intrinsic.Math.Add(V.Local.iSeq,V.Global.lOp,V.Local.iSeq)
								F.Intrinsic.String.Format(V.Local.iSeq,"000000",V.Local.sSeq)
								F.Intrinsic.Control.If(V.Screen.FormShell!chkLagString.Value,=,1)
									F.Data.DataTable.AddRow("6021","OriginalDate",V.Local.sDate,"RouterNum",V.DataTable.dtRouter(V.DataTable.dtRouter.RowCount--).Router!FieldValTrim,"RouterDesc",V.Local.sDesc,"RunTimeMatlQty",V.Local.sRunTime,"RateUC",V.Local.sRate,"SetupQty",V.Local.sSetup,"Seq",V.Local.sSeq,"LineType","C","PartStepDesc","Lag Stringers: Yes","PL",V.DataTable.RHeader(V.DataTable.RHeader.RowCount--).Prod_Line!FieldValTrim,"Freq", "0", "WCFactor", "0", "Overlap", "0", "LeadTime", "0", "MainCommentFlag", "Y")
								F.Intrinsic.Control.Else
									F.Data.DataTable.AddRow("6021","OriginalDate",V.Local.sDate,"RouterNum",V.DataTable.dtRouter(V.DataTable.dtRouter.RowCount--).Router!FieldValTrim,"RouterDesc",V.Local.sDesc,"RunTimeMatlQty",V.Local.sRunTime,"RateUC",V.Local.sRate,"SetupQty",V.Local.sSetup,"Seq",V.Local.sSeq,"LineType","C","PartStepDesc","Lag Stringers: No","PL",V.DataTable.RHeader(V.DataTable.RHeader.RowCount--).Prod_Line!FieldValTrim,"Freq", "0", "WCFactor", "0", "Overlap", "0", "LeadTime", "0", "MainCommentFlag", "Y")
								F.Intrinsic.Control.EndIf
								V.Local.sComment.Set(V.Screen.FormShell!txtNotes.Text)
								F.Intrinsic.Control.If(V.Local.sComment.Trim,<>,"")
									F.Intrinsic.Math.Add(V.Local.iSeq,V.Global.lOp,V.Local.iSeq)
									F.Intrinsic.String.Format(V.Local.iSeq,"000000",V.Local.sSeq)
									F.Data.DataTable.AddRow("6021","OriginalDate",V.Local.sDate,"RouterNum",V.DataTable.dtRouter(V.DataTable.dtRouter.RowCount--).Router!FieldValTrim,"RouterDesc",V.Local.sDesc,"RunTimeMatlQty",V.Local.sRunTime,"RateUC",V.Local.sRate,"SetupQty",V.Local.sSetup,"Seq",V.Local.sSeq,"LineType","C","PartStepDesc",V.Local.sComment,"PL",V.DataTable.RHeader(V.DataTable.RHeader.RowCount--).Prod_Line!FieldValTrim,"Freq", "0", "WCFactor", "0", "Overlap", "0", "LeadTime", "0", "MainCommentFlag", "Y")
								F.Intrinsic.Control.EndIf
							F.Intrinsic.Control.ElseIf(V.DataTable.RLine(V.Local.i).Operation!FieldValTrim,=,"STAMP")
								F.Intrinsic.Math.Add(V.Local.iSeq,V.Global.lOp,V.Local.iSeq)
								F.Intrinsic.String.Format(V.Local.iSeq,"000000",V.Local.sSeq)
								F.Intrinsic.Control.If(V.Screen.FormShell!chkShellHT.Value,=,1)
									F.Data.DataTable.AddRow("6021","OriginalDate",V.Local.sDate,"RouterNum",V.DataTable.dtRouter(V.DataTable.dtRouter.RowCount--).Router!FieldValTrim,"RouterDesc",V.Local.sDesc,"RunTimeMatlQty",V.Local.sRunTime,"RateUC",V.Local.sRate,"SetupQty",V.Local.sSetup,"Seq",V.Local.sSeq,"LineType","C","PartStepDesc","HT Stamp: Yes","PL",V.DataTable.RHeader(V.DataTable.RHeader.RowCount--).Prod_Line!FieldValTrim,"Freq", "0", "WCFactor", "0", "Overlap", "0", "LeadTime", "0", "MainCommentFlag", "Y")
								F.Intrinsic.Control.Else
									F.Data.DataTable.AddRow("6021","OriginalDate",V.Local.sDate,"RouterNum",V.DataTable.dtRouter(V.DataTable.dtRouter.RowCount--).Router!FieldValTrim,"RouterDesc",V.Local.sDesc,"RunTimeMatlQty",V.Local.sRunTime,"RateUC",V.Local.sRate,"SetupQty",V.Local.sSetup,"Seq",V.Local.sSeq,"LineType","C","PartStepDesc","HT Stamp: No","PL",V.DataTable.RHeader(V.DataTable.RHeader.RowCount--).Prod_Line!FieldValTrim,"Freq", "0", "WCFactor", "0", "Overlap", "0", "LeadTime", "0", "MainCommentFlag", "Y")
								F.Intrinsic.Control.EndIf
							F.Intrinsic.Control.Else
								F.Intrinsic.Math.Add(V.Local.iSeq,V.Global.lOp,V.Local.iSeq)
								F.Intrinsic.String.Format(V.Local.iSeq,"000000",V.Local.sSeq)
								F.Data.DataTable.AddRow("6021","OriginalDate",V.Local.sDate,"RouterNum",V.DataTable.dtRouter(V.DataTable.dtRouter.RowCount--).Router!FieldValTrim,"RouterDesc",V.Local.sDesc,"RunTimeMatlQty",V.Local.sRunTime,"RateUC",V.Local.sRate,"SetupQty",V.Local.sSetup,"Seq",V.Local.sSeq,"LineType","C","PartStepDesc",V.DataTable.RLine(V.Local.i).PartStepDesc!FieldValTrim,"PL",V.DataTable.RHeader(V.DataTable.RHeader.RowCount--).Prod_Line!FieldValTrim,"Freq", "0", "WCFactor", "0", "Overlap", "0", "LeadTime", "0", "MainCommentFlag", "Y")
							F.Intrinsic.Control.EndIf
						F.Intrinsic.Control.EndIf
					F.Intrinsic.Control.EndIf
					F.Data.DataView.Close("dtRouter","MTemp")
			F.Intrinsic.Control.EndSelect
		F.Intrinsic.Control.Next(V.Local.i)
	F.Intrinsic.Control.Else
		F.Intrinsic.Control.ExitSub
	F.Intrinsic.Control.EndIf
F.Intrinsic.Control.EndIf

F.Intrinsic.Control.If(V.DataTable.6021.RowCount--,<>,-1)
	F.Intrinsic.String.Build("Select Router From V_Router_Header Where Router = '{0}'",V.DataTable.dtRouter(V.DataTable.dtRouter.RowCount--).Router!FieldValTrim,V.Local.sSql)
	F.ODBC.Connection!Con.ExecuteAndReturn(V.Local.sSql,V.Local.sPart)

	F.Intrinsic.Control.If(V.Local.sPart.Trim,<>,"")
		F.Intrinsic.String.Build("Delete From Router_Header Where Router = '{0}'",V.DataTable.dtRouter(V.DataTable.dtRouter.RowCount--).Router!FieldValTrim,V.Local.sSql)
		F.ODBC.Connection!Con.Execute(V.Local.sSql)
		F.Intrinsic.String.Build("Delete From ROUTER_SUPP_HDR Where Rtr_Num = '{0}'",V.DataTable.dtRouter(V.DataTable.dtRouter.RowCount--).Router!FieldValTrim,V.Local.sSql)
		F.ODBC.Connection!Con.Execute(V.Local.sSql)
	F.Intrinsic.Control.EndIf

	F.Intrinsic.Control.CallSub(6021Sync)
F.Intrinsic.Control.EndIf

F.ODBC.Connection!con.Close

F.Data.Datatable.DeleteRow("6021")
F.Data.Datatable.AcceptChanges("6021")

'F.Global.General.CallWrappersync(50,"RE0017")

F.Data.DataTable.AddRow("400000","Mode","O","Router",V.DataTable.dtRouter(V.DataTable.dtRouter.RowCount--).Router!FieldValTrim)

F.Intrinsic.Control.CallSub(400000Sync)

F.Data.DataTable.AddRow("1500","ROUTER",V.DataTable.dtRouter(V.DataTable.dtRouter.RowCount--).Router!FieldValTrim,"Quantity",1)
F.Intrinsic.Control.CallSub(1500sync)

F.Intrinsic.Control.CallSub(Get_Cost)

V.Passed.000052.Set(V.DataTable.dtRouter(V.DataTable.dtRouter.RowCount--).Router!FieldValTrim)
V.Passed.000056.Set(V.Local.sDesc.Trim)
v.Passed.000006.Set(V.Local.sUM)
V.Passed.000013.Set(V.Local.sPL)

F.Intrinsic.Control.CallSub(FormShell_UnLoad)

F.Intrinsic.Control.ExitSub

F.Intrinsic.Control.Label("FormShell_SaveButtonClick_Err")
F.Intrinsic.Control.If(V.Ambient.ErrorNumber,<>,0)
	F.Intrinsic.String.Build("Project: GCG_6721_Shell_Crate_Calc.g2u {0}{0}Subroutine: {1}{0}Error Occurred {2} with description {3}",V.Ambient.NewLine,V.Ambient.CurrentSubroutine,V.Ambient.ErrorNumber,V.Ambient.ErrorDescription,V.Local.sError)
	F.Intrinsic.UI.Msgbox(V.Local.sError)
	F.Intrinsic.Control.CallSub(FormShell_UnLoad)
Function.Intrinsic.Control.EndIf
Program.Sub.FormShell_SaveButtonClick.End

Program.Sub.Comments.Start
${$5$}$3.0.0.0$}$1
${$6$}$rking$}$20220613143550341$}$QNdZLVy4bWuiWa9jh1ZTiKVzNnEzrvL4Gjut/SIP7Dep7iOJZfDD4v55MVk/ymlFE2YBldVB84Y=
Program.Sub.Comments.End